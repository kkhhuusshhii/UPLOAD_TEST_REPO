[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select \nsrc.fecu_report_dt,\nsrc.prem_amt,\nsrc.curr_cd,\nsrc.broker_rut_num,\ntranslate(src.broker_name,'#','') as broker_name,\nsrc.dim_broker_key,\nsrc.dim_fecu_company_key,\nsrc.actv_rec_ind,\nLKP_MAXSID.MAX_SID as max_sid from\n(SELECT distinct\nCAST(TO_DATE(FECU_REPORT_DT,'DD-MM-YYYY') AS DATE) AS fecu_report_dt,\ncast(PREMIUM_AMOUNT as numeric(25,10)) *1000 as prem_amt,\ncast(CURR_CODE as varchar(10)) curr_cd,\ncast(RUT as varchar(35)) broker_rut_num ,\ncast(NAME as varchar(100)) broker_name,\ncast(nvl(B.DIM_BROKER_KEY,0) as int) dim_broker_key,\ncast(nvl(DC.DIM_FECU_COMPANY_KEY,0) as int) AS dim_fecu_company_key,\n'Y' AS actv_rec_ind,\n1 as dummy\nFROM CDP_STG_DWH.STG_FECU_COMPANY C\nLEFT OUTER JOIN CDP_DWH.DIM_BROKER_T B\nON C.RUT = B.BROKER_RUT_NUM\n--AND UPPER(B.SRC_SYS_CD) = 'FECU'\nLEFT OUTER JOIN CDP_DWH.DIM_FECU_COMPANY_T DC\nON DC.COMPANY_NAME = C.company_NAME)src\nleft outer join\n(select 1 as dummy, max(fact_fecu_company_key) as MAX_SID from cdp_dwh.fact_fecu_report_by_company_t) LKP_MAXSID\non src.dummy = LKP_MAXSID.dummy"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[1].dataAdapter.object.customQuery",
        "value": "SELECT \nfact_fecu_company_key, \nfecu_report_dt, \nprem_amt, \ncurr_cd, \nbroker_rut_num, \nbroker_name,\ndim_broker_key,\ndim_fecu_company_key FROM cdp_dwh.fact_fecu_report_by_company_t;"
    }
]