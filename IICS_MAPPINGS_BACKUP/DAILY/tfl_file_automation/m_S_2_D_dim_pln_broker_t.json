[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select \ns.branch_office_cd_1,\ns.broker_rut_num,\ns.company_name,\ns.agent_code,\ns.regional_name,\ns.branch_office_name_1,\ns.management_name,\ns.broker_name,\ns.sales_exec_name,\ns.branch_office_name_2,\ns.actv_rec_ind,\ns.year,\ns.month,\ns.sales_exec_rut,\ns.max_sid from \n(\nselect \nbranch_office_cd_1,\nbroker_rut_num,\ncompany_name,\nagent_code,\nregional_name,\nbranch_office_name_1,\nmanagement_name,\nbroker_name,\nsales_exec_name,\nbranch_office_name_2,\nactv_rec_ind,\nyear,\nmonth,\nsales_exec_rut,\nLKP_MAXSID.MAX_SID as max_sid,\nROW_NUMBER()OVER(PARTITION BY branch_office_cd_1,broker_rut_num,company_name,year,month order by branch_office_cd_1) rnk from\n(\nselect distinct\ncast(sucursal_id as VARCHAR(10))branch_office_cd_1,\ncast(rut_corredor as VARCHAR(35))broker_rut_num,\ncast(company as VARCHAR(100))company_name,\ncast(codigo_agente as varchar(100)) as agent_code,\ncast(regional as VARCHAR(100))regional_name,\ncast(sucursal1 as VARCHAR(100))branch_office_name_1,\ncast(gerencia as VARCHAR(100))management_name,\ncast(corredor as VARCHAR(100))broker_name,\ncast(ejecutivo as VARCHAR(100))sales_exec_name,\ncast(sucursal as VARCHAR(100))branch_office_name_2,\ncast(agno as INT) as year,\ncast(mes as INT) as month,\ncast(rut_ejecutivo AS VARCHAR(35)) as sales_exec_rut,\ncast('Y' as CHAR(1)) actv_rec_ind,\n1 as dummy\nfrom cdp_stg_dwh.stg_corredor)src\nleft outer join\n(select 1 as dummy, max(dim_pln_broker_key) as MAX_SID from cdp_dwh.dim_pln_broker_t) LKP_MAXSID\non src.dummy = LKP_MAXSID.dummy\n)s \nwhere s.rnk=1 and s.branch_office_cd_1 is not null and s.branch_office_cd_1<>'' \nand s.broker_rut_num is not null and s.broker_rut_num<>'' \nand s.company_name is not null and s.company_name<>''\nand s.year is not null and s.month is not null"
    }
]