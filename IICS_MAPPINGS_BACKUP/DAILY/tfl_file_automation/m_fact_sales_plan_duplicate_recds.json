[
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "select case when CNT > 1 then CNT/0 else CNT end VALIDATION_CHECK\nfrom\n(\nSELECT case when row_num is null then dummy else row_num end CNT FROM\n(\nSELECT 1 as dummy, row_num FROM\n(select row_number() over(partition by branch_office_name,broker_rut_num,sales_exec_rut,pln_yr,pln_mth,ramo_pln_desc order by broker_rut_num) as row_num\nfrom\n(select  \nsucursal_comercial branch_office_name, \nrut_corredor broker_rut_num,\ncorredor broker_name,\nrut_ejecutivo sales_exec_rut ,\nejecutivo  sales_exec_name ,\nagno pln_yr,\nmonth_no  pln_mth,\npre_amt prem_amt,\nmoneda curr_cd,\nramo_plan ramo_pln_desc\nfrom \n(select sucursal_comercial,rut_corredor,corredor,rut_ejecutivo,ejecutivo,agno,'01' month_no,enero pre_amt,moneda,ramo_plan\n from cdp_stg_dwh.stg_plan\nunion\nselect sucursal_comercial,rut_corredor,corredor,rut_ejecutivo,ejecutivo,agno,'02' month_no,febrero pre_amt,moneda,ramo_plan\n from cdp_stg_dwh.stg_plan\nunion\nselect sucursal_comercial,rut_corredor,corredor,rut_ejecutivo,ejecutivo,agno,'03' month_no,marzo pre_amt,moneda,ramo_plan\n from cdp_stg_dwh.stg_plan\nunion\nselect sucursal_comercial,rut_corredor,corredor,rut_ejecutivo,ejecutivo,agno,'04' month_no,abril pre_amt,moneda,ramo_plan\n from cdp_stg_dwh.stg_plan\nunion\nselect sucursal_comercial,rut_corredor,corredor,rut_ejecutivo,ejecutivo,agno,'05' month_no,mayo pre_amt,moneda,ramo_plan\n from cdp_stg_dwh.stg_plan\nunion\nselect sucursal_comercial,rut_corredor,corredor,rut_ejecutivo,ejecutivo,agno,'06' month_no,junio pre_amt,moneda,ramo_plan\n from cdp_stg_dwh.stg_plan\nunion\nselect sucursal_comercial,rut_corredor,corredor,rut_ejecutivo,ejecutivo,agno,'07' month_no,julio pre_amt,moneda,ramo_plan\n from cdp_stg_dwh.stg_plan\nunion\nselect sucursal_comercial,rut_corredor,corredor,rut_ejecutivo,ejecutivo,agno,'08' month_no,agosto pre_amt,moneda,ramo_plan\n from cdp_stg_dwh.stg_plan\nunion\nselect sucursal_comercial,rut_corredor,corredor,rut_ejecutivo,ejecutivo,agno,'09' month_no,septiembre pre_amt,moneda,ramo_plan\n from cdp_stg_dwh.stg_plan\nunion\nselect sucursal_comercial,rut_corredor,corredor,rut_ejecutivo,ejecutivo,agno,'10' month_no,octubre pre_amt,moneda,ramo_plan\n from cdp_stg_dwh.stg_plan\nunion\nselect sucursal_comercial,rut_corredor,corredor,rut_ejecutivo,ejecutivo,agno,'11' month_no,noviembre pre_amt,moneda,ramo_plan\n from cdp_stg_dwh.stg_plan\nunion\nselect sucursal_comercial,rut_corredor,corredor,rut_ejecutivo,ejecutivo,agno,'12' month_no,diciembre pre_amt,moneda,ramo_plan\n from cdp_stg_dwh.stg_plan\n)\nwhere branch_office_name is not null and branch_office_name!=''\nand broker_rut_num is not null and broker_rut_num!=''\nand sales_exec_rut is not null and sales_exec_rut!=''\nand pln_yr is not null and pln_yr!=''\nand month_no is not null and month_no!=''\nand ramo_pln_desc is not null and ramo_pln_desc!=''\n))\n)SRC where row_num >1\n)SRC1\n"
    }
]