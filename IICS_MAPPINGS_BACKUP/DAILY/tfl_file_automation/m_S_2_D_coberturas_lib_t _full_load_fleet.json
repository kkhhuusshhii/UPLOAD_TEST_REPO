[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select \nSSEGURO,\nCOB_PLAN,\nmax_sid\nfrom \n(\nselect \nSSEGURO,\nCOB_PLAN,\nLKP_MAX_KEY.max_sid \nfrom \n(\nselect sseguro, sum(distinct COBERTURA_PLAN) COB_PLAN\n\nFROM\n (SELECT distinct T1.SSEGURO,cgarant,\n      CASE\n        WHEN T2.CGARANT  in  (select distinct cob_plan_rc from cdp_stg_dwh.renewals_param_axis) THEN  1 ---RC \n        WHEN T2.CGARANT  in  (select distinct cob_plan_rc_i from cdp_stg_dwh.renewals_param_axis) THEN 2 ---RC_I\n        WHEN T2.CGARANT  in  (select distinct cob_plan_rc_e from cdp_stg_dwh.renewals_param_axis) THEN 5 ------RC_E\n        WHEN T2.CGARANT  in  (select distinct cob_plan_dm from cdp_stg_dwh.renewals_param_axis) THEN 10 -----DM\n        WHEN T2.CGARANT  in  (select distinct cob_plan_pt from cdp_stg_dwh.renewals_param_axis) THEN 100 ----PT\n        WHEN T2.CGARANT  in  (select distinct cob_plan_ro from cdp_stg_dwh.renewals_param_axis) THEN 1000 ---RO\n        ELSE 0 \n        END  AS COBERTURA_PLAN \n       \nFROM cdp_stg_dwh.base_lib T1\nLEFT JOIN \n     (SELECT distinct A2.sseguro, A2.cgarant from cdp_ods.SISAXIS_GARANSEG  A2\n            INNER JOIN cdp_stg_dwh.base_lib A1\n            ON A1.sseguro = A2.sseguro) T2 ON T1.SSEGURO = T2.SSEGURO \n         --ORDER BY T1.SSEGURO   \n            )\ngroup by SSEGURO\n\n)src\nleft outer join \n(select 1 dummy,max(coberturas_lib_key) max_sid  from  cdp_stg_dwh.coberturas_lib) LKP_MAX_KEY\non LKP_MAX_KEY.dummy=1)\nwhere SSEGURO is not null"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.coberturas_lib;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[2].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.coberturas_lib;\ncommit;"
    }
]