[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "with CTE as\n(SELECT a.SSEGURO,\n\t\tMAX(b.IFRANQUSEG) AS DEDUCIBLE,\n\t\tb.NMOVIMI AS NUM_ENDOSO\n\t\t\nFROM\tcdp_stg_dwh.base_lib a\nLEFT JOIN cdp_ods.SISAXIS_GARANSEG b\nON a.SSEGURO = b.SSEGURO\nGROUP BY a.SSEGURO, b.NMOVIMI\n\n)\n\nselect SSEGURO,\n\t\tDEDUCIBLE,\n\t\tNUM_ENDOSO,\n\t\tmax_sid\nfrom\n(\nselect SSEGURO,\n\t\tCAST(DEDUCIBLE as NUMERIC) AS DEDUCIBLE,\n\t\tNUM_ENDOSO,\n\t\tLKP_MAX_KEY.max_sid \nfrom\n(\n\nSELECT T1.SSEGURO,\n\t\tT1.DEDUCIBLE AS DEDUCIBLE,\n\t\tT1.NUM_ENDOSO\n\t       \nFROM\tCTE T1\nINNER JOIN \n\t(SELECT SSEGURO, MAX(NUM_ENDOSO) AS NUM_ENDOSO\n\tFROM CTE\n\tGROUP BY SSEGURO) T2\nON T1.SSEGURO = T2.SSEGURO\nAND T1.NUM_ENDOSO = T2.NUM_ENDOSO\n)src\nleft outer join \n(select 1 dummy,max(deducibles_lib_key) max_sid  from  cdp_stg_dwh.deducibles_lib) LKP_MAX_KEY\non LKP_MAX_KEY.dummy=1)\nwhere SSEGURO is not null"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.deducibles_lib;\n"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[2].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.deducibles_lib;\ncommit;\n"
    }
]