[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "SELECT\n    CAST(MAX_SID AS                BIGINT)                AS llave_datos_cliente,\n    CAST('axis' AS                 CHARACTER VARYING(30)) AS sistema_origen,\n    CAST(sperson AS                INT)                    AS sperson,\n    CAST(identificacion_cliente AS CHARACTER VARYING(1000))     AS identificacion_cliente,\n    CAST(tipo_identificaci\u00c3\u00b3n AS    INT)                         AS cod_tipo_identificacion,\n    CAST(nombres AS                CHARACTER VARYING(1000))     AS nombres,\n    CAST(apellidos AS              CHARACTER VARYING(1000))     AS apellidos,\n    CAST(nombre_completo AS        CHARACTER VARYING(1000) )    AS nombre_completo,\n\tCAST(upper(nombre_completo) AS        CHARACTER VARYING(1000) )    AS nombre_completo_corregido,\n    CAST(cod_pais_origen AS        CHARACTER VARYING(30))       AS cod_pais_origen,\n    CAST(fecha_nacimiento AS       TIMESTAMP WITHOUT TIME ZONE) AS fecha_nacimiento,\n    CAST(cod_tipo_persona AS       SMALLINT)                    AS cod_tipo_persona,\n    CAST(cod_genero AS             SMALLINT)                    AS cod_genero,\n    CAST(tipo_cliente AS           CHARACTER VARYING(1000))   AS tipo_cliente,\n    CAST(fecha_inicio_vigencia AS  TIMESTAMP WITHOUT TIME ZONE) AS fecha_inicio_vigencia,\n    CAST(fecha_termino_vigencia AS TIMESTAMP WITHOUT TIME ZONE) AS fecha_termino_vigencia,\n    CAST(ind_vigencia AS           CHARACTER VARYING(100))      AS ind_vigencia\nFROM\n    (   SELECT\n            DISTINCT    persona_base.sperson,\n            nnumnif  AS Identificacion_cliente,\n            tidenti AS Tipo_identificaci\u00c3\u00b3n,\n            tnombre  AS nombres,\n            regexp_replace(tapelli, '[\\n\\r]+', ' ')  AS apellidos,\n             regexp_replace(nombre_completo, '[\\n\\r]+', ' ') AS nombre_completo,\n            cod_pais_origen,\n            fnacimi AS fecha_nacimiento,\n            cpertip AS cod_tipo_persona,\n            csexper AS cod_genero,\n            tipo_cliente,\n            date_base.fefecto       AS fecha_inicio_vigencia,\n            date_base.fecha_termino AS fecha_termino_vigencia,\n            CASE\n                WHEN fecha_termino > GETDATE()\n                THEN '1'\n                ELSE '0'\n            END ind_vigencia\n        FROM\n            (   SELECT\n                    DISTINCT a.sperson,\n                    nnumnif,\n                    tidenti,\n                    tnombre,\n                    tapelli,\n                    substring(tbuscar, 1, LENGTH(tbuscar)-2) nombre_completo,\n                    'CL'                                     cod_pais_origen,\n                    fnacimi,\n                    cpertip,\n                    csexper,\n                    CAST(s.sseguro AS DECIMAL(38,0)) seguro,\n                    TRUNC(s.fefecto)                 fecha_efecto\n                FROM\n                    cdp_ods.sisaxis_personas per,\n                    (   SELECT\n                            *\n                        FROM\n                            cdp_ods.sisaxis_asegurados) a,\n                    cdp_ods.sisaxis_seguros                 s\n                WHERE\n                    per.sperson = a.sperson\n                AND a.sseguro = s.sseguro\n                AND a.nmovimb IS NULL\n                AND s.csituac IN (0,2,5)\n                AND s.ncertif > 0\n                AND s.fefecto <= CURRENT_DATE\n                AND\n                    (\n                        (\n                            s.csituac IN (0,5)\n                        AND s.fvencim >= CURRENT_DATE\n                        OR  s.fcaranu >= CURRENT_DATE\n                        AND s.fcarpro >= CURRENT_DATE)\n                    OR\n                        (\n                            s.csituac IN (2)\n                        AND s.fanulac >= CURRENT_DATE))\n                \n                UNION\n                \n                SELECT\n                    DISTINCT a.sperson,\n                    nnumnif,\n                    tidenti,\n                    tnombre,\n                    tapelli,\n                    substring(tbuscar, 1, LENGTH(tbuscar)-2) nombre_completo,\n                    'CL'                                     cod_pais_origen,\n                    fnacimi,\n                    cpertip,\n                    csexper,\n                    CAST(s.sseguro AS DECIMAL(38,0)) seguro,\n                    TRUNC(s.fefecto)                 fecha_efecto\n                FROM\n                    cdp_ods.sisaxis_personas per,\n                    (   SELECT\n                            *\n                        FROM\n                            cdp_ods.sisaxis_tomadores) a,\n                    cdp_ods.sisaxis_seguros                s\n                WHERE\n                    per.sperson = a.sperson\n                AND a.sseguro = s.sseguro\n                AND s.csituac IN (0,2,5)\n                AND s.ncertif > 0\n                AND s.fefecto <= CURRENT_DATE\n                AND\n                    (\n                        (\n                            s.csituac IN (0,5)\n                        AND s.fvencim >= CURRENT_DATE\n                        OR  s.fcaranu >= CURRENT_DATE\n                        AND s.fcarpro >= CURRENT_DATE)\n                    OR\n                        (\n                            s.csituac IN (2)\n                        AND s.fanulac >= CURRENT_DATE))\n                \n                UNION\n                \n                SELECT\n                    DISTINCT ase.sperson,\n                    nnumnif,\n                    tidenti,\n                    tnombre,\n                    tapelli,\n                    substring(tbuscar, 1, LENGTH(tbuscar)-2) nombre_completo,\n                    'CL'                                     cod_pais_origen,\n                    fnacimi,\n                    cpertip,\n                    csexper,\n                    CAST(a.sseguro AS DECIMAL(38,0)) seguro,\n                    TRUNC(a.fefecto)                 fecha_efecto\n                FROM\n                    cdp_ods.sisaxis_personas per,\n                    (   SELECT\n                            *\n                        FROM\n                            cdp_ods.sisaxis_siniestros) s,\n                    cdp_ods.sisaxis_seguros                 a,\n                    cdp_ods.sisaxis_asegurados              ase\n                WHERE\n                    s.sseguro = a.sseguro\n                AND nnumnif = s.ndocumec\n                AND ase.sperson = per.sperson\n                AND s.cestsin IN (0,4)\n                AND per.nnifrep =\n                    (   SELECT\n                            MAX (nnifrep)\n                        FROM\n                            cdp_ods.sisaxis_personas\n                        WHERE\n                            nnumnif = per.nnumnif )\n                AND ase.sseguro = a.sseguro\n                AND ase.nmovimb IS NULL\n                AND ase.sperson = per.sperson\n                AND a.fefecto <= CURRENT_DATE\n                AND\n                    (\n                        (\n                            a.csituac IN (0,5)\n                        AND a.fvencim < CURRENT_DATE\n                        OR  a.fcaranu < CURRENT_DATE\n                        AND a.fcarpro < CURRENT_DATE)\n                    OR\n                        (\n                            a.csituac IN (2)\n                        AND a.fanulac < CURRENT_DATE)) )persona_base\n        LEFT JOIN\n            (   SELECT\n                    sperson,\n                    MIN(fefecto)       AS fefecto,\n                    MAX(fecha_termino) AS fecha_termino\n                FROM\n                    (\n                    (   SELECT\n                            per.sperson,\n                            fefecto,\n                            DECODE(seg.fanulac,NULL,DECODE(seg.fvencim,NULL,seg.fcarpro,\n                            seg.fvencim),seg.fanulac) fecha_termino\n                        FROM\n                            cdp_ods.sisaxis_seguros    seg,\n                            cdp_ods.sisaxis_asegurados ase,\n                            cdp_ods.sisaxis_personas   per\n                        WHERE\n                            seg.sseguro = ase.sseguro\n                        AND ase.sperson=per.sperson\n                        AND seg.csituac IN (0,2,5)\n                        AND seg.ncertif > 0\n                        AND DECODE(seg.fanulac,NULL,DECODE(seg.fvencim,NULL,seg.fcarpro,\n                            seg.fvencim),seg.fanulac)> CURRENT_DATE\n                        AND ase.nmovimb IS NULL)\n                \n                UNION\n                    (   SELECT\n                            per.sperson,\n                            fefecto,\n                            DECODE(seg.fanulac,NULL,DECODE(seg.fvencim,NULL,seg.fcarpro,\n                            seg.fvencim),seg.fanulac)fecha_termino\n                        FROM\n                            cdp_ods.sisaxis_seguros   seg,\n                            cdp_ods.sisaxis_tomadores ase,\n                            cdp_ods.sisaxis_personas  per\n                        WHERE\n                            seg.sseguro = ase.sseguro\n                        AND ase.sperson=per.sperson\n                        AND seg.csituac IN (0,2,5)\n                        AND seg.ncertif > 0\n                        AND DECODE(seg.fanulac,NULL,DECODE(seg.fvencim,NULL,seg.fcarpro,\n                            seg.fvencim),seg.fanulac)> CURRENT_DATE )) a\n                GROUP BY\n                    sperson )date_base\n        ON\n            date_base.sperson=persona_base.sperson\n        LEFT JOIN\n            (   SELECT\n                    personas.sperson,\n                    CASE\n                        WHEN asegurados_count > 0\n                        AND tomadores_count > 0\n                        THEN 'Asegurado-Tomador'\n                        WHEN asegurados_count > 0\n                        THEN 'Asegurado'\n                        WHEN tomadores_count > 0\n                        THEN 'Tomador'\n                    END tipo_cliente\n                FROM\n                    cdp_ods.sisaxis_personas personas\n                LEFT JOIN\n                    (   SELECT\n                            sperson,\n                            COUNT(1) AS asegurados_count\n                        FROM\n                            cdp_ods.sisaxis_asegurados\n                        WHERE\n                            nmovimb IS NULL\n                        GROUP BY\n                            sperson ) asegurados\n                ON\n                    personas.sperson=asegurados.sperson\n                LEFT JOIN\n                    (   SELECT\n                            sperson,\n                            COUNT(1) AS tomadores_count\n                        FROM\n                            cdp_ods.sisaxis_tomadores\n                        GROUP BY\n                            sperson ) tomadores\n                ON\n                    personas.sperson=tomadores.sperson )tipo_cliente\n        ON\n            tipo_cliente.sperson=persona_base.sperson )\nLEFT JOIN\n    (   SELECT\n            MAX(llave_datos_cliente) AS MAX_SID\n        FROM\n            data_clientes_cl.cdm_cl_dim_datos_cliente_t ) LKP\nON\n    1 = 1"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.oprRuntimeAttributes.attributes[13]",
        "name": "preSql",
        "value": "truncate table data_clientes_cl.cdm_cl_dim_datos_cliente_t ;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[13]",
        "name": "Pre-SQL",
        "value": "truncate table data_clientes_cl.cdm_cl_dim_datos_cliente_t ;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[4].dataAdapter.oprRuntimeAttributes.attributes[27]",
        "name": "postSql",
        "value": "call \"data_clientes_cl\".\"sp_cl_dim_datos_cliente_replace_name\"()"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[4].dataAdapter.runtimeAttributes.attributes[27]",
        "name": "Post-Sql",
        "value": "call \"data_clientes_cl\".\"sp_cl_dim_datos_cliente_replace_name\"()"
    }
]