[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "SELECT distinct \n    CAST(MAX_SID AS BIGINT)                AS llave_contactos_cliente,\n    CAST('axis' AS  CHARACTER VARYING(30)) AS sistema_origen,\n\tCAST(NVL(cast(driver.sperson as int),0)||'-'||NVL(tipo_contacto.llave_tipo_contacto,0)||'-'||NVL(tipo_origen.llave_tipo_origen,0)\n\t||'-'||NVL(cast (consecutivo_contacto as int),0)||'-'||COALESCE(valor_original_contacto, '')  ||'-'||COALESCE(valor_corregido_contacto, '')  AS  CHARACTER VARYING(1000)) as contactos_natural_key,\n\tCAST(OP AS  CHARACTER VARYING(1)) AS OP,\n\tCAST(driver.sperson AS INT)   AS sperson,\n    NVL(CAST(dim_datos_cliente.llave_datos_cliente AS BIGINT),0)   AS llave_datos_cliente,\n\tCAST(tipo_contacto.llave_tipo_contacto AS  BIGINT) AS llave_tipo_contacto,\n\tCAST(tipo_origen.llave_tipo_origen AS  BIGINT) AS llave_tipo_origen,\n\tCAST(regexp_replace(valor_original_contacto,'[\\r\\n]+','') AS  CHARACTER VARYING(500)) AS valor_original_contacto,\n    CAST(regexp_replace(valor_corregido_contacto,'[\\r\\n]+','') AS  CHARACTER VARYING(500)) AS valor_corregido_contacto,\n\tNVL(CAST(ind_vigencia_contacto AS INT),0)   AS ind_vigencia_contacto,\n\tCAST(consecutivo_contacto as CHARACTER VARYING(30))   AS consecutivo_contacto,\n\tCAST(fecha_insercion AS TIMESTAMP WITHOUT TIME ZONE) AS fecha_insercion,\n\tCAST(fecha_termino AS TIMESTAMP WITHOUT TIME ZONE) AS fecha_termino,\n\tCAST(cod_usuario_modifica AS  CHARACTER VARYING(30)) AS usuario_modifica,\n\tCAST(Null AS  CHARACTER VARYING(30)) AS ind_correo_empresa,\n\tCAST(ind_correo_corredor AS  CHARACTER VARYING(30)) AS ind_correo_corredor,\n\tCAST(ind_calidad_validez_original AS INT)   AS ind_calidad_validez_original,\n\tCAST(ind_calidad_validez_corregido AS INT)   AS ind_calidad_validez_corregido,\n\tCAST(NULL AS INT)   AS ind_calidad_exactitud,\n\tCAST(desea_ser_contactado AS INT)   AS desea_ser_contactado,\n\tCAST(rnk AS INTEGER) rnk\n\tfrom\n\n\t\n(Select  OP,Final_Data.sperson,\n       tipo_contacto,\n\t   tipo_origen,\n\t   cod_origen,\n\t   valor_original_contacto,\n\t   cod_usuario_modifica,\n\t   fecha_insercion,\n\t   fecha_termino,\n\t   consecutivo_contacto,\n\t   valor_corregido_contacto_final as valor_corregido_contacto,\n\t Case when valor_original_contacto like '%_@__%'  \n          and valor_original_contacto not like '%notiene%'\n          and valor_original_contacto not like '%notien%'\n          and valor_original_contacto not like '%sincorreo%' \n\t\t  and valor_original_contacto not like '%gmail%' \n\t      and valor_original_contacto not like '%yahoo%' \n\t\t  and valor_original_contacto not like '%hotmail%'  \n          and valor_original_contacto not like '%outlook%'\t\t  \n          and  \n         (valor_original_contacto  not similar to '%[!]%' or \n\t\t  valor_original_contacto  not similar to '%[#]%' or\n\t\t  valor_original_contacto  not similar to'%[$]%' or\n\t\t  valor_original_contacto  not similar to'%[%]%' or\n\t\t  valor_original_contacto  not similar to'%[&]%' or\n\t\t  valor_original_contacto  not like '%%' or\n\t\t  valor_original_contacto  not similar to'%[\u00e2\u20ac\u2122]%' or\n\t\t  valor_original_contacto  not similar to'%[*]%' or\n\t\t  valor_original_contacto  not similar to'%[+]%' or\n\t\t  valor_original_contacto  not similar to'%[/]%' or\n\t\t  valor_original_contacto  not similar to'%[=]%' or\n\t\t  valor_original_contacto  not similar to'%[?]%' or\n\t\t  valor_original_contacto  not like'%^%' or\n\t\t  valor_original_contacto  not similar to'%[`]%' or\n\t\t  valor_original_contacto  not similar to'%[{]%' or\n\t\t  valor_original_contacto  not similar to'%[|]%' or\n\t\t  valor_original_contacto  not similar to'%[}]%'  or\n\t\t  valor_original_contacto  not similar to'%[~]%')\t\n\t\t  then '1'\n          when \n\t\t  valor_original_contacto  similar to '[+][5][6][9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]' THEN 1 \n          when valor_original_contacto in ('0','1','3503614','4407016','11180786','72231127','85496922','97317576','982525436','996194574',' @GMIAL.COM',' 0@0','.p@.p',': 9-3468889  9467050','-@GMAIL.COM','@HOTMAIL.COM','0@0.cl','00@00','000@NOTIENE.CL','0000000000NO TIENE','0000000000no@NOTIENE.CL','0000000000NONTIENE@GMAIL.COM','0000000000NOTIEN@GMAIL.COM','0000000000NOTIENE@CORREO.COM','0000000000NOTIENE@GMAIL.COM','0000000000NOTIENE@NOTIENE.CL','0022115081NO TIENE','1@1','1@1.cl','11@11','123@123.cl','1234@NOTIENE.COM','22222222@99999999','470352 92377764','490598914@qq.com','65-211716','A@GMAIL.COM','NOIENE@GMAIL.COM','NOINFORMA@GMAIL.COM','NOINFORMA@NO.COM','zzzzzzzzzzzzzzzz','...@GMAIL.COM','...@hotmail.com','..@GMAIL.COM','.@.CL','.@.GMAIL.COM','.@LIVE.CL','.A@.A','@GMAIL.COM','-@HOTMAIL.COM','1@1GMAIL.COM','1@GMAIL.COM','1@nnnn.com','123@GMAIL.COM','A@A','A@A.CL','A@A.COM','A@AA.CL','A@BCI.CL','A@CL','A@GMAIL.COM','A@LCV.CL','A@O','A@Q','AA@A.CL','AA@AA','AA@AA.AA','AA@BB','AA@GMAIL.COM','AAA@AAA.CL','AAA@AAAA.CL','AAAA@AAAA','AAAAAAAAAAA@AAAA','C@ C','C@C','C@C.CL','C@VTR.NET','D@GMAIL.COM','ET@CL','F','F@C','FF@DD.COM','FF@FF.CL','H@M','J@B','J@GMAIL.COM','K@H','L@L','L@M','L@SECURITY.CL','L@T','LIST169','LIST16944444444444444','M@GMAIL.COM','M@M.CL','M@R.CL','M@T','N@B.CL','N@GMAIL.COM','N@HOTMAIL.COM','N@N','N@N.CL','N@N.COM','N@NC.CL','N@R.CL','na@gmail.com','na@hotmail.com','NN','NN@GMAIL.COM','NN@HOTMAIL.COM','NN@NN','NN@NN.CL','NN@SINCORREO.CL','NN@VTR.NET','NNNNNNNNNNNNNNNNNN','nnotien@xxx.com','NNOTIENE@NOTIENE.COM','NO INDICA','NO INTERNET','NO TIENE','NO TIENE NO TIENE','NO TIENE.','NO TIENE@GMAIL.COM','NO TIENENE','NO.TIENE@LIVE.CL','NO@DEJA.CL','NO@GMAIL.COM','NO@HOTMAIL.COM','NO@INDICA.CL','NO@NO.CL','NO@NOTIENE.CL','no@tengo.correo.co','NO@TIENE.CL','NO@TIENEGMAIL.COM','no1@hotmail.com','NOCORREO@HOTMAILCOM','noene@notien.com','NOLOTENGO@GMAIL.COM','NONES@GMAIL.COM','NONO@GMAIL.COM','NONTIENE@GMAIL.COM','NOOOO@GMAIL.COM','NOPOSEE@GMAIL.COM','NOPOSEE@HOTMAIL.COM','NOPOSEE@SINCORREO.COM','NOPTIOENE@GMAIL.COM','NOQUIERE@GMAIL.COM','NOQUIEROEMAIL@YMAIL.COM','NOTIEN@GMAIL.COM','NOTIENCORREO@GMAIL.COM','notiene.@gmail.com','NOTIENE.123@GMAIL.COM','NOTIENE@123.CL','NOTIENE@BANCOCHILE.CL','NOTIENE@CORREO.CL','NOTIENE@GMAIL.COM','NOTIENE@HOTMAIL.COM','NOTIENE@HOTMAIL.CON','NOTIENE@HOTMAILCOM','notiene@latinmail.com','NOTIENE@LIBERTY.COM','notiene@liberty.com.co','NOTIENE@LIVE.COM','NOTIENE@MAIL.COM','NOTIENE@NO.CL','NOTIENE@NO.COM','NOTIENE@NOREGISTRA.COM','NOTIENE@NOTIEN.COM','NOTIENE@NOTIEN.COM.CO','NOTIENE@NOTIENE','NOTIENE@NOTIENE.CL','NOTIENE@NOTIENE.CO','NOTIENE@NOTIENE.COIM','NOTIENE@NOTIENE.COM','NOTIENE@NOTIENE.COM.CO','NOTIENE@NOTIENE.CONM','NOTIENE@NOTIENECOM','NOTIENE@NOTINE.CL','notiene@otiene.com.co','notiene@sincorreo.com','NOTIENE@YAHOO.COM','NOTIENE@YAHOO.ES','NOTIENE22@GMAIL.COM','NOTIENE6@GMAIL.COM','NOTIENE8@GMAIL.COM','NOTIENECORREO@GMAIL.COM','NOTIENECORREO@MAIL.COM','NOTIENECORREO@NOTIENE.CL','NOTIENEE@GMAIL.COM','NOTINE@GMAIL.COM','NOTINE@HOTMAIL.COM','NOTINE@NOTINE.CL','NOTINEE@GMAIL.COM','NP@.CL','O@.CL','O@O','OO@OO','OOO@GMAIL.COM','OOOO@GMAIL.COM','P@A','P@P','P@S','P@V','PF@CL','PON@CHO','R@GMAIL.COM','R@R','S@GMAIL.COM','S@O','S@S','s@s.cl','SIN @GMAIL.COM','SIN MAIL@GMAIL.COM','SIN@CORREO.CL','SIN@CORREO.COM','SIN@GMAIL.COM','SIN@HOTMAIL.COM','SINCORREO@CLARO.COM','SINCORREO@CLARO.COM.CO','SINCORREO@CLARO.NET','SINCORREO@CLARO.NET.CO','SINCORREO@CLARO.NET.COM','SINCORREO@CLIENTE.COM','SINCORREO@CORREO.CL','SINCORREO@GMAIL.COM','SINCORREO@HOTMAIL.COM','sincorreo@libertyseguros.com','sincorreo@na.com','SINCORREO@NOTIENE.COM','SINCORREO@SINCORREO.CL','SINCORREO@SINCORREO.COM','SINCORREO@SINCORREO.COM.CO','SINCORREO@TELMEX.COM','SINCORREO@TELMEX.COM.CO','SINCORREO@TELMEX.NET.CO','SINCORREO1@HOTMAIL.COM','sincorreo10@hotmail.com','SINCORREO123@GMAIL.COM','SINCORREO123@GMAIL.COMS','SINCORREO15@GMAIL.COM','SINCORREO30@HOTMAIL.COM','sincorreo40@hotmail.com','SINCORREO888@GMAIL.COM','SINDATOS@123.CL','SINDATOS@SD.CL','SINDIRECCION@GMAIL.COM','SINEMAIL@SINEMAIL.COM','SINMAIL@GMAIL.COM','SINMAIL@SINMAIL.CL','SINMAIL@SINMAIL.COM','SSS@SS','T.CL','T@CL','TMAIL.COM','V@V.CL','X@GMAIL.COM','X@X','XX@XX','XX@XX.CL','XXX@GMAIL.COM','XXX@XXX','XXX@XXX.CL','XXXX@XXXX.CL','XXXX@XXXXX.CL','XXXXX@HOTMAIL.COM','XXXXX@XX.CL','XXXXX@XXXXX.CL','XXXXX@XXXXXX.CL','XXXXXLIST169','XXXXXX@X.XL','XXXXXXXX@XX.CL','XXXXXXXX@XXX.CL','XXXXXXXXX@IDEASS.CL','XXXXXXXXX@XX.CL','XXXXXXXXXXX','XXXXXXXXXXXX','XXXXXXXXXXXXX','XXXXXXXXXXXXXXX','XXXXXXXXXXXXXXXXX','XXXXXXXXXXXXXXXXX@HOTMAIL.COM','XXXXXXXXXXXXXXXXXX') then 0\n\t      else 0 end as ind_calidad_validez_original,\n\t      null  as ind_calidad_validez_corregido,\n          null as ind_correo_corredor,\ncase when Final_Data.sperson||Final_Data.consecutivo_contacto = ind_vigencia_contacto.sperson||ind_vigencia_contacto.cmodcon\n     then 1 else 0 end as ind_vigencia_contacto,\n1 as desea_ser_contactado,\nrnk\nfrom\ndata_clientes_cl.fact_contactos_cliente_cl_base_data Final_Data\nleft join\n(\nselect distinct c.sperson, c.cmodcon\n          from cdp_ods.sisaxis_contactos c\n          where \n          c.ctipcon in (3,21,24)\n          and c.cmodcon = (select max (b.cmodcon) from cdp_ods.sisaxis_contactos b \n                                                  where c.sperson = b.sperson\n                                                  and b.ctipcon = c.ctipcon )\n)ind_vigencia_contacto\non Final_Data.sperson=ind_vigencia_contacto.sperson \nand Final_Data.consecutivo_contacto=ind_vigencia_contacto.cmodcon \n)Driver \nLEFT JOIN \n( select distinct llave_Datos_Cliente, sperson from  data_clientes_cl.cdm_cl_dim_datos_cliente_t\n)dim_datos_cliente\non dim_datos_cliente.sperson=driver.sperson\nLEFT JOIN\n(\nselect llave_tipo_contacto,cod_tipo_contacto from data_clientes_cl.cdm_cl_dim_tipo_contacto_t\n)tipo_contacto\non tipo_contacto.cod_tipo_contacto=driver.tipo_contacto\nLEFT JOIN \n(\nselect llave_tipo_origen,cod_origen  from data_clientes_cl.cdm_cl_dim_tipo_origen_t\n)tipo_origen\non tipo_origen.cod_origen=driver.cod_origen\nLEFT JOIN\n    (   SELECT\n            MAX(llave_contactos_cliente) AS MAX_SID\n        FROM\n            data_clientes_cl.cdm_cl_fact_contactos_cliente_t ) LKP\nON\n    1 = 1"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[1].dataAdapter.object.customQuery",
        "value": "select * from  data_clientes_cl.cdm_cl_fact_contactos_cliente_t  where sistema_origen='axis'"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.oprRuntimeAttributes.attributes[13]",
        "name": "preSql",
        "value": "delete from  data_clientes_cl.cdm_cl_fact_contactos_cliente_t  where sistema_origen='axis';\nTruncate table data_clientes_cl.fact_contactos_cliente_cl_base_data;\ncall \"data_clientes_cl\".\"sp_fact_contactos_clinte_cl_base_data\" ();"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[13]",
        "name": "Pre-SQL",
        "value": "delete from  data_clientes_cl.cdm_cl_fact_contactos_cliente_t  where sistema_origen='axis';\nTruncate table data_clientes_cl.fact_contactos_cliente_cl_base_data;\ncall \"data_clientes_cl\".\"sp_fact_contactos_clinte_cl_base_data\" ();"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[4].dataAdapter.oprRuntimeAttributes.attributes[27]",
        "name": "postSql",
        "value": "call  \"data_clientes_cl\".\"sp_cl_fact_contactos_cliente_replace_domain\" () ;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[4].dataAdapter.runtimeAttributes.attributes[27]",
        "name": "Post-Sql",
        "value": "call  \"data_clientes_cl\".\"sp_cl_fact_contactos_cliente_replace_domain\" () ;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[12].dataAdapter.oprRuntimeAttributes.attributes[27]",
        "name": "postSql",
        "value": "UPDATE data_clientes_cl.cdm_cl_fact_contactos_cliente_t\nSET \nllave_datos_cliente = dim.llave_datos_cliente\nFROM data_clientes_cl.cdm_cl_dim_datos_cliente_t dim\nWHERE DIM.sperson = data_clientes_cl.cdm_cl_fact_contactos_cliente_t.sperson\nAND data_clientes_cl.cdm_cl_fact_contactos_cliente_t.sistema_origen<>'axis'"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[12].dataAdapter.runtimeAttributes.attributes[27]",
        "name": "Post-Sql",
        "value": "UPDATE data_clientes_cl.cdm_cl_fact_contactos_cliente_t\nSET \nllave_datos_cliente = dim.llave_datos_cliente\nFROM data_clientes_cl.cdm_cl_dim_datos_cliente_t dim\nWHERE DIM.sperson = data_clientes_cl.cdm_cl_fact_contactos_cliente_t.sperson\nAND data_clientes_cl.cdm_cl_fact_contactos_cliente_t.sistema_origen<>'axis'"
    }
]