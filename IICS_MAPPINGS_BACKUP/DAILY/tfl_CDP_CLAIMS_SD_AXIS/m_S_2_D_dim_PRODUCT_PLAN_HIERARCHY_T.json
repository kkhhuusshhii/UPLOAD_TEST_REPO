[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select\nprd_cd,\nprd_desc,\npln_cd,\npln_desc,\nlob_cd,\nactv_prd_ind,\nactv_pln_ind,\npln_start_dt,\npln_end_dt,\nmodel_cd,\nins_type_cd,\npkg_cd,\nsrc_sys_cd,\nrec_crt_dtm,\nrec_updt_dtm,\nactv_rec_ind,\nMAX_SID\nfrom\n(\nselect\nsrc.prd_cd,\nsrc.prd_desc,\nsrc.pln_cd,\nsrc.pln_desc,\nsrc.lob_cd,\nsrc.actv_prd_ind,\nsrc.actv_pln_ind,\nsrc.pln_start_dt,\nsrc.pln_end_dt,\nsrc.model_cd,\nsrc.ins_type_cd,\nsrc.pkg_cd,\nsrc.src_sys_cd,\nsrc.rec_crt_dtm,\nsrc.rec_updt_dtm,\n--src.etl_audit_id,\n'Y' as actv_rec_ind,\nLKP_MAXSID.MAX_SID,\nrow_number() over (partition by src.lob_cd,src.prd_cd,src.pln_cd \norder by src.lob_cd,src.model_cd,src.pkg_cd,src.ins_type_cd,src.pln_cd,src.rec_updt_dtm desc) as row_cnt\nfrom\n(\nselect\ndistinct \ncast(cast(a.sproduc as integer) as varchar(10)) as prd_cd,\ncast(RDM.ref_desc as varchar(255)) as prd_desc,\n\n--cast(cast(NVL(RD.mkt_ref_code,cast(b.cactivi as varchar(10)) ) as integer)as varchar(10)) as plan_cd,\ncast(cast(b.cactivi as integer) as varchar(10)) as pln_cd,\ncast(RD.ref_desc as varchar(255)) as pln_desc,\ncast(cast(a.cramo as integer) as varchar(10)) as lob_cd,\ncast(cast(a.CACTIVO as integer) as char(1)) as actv_prd_ind,\nnull as actv_pln_ind,\ncast(null as date) as  pln_start_dt,\ncast(null as date) as pln_end_dt,\ncast(cast(a.cmodali as integer) as varchar(10)) as model_cd, \ncast(cast(a.ctipseg as integer) as varchar(10)) as  ins_type_cd,\ncast(cast(a.ccolect as integer) as varchar(10)) as pkg_cd,\ncast('axis' as varchar(10)) as src_sys_cd,\ncurrent_date as rec_crt_dtm,\ncurrent_date as rec_updt_dtm,\n1 as dummy\nfrom cdp_ods.sisaxis_productos a\n\nleft join\n(select ref_cd,ref_desc,mkt_ref_code,mkt_ref_code_desc from cdp_stg_dwh.stg_tref_code_map_variant \nwhere ref_type_cd='product_cd' and src_sys_cd = 'axis')RDM\non trim(RDM.ref_cd)=trim(cast(cast (a.sproduc as integer) as varchar(10)))\n\ninner join\ncdp_ods.sisaxis_activiprod b\non cast(a.CRAMO as integer)=cast(b.CRAMO as integer)\nand cast(a.CMODALI as integer)=cast(b.CMODALI as integer)\nand cast(a.CTIPSEG as integer)=cast(b.CTIPSEG as integer)\nand cast(a.ccolect as integer)=cast(b.ccolect as integer)\n\nleft join\n(select ref_cd,ref_desc,mkt_ref_code,mkt_ref_code_desc from cdp_stg_dwh.stg_tref_code_map_variant \nwhere ref_type_cd='plan_cd' and src_sys_cd = 'axis')RD\non trim(RD.ref_cd)=trim(cast((cast(b.cramo as integer)||'|'||cast(b.cactivi as integer)) as varchar(10)))\n\ninner join \ncdp_ods.sisaxis_activisegu c\non \ncast(b.CACTIVI as integer)=cast(c.CACTIVI as integer)\nand cast(b.cramo as integer)=cast(c.cramo as integer)\ninner join \ncdp_ods.sisaxis_titulopro d\non cast(a.CRAMO as integer)=cast(d.CRAMO as integer)\nand cast(a.CMODALI as integer)=cast(d.CMODALI as integer)\nand cast(a.CTIPSEG as integer)=cast(d.CTIPSEG as integer)\nand cast(a.ccolect as integer)=cast(d.ccolect as integer)\n) src\nleft join\n(select 1 as dummy, max(dim_prd_pln_hrchy_key) as MAX_SID from cdp_dwh.dim_prd_pln_hrchy_t) LKP_MAXSID\non src.dummy = LKP_MAXSID.dummy\n) where row_cnt = 1\nand lob_cd is not null \nand prd_cd is not null\n and pln_cd is not null"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[1].dataAdapter.object.customQuery",
        "value": "select \nsrc.dim_prd_pln_hrchy_key,\nsrc.prd_cd,\nsrc.pln_cd,\nsrc.lob_cd,\nsrc.src_sys_cd\nfrom cdp_dwh.dim_prd_pln_hrchy_t src\nwhere src.src_sys_cd='axis'"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[4].dataAdapter.runtimeAttributes.attributes[15]",
        "name": "Post-sql",
        "value": "update cdp_dwh.DIM_CLAIM_T\nset    dim_prd_pln_hrchy_key = PLAN_HIRE.dim_prd_pln_hrchy_key\nfrom   cdp_ods.sisaxis_seguros seg JOIN \n       cdp_dwh.DIM_CLAIM_T claim ON claim.policy_id=seg.sseguro JOIN\n       cdp_dwh.dim_prd_pln_hrchy_t PLAN_HIRE ON  PLAN_HIRE.prd_cd=CAST(CAST(SEG.sproduc AS INTEGER) AS VARCHAR(10))\nAND PLAN_HIRE.lob_cd=CAST(CAST(SEG.cramo AS INTEGER) AS VARCHAR(10))\nAND PLAN_HIRE.pln_cd=CAST(CAST(SEG.cactivi AS INTEGER) AS VARCHAR(10))\nAND PLAN_HIRE.src_sys_cd='axis' \nAND claim.src_sys_cd='axis'; /*Added as part of DID-229.*/\n\ncommit;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[5].dataAdapter.runtimeAttributes.attributes[15]",
        "name": "Post-sql",
        "value": "update cdp_dwh.DIM_CLAIM_T\nset    dim_prd_pln_hrchy_key = PLAN_HIRE.dim_prd_pln_hrchy_key\nfrom   cdp_ods.sisaxis_seguros seg JOIN \n       cdp_dwh.DIM_CLAIM_T claim ON claim.policy_id=seg.sseguro JOIN\n       cdp_dwh.dim_prd_pln_hrchy_t PLAN_HIRE ON  PLAN_HIRE.prd_cd=CAST(CAST(SEG.sproduc AS INTEGER) AS VARCHAR(10))\nAND PLAN_HIRE.lob_cd=CAST(CAST(SEG.cramo AS INTEGER) AS VARCHAR(10))\nAND PLAN_HIRE.pln_cd=CAST(CAST(SEG.cactivi AS INTEGER) AS VARCHAR(10))\nAND PLAN_HIRE.src_sys_cd='axis' \nAND claim.src_sys_cd='axis'; /*Added as part of DID-229.*/\n\ncommit;"
    }
]