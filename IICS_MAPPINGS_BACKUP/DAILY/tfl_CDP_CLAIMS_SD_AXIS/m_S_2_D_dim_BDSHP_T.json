[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "SELECT  \nCAST(SRC_AXIS.bdshp_id AS INTEGER),\nCAST(SRC_AXIS.tbuscar AS VARCHAR(100)),\nCAST(SRC_AXIS.bdshp_network_ind AS CHAR(1)),\nCAST(SRC_AXIS.NNUMNIF AS VARCHAR(35)),\nCAST(SRC_AXIS.src_sys_cd AS VARCHAR(10)),\nCAST(SRC_AXIS.bdshp_type_desc AS VARCHAR(80)),\nSRC_AXIS.rec_crt_dtm,\nLKP.MAX_SID\nFROM\n(\nSELECT\nCAST(B.bdshp_id AS INTEGER),\nCAST(B.tbuscar AS VARCHAR(100)),\nCAST(B.bdshp_network_ind AS CHAR(1)),\nCAST(B.NNUMNIF AS VARCHAR(35)),\nCAST(B.src_sys_cd AS VARCHAR(10)),\nCAST(B.bdshp_type_desc AS VARCHAR(80)),\nB.profesionales_rec_crt_dtm AS rec_crt_dtm,\n1 as DUMMY\nFROM\n(\nSELECT \nCAST(A.SPERSON AS INTEGER) AS bdshp_id,\n--CAST(A.tbuscar AS VARCHAR(100)),\nCAST(translate(A.tbuscar,'#','') AS VARCHAR(100)) as tbuscar,\nCAST(A.bdshp_network_ind AS CHAR(1)),\nCAST(A.NNUMNIF AS VARCHAR(35)),\nCAST(A.src_sys_cd AS VARCHAR(10)),\nCASE WHEN CAST(MT_MARCA_VEHICULO. CD_TIPO AS INTEGER)=1 AND bdshp_typ_cnt.CNT=1 THEN 'Concesionario'\nWHEN CAST(MT_MARCA_VEHICULO. CD_TIPO AS INTEGER)=2 AND bdshp_typ_cnt.CNT=1 THEN 'Multimarca'\nWHEN  bdshp_typ_cnt.CNT=2 THEN  'CONCESIONARIO Y MULTIMARCA' /*Added as part of sprint 2.6 based on Isabel Defect */\nELSE NULL END AS bdshp_type_desc,\nA.profesionales_rec_crt_dtm,\nROW_NUMBER() OVER (PARTITION BY A.SPERSON ORDER BY A.profesionales_rec_crt_dtm DESC) AS RNK_1\nFROM \n(SELECT \nCAST(PROFESIONALES.SPERSON AS INTEGER),\nCAST(PERSONAS.tbuscar AS VARCHAR(100)),\nNULL AS bdshp_network_ind,\nCAST(PERSONAS.NNUMNIF AS VARCHAR(35)),\n'axis' AS src_sys_cd,\nPROFESIONALES.rec_crt_dtm AS profesionales_rec_crt_dtm\nFROM cdp_stg_dwh.sisaxis_profesionales as PROFESIONALES \nInner Join cdp_ods.sisaxis_personas as PERSONAS \nON PERSONAS.SPERSON = PROFESIONALES.SPERSON\nWHERE CACTPRO = 90) AS A\nLEFT JOIN cdp_ods.sisaxis_mt_marca_vehiculo AS MT_MARCA_VEHICULO\nON A.SPERSON = MT_MARCA_VEHICULO.SPERSON\nLEFT JOIN(\nSELECT COUNT(A.CNT) AS CNT ,A.SPERSON FROM\n(SELECT DISTINCT(MT_MARCA_VEHICULO. CD_TIPO) AS CNT,PROFESIONALES.SPERSON \nFROM cdp_stg_dwh.sisaxis_profesionales as PROFESIONALES \nInner Join cdp_ods.sisaxis_personas as PERSONAS \nON PERSONAS.SPERSON = PROFESIONALES.SPERSON\nINNER JOIN cdp_ods.sisaxis_mt_marca_vehiculo AS MT_MARCA_VEHICULO\nON PROFESIONALES.SPERSON = MT_MARCA_VEHICULO.SPERSON\nWHERE PROFESIONALES.CACTPRO = 90)A\nGROUP BY A.SPERSON\n)bdshp_typ_cnt\nON A.SPERSON=bdshp_typ_cnt.SPERSON\n) AS B\nWHERE B.RNK_1=1 ) AS SRC_AXIS\nLEFT JOIN (SELECT 1 as DUMMY, max(dim_bdshp_key) AS MAX_SID from cdp_dwh.dim_bdshp_t) LKP\nON LKP.DUMMY=SRC_AXIS.DUMMY"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[1].dataAdapter.object.customQuery",
        "value": "SELECT\nSTG.dim_bdshp_key,\nSTG.bdshp_id,\n--STG.bdshp_name,\n--STG.bdshp_network_ind,\nSTG.src_sys_cd\n--STG.bdshp_type_desc,\n--STG.bdshp_rut_num,\n--STG.rec_crt_dtm,\n--STG.rec_updt_dtm,\n--STG.actv_rec_ind,\n--STG.etl_audit_id\nFROM  cdp_dwh.dim_bdshp_t STG\nWHERE STG.src_sys_cd='axis' --"
    }
]