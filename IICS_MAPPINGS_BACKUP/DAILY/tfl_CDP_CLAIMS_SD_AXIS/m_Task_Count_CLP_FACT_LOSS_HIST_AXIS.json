[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select distinct CAST(claim_num AS VARCHAR(35)),claimant_num,loss_item_num,CAST(curr_code AS VARCHAR(10)),record_eff_dtm from\n(\nselect pagosinitrami.NSINIES AS claim_num, pagosinitrami.NTRAMIT as claimant_num,pagosinitrami.NTRAMIT as loss_item_num,\npagosinitrami.cmonpag as curr_code, cast(min(pagosinitrami.FALTA) as date) as record_eff_dtm  from cdp_stg_dwh.sisaxis_pagosinitrami pagosinitrami\ngroup by 1,2,3,4\nunion\nselect reservasinitrami.NSINIES AS claim_num, reservasinitrami.NTRAMIT as claimant_num,reservasinitrami.NTRAMIT as loss_item_num,\nreservasinitrami.CMONRES as curr_code, cast(min(reservasinitrami.FALTA) as date) as record_eff_dtm  from cdp_stg_dwh.sisaxis_reservasinitrami reservasinitrami\ngroup by 1,2,3,4\nunion\nselect REPARACION.AUOR_SISI_NU_SINIESTRO  AS claim_num, REPARACION.AUOR_NU_IMPLICADO  as claimant_num,REPARACION.AUOR_NU_IMPLICADO  as loss_item_num,\n'CLP' as curr_code, cast(min(REPARACION.AUOR_FE_REGISTRO) as date) as record_eff_dtm  from cdp_stg_dwh.SISSINIESTRO_AUTT_ORDENES_REPARACION REPARACION\ngroup by 1,2,3,4\nunion\nselect a.AUDL_AUOR_NU_SINIESTRO AS claim_num, b.AUOR_NU_IMPLICADO  as claimant_num,b.AUOR_NU_IMPLICADO  as loss_item_num,\n'CLP' as curr_code, cast(min(current_timestamp) as date) as record_eff_dtm  from cdp_stg_dwh.sissiniestro_autt_detalle_ordenes a\nINNER JOIN cdp_ods.sissiniestro_autt_ordenes_reparacion b ON a.audl_auor_nu_siniestro=b.AUOR_SISI_NU_SINIESTRO \n   AND a.audl_auor_nu_orden = b.AUOR_NU_ORDEN_REPARACION    AND a.audl_auor_nu_ajuste= b.auor_auad_nu_ajuste\ngroup by 1,2,3,4\n\n)sub\nWHERE 1=2"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[1].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "INSERT INTO cdp_stg_dwh.stg_fact_loss_history_t_axis_driver (claim_num, claimant_num, loss_item_num, curr_code, record_eff_dtm) \nselect \nA.claim_num as claim_num,\nA.claimant_num as claimant_num,\nA.claimant_num as loss_item_num,\n'CLP' as curr_cd,\nA.record_eff_dtm as rec_eff_dtm \nfrom \n(SELECT DISTINCT claim_num,claimant_num,min(record_eff_dtm) record_eff_dtm FROM cdp_stg_dwh.stg_fact_loss_history_t_axis_driver \nWHERE (claim_num,claimant_num) not in \n(SELECT DISTINCT claim_num,claimant_num FROM cdp_stg_dwh.stg_fact_loss_history_t_axis_driver \nWHERE curr_code='CLP' \nUNION \nSELECT DISTINCT claim_num,claimant_num FROM cdp_dwh.fact_loss_history_t \nWHERE curr_cd='CLP' AND src_sys_cd = 'axis' AND ltst_rec_ind='Y') group by claim_num,claimant_num)A"
    }
]