[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select * from (\n-------Initial Insert of 11,000 dates and axis_acct_clsng_dt-------\nselect cal_dt,\nday_num,\nday_name_1,\nday_name_2,\nwk_num,\nmth_num,\nmth_name_1,\nmth_name_2,\nqtr_num,\nyr_num,\naxis_acct_clsng_dt,\nDATE_PART('mon', axis_acct_clsng_dt)::smallint AS axis_acct_mth_num, \nDATE_PART('y', axis_acct_clsng_dt)::smallint AS axis_acct_yr_num,\npenta_acct_clsng_dt,\npenta_acct_mth_num,\npenta_acct_yr_num,\nactv_rec_ind,\netl_audit_id,\n'I' as Ind \nfrom\n(select cast(src.cal_dt as date) cal_dt,\nsrc.day_num,\nsrc.day_name_1,\nsrc.day_name_2,\nsrc.wk_num,\nsrc.mth_num,\nsrc.mth_name_1,\nsrc.mth_name_2,\nsrc.qtr_num,\nsrc.yr_num,\ncast(a.fcierre as date)as axis_acct_clsng_dt,\ncast(NULL as date) as penta_acct_clsng_dt,\ncast(NULL as smallint)as penta_acct_mth_num,\ncast(NULL as smallint) as penta_acct_yr_num,\ncast('Y' as char(1))as actv_rec_ind,\ncast(NULL as integer)as etl_audit_id\nfrom \n(SELECT \n   date_gen.dt AS cal_dt, \n   DATE_PART('day', date_gen.dt)::smallint AS day_num, \n   CASE DATE_PART('dow', date_gen.dt) \n    WHEN 0 THEN 'Sunday' \n    WHEN 1 THEN 'Monday' \n    WHEN 2 THEN 'Tuesday' \n    WHEN 3 THEN 'Wednesday' \n    WHEN 4 THEN 'Thursday' \n    WHEN 5 THEN 'Friday' \n    WHEN 6 THEN 'Saturday' \n   END::VARCHAR(35) AS day_name_1,\n    CASE DATE_PART('dow', date_gen.dt) \n    WHEN 0 THEN 'domingo' \n    WHEN 1 THEN 'lunes' \n    WHEN 2 THEN 'martes' \n    WHEN 3 THEN 'mi\u00c3\u00a9rcoles' \n    WHEN 4 THEN 'jueves' \n    WHEN 5 THEN 'viernes' \n    WHEN 6 THEN 's\u00c3\u00a1bado' \n   END::VARCHAR(35) AS day_name_2,\n   DATE_PART('mon', date_gen.dt)::smallint AS mth_num, \n   CASE DATE_PART('mon', date_gen.dt)::smallint \n    WHEN 1 THEN 'January' \n    WHEN 2 THEN 'February' \n    WHEN 3 THEN 'March' \n    WHEN 4 THEN 'April' \n    WHEN 5 THEN 'May' \n    WHEN 6 THEN 'June' \n    WHEN 7 THEN 'July' \n    WHEN 8 THEN 'August' \n    WHEN 9 THEN 'September' \n    WHEN 10 THEN 'October' \n    WHEN 11 THEN 'November' \n    WHEN 12 THEN 'December' \n   END::VARCHAR(35) AS mth_name_1,\n    CASE DATE_PART('mon', date_gen.dt)::smallint \n    WHEN 1 THEN 'enero' \n    WHEN 2 THEN 'febrero' \n    WHEN 3 THEN 'marzo' \n    WHEN 4 THEN 'abril' \n    WHEN 5 THEN 'mayo' \n    WHEN 6 THEN 'junio' \n    WHEN 7 THEN 'julio' \n    WHEN 8 THEN 'agosto' \n    WHEN 9 THEN 'septiembre' \n    WHEN 10 THEN 'octubre' \n    WHEN 11 THEN 'noviembre' \n    WHEN 12 THEN 'diciembre' \n   END::VARCHAR(35) AS mth_name_2,\n   DATE_PART('qtr', date_gen.dt)::smallint AS qtr_num, \n   DATE_PART('y', date_gen.dt)::smallint AS yr_num, \n   DATE_PART('w', date_gen.dt)::smallint AS wk_num\n   FROM \n  (SELECT  \n      ('2031-01-01' - n)::date AS dt FROM (SELECT row_number() over () AS n FROM stl_scan LIMIT 11000)) date_gen)src\nleft join\n(SELECT fcierre,fperini,fperfin FROM cdp_ods.sisaxis_cierres \nwhere \n--CESTADO = 1 AND /*Commented for DID-225*/\nctipo = 7\nORDER BY FCIERRE DESC)a\non cast(src.cal_dt as date) >= cast(a.fperini as date)\nand cast(src.cal_dt as date) <= cast(a.fperfin as date) \nleft join \n(select cal_dt from cdp_dwh.dim_cal_t)dim\non cast(src.cal_dt as date) = cast(dim.cal_dt as date)\nwhere dim.cal_dt is NULL\n)\nUNION\n--- Incremental Insert will insert one record for each run------\nselect cal_dt,\nday_num,\nday_name_1,\nday_name_2,\nwk_num,\nmth_num,\nmth_name_1,\nmth_name_2,\nqtr_num,\nyr_num,\naxis_acct_clsng_dt,\nNULL::smallint AS axis_acct_mth_num, \nNULL::smallint AS axis_acct_yr_num,\npenta_acct_clsng_dt,\npenta_acct_mth_num,\npenta_acct_yr_num,\nactv_rec_ind,\netl_audit_id,\n'I' as Ind \nfrom\n(select cast(src.cal_dt as date) cal_dt,\nsrc.day_num,\nsrc.day_name_1,\nsrc.day_name_2,\nsrc.wk_num,\nsrc.mth_num,\nsrc.mth_name_1,\nsrc.mth_name_2,\nsrc.qtr_num,\nsrc.yr_num,\ncast(NULL as date)as axis_acct_clsng_dt,\ncast(NULL as date) as penta_acct_clsng_dt,\ncast(NULL as smallint)as penta_acct_mth_num,\ncast(NULL as smallint) as penta_acct_yr_num,\ncast('Y' as char(1))as actv_rec_ind,\ncast(NULL as integer)as etl_audit_id\nfrom \n(SELECT \n   date_gen.dt AS cal_dt, \n   DATE_PART('day', date_gen.dt)::smallint AS day_num, \n   CASE DATE_PART('dow', date_gen.dt) \n    WHEN 0 THEN 'Sunday' \n    WHEN 1 THEN 'Monday' \n    WHEN 2 THEN 'Tuesday' \n    WHEN 3 THEN 'Wednesday' \n    WHEN 4 THEN 'Thursday' \n    WHEN 5 THEN 'Friday' \n    WHEN 6 THEN 'Saturday' \n   END::VARCHAR(35) AS day_name_1,\n    CASE DATE_PART('dow', date_gen.dt) \n    WHEN 0 THEN 'domingo' \n    WHEN 1 THEN 'lunes' \n    WHEN 2 THEN 'martes' \n    WHEN 3 THEN 'mi\u00c3\u00a9rcoles' \n    WHEN 4 THEN 'jueves' \n    WHEN 5 THEN 'viernes' \n    WHEN 6 THEN 's\u00c3\u00a1bado' \n   END::VARCHAR(35) AS day_name_2,\n   DATE_PART('mon', date_gen.dt)::smallint AS mth_num, \n   CASE DATE_PART('mon', date_gen.dt)::smallint \n    WHEN 1 THEN 'January' \n    WHEN 2 THEN 'February' \n    WHEN 3 THEN 'March' \n    WHEN 4 THEN 'April' \n    WHEN 5 THEN 'May' \n    WHEN 6 THEN 'June' \n    WHEN 7 THEN 'July' \n    WHEN 8 THEN 'August' \n    WHEN 9 THEN 'September' \n    WHEN 10 THEN 'October' \n    WHEN 11 THEN 'November' \n    WHEN 12 THEN 'December' \n   END::VARCHAR(35) AS mth_name_1,\n    CASE DATE_PART('mon', date_gen.dt)::smallint \n    WHEN 1 THEN 'enero' \n    WHEN 2 THEN 'febrero' \n    WHEN 3 THEN 'marzo' \n    WHEN 4 THEN 'abril' \n    WHEN 5 THEN 'mayo' \n    WHEN 6 THEN 'junio' \n    WHEN 7 THEN 'julio' \n    WHEN 8 THEN 'agosto' \n    WHEN 9 THEN 'septiembre' \n    WHEN 10 THEN 'octubre' \n    WHEN 11 THEN 'noviembre' \n    WHEN 12 THEN 'diciembre' \n   END::VARCHAR(35) AS mth_name_2,\n   DATE_PART('qtr', date_gen.dt)::smallint AS qtr_num, \n   DATE_PART('y', date_gen.dt)::smallint AS yr_num, \n   DATE_PART('w', date_gen.dt)::smallint AS wk_num\n   FROM \n  (SELECT  \n      (dat+1)::date AS dt FROM (SELECT max(cal_dt) as dat from cdp_dwh.dim_cal_t)) date_gen)src\n)\nUNION\n---------Incremental Update for Axis_Closing_Date-----\nselect cal_dt,\nday_num,\nday_name_1,\nday_name_2,\nwk_num,\nmth_num,\nmth_name_1,\nmth_name_2,\nqtr_num,\nyr_num,\naxis_acct_clsng_dt,\nDATE_PART('mon', axis_acct_clsng_dt)::smallint AS axis_acct_mth_num, \nDATE_PART('y', axis_acct_clsng_dt)::smallint AS axis_acct_yr_num,\npenta_acct_clsng_dt,\npenta_acct_mth_num,\npenta_acct_yr_num,\nactv_rec_ind,\netl_audit_id,\n'U' as Ind\nfrom\n(select cast(src.cal_dt as date) cal_dt,\nsrc.day_num,\nsrc.day_name_1,\nsrc.day_name_2,\nsrc.wk_num,\nsrc.mth_num,\nsrc.mth_name_1,\nsrc.mth_name_2,\nsrc.qtr_num,\nsrc.yr_num,\ncast(a.fcierre as date)as axis_acct_clsng_dt,\ncast(NULL as date) as penta_acct_clsng_dt,\ncast(NULL as smallint)as penta_acct_mth_num,\ncast(NULL as smallint) as penta_acct_yr_num,\ncast('Y' as char(1))as actv_rec_ind,\ncast(NULL as integer)as etl_audit_id\nfrom \n(select \ncal_dt,\nday_num,\nday_name_1,\nday_name_2,\nwk_num,\nmth_num,\nmth_name_1,\nmth_name_2,\nqtr_num,\nyr_num,\naxis_acct_clsng_dt,\naxis_acct_mth_num,\naxis_acct_yr_num,\npenta_acct_clsng_dt,\npenta_acct_mth_num,\npenta_acct_yr_num,\nrec_crt_dtm,\nrec_updt_dtm,\nactv_rec_ind,\netl_audit_id from cdp_dwh.dim_Cal_t)src\ninner join\n(SELECT fcierre,fperini,fperfin FROM cdp_ods.sisaxis_cierres \nwhere \n--CESTADO = 1 AND  -- Commented this part as per Guillermo\nctipo = 7\nORDER BY FCIERRE DESC)a\non cast(src.cal_dt as date) >= cast(a.fperini as date)\nand cast(src.cal_dt as date) <= cast(a.fperfin as date) \nwhere src.axis_acct_clsng_dt is NULL\n))where cal_dt is not null"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[1].dataAdapter.object.customQuery",
        "value": "select cal_dt from cdp_dwh.dim_cal_t;"
    }
]