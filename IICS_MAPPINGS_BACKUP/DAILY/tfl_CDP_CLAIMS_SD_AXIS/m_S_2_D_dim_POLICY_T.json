[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select\n src_sys_cd,\n policy_id,\n policy_num,\n policy_term_cd,\n policy_term_desc,\n policy_item_count,\n contract_num,\n quot_num,\n policy_issue_dt,\n policy_eff_dt,\n policy_exp_dt,\n contract_desc,\n actv_rec_ind,\n max_sid\n from\n (\n select \n SRC.src_sys_cd,\n SRC.policy_id,\n SRC.policy_num,\n SRC.policy_term_cd,\n SRC.policy_term_desc,\n SRC.policy_item_count,\n SRC.contract_num,\n SRC.quot_num,\n SRC.policy_issue_dt,\n SRC.policy_eff_dt,\n SRC.policy_exp_dt,\n SRC.contract_desc,\n SRC.actv_rec_ind,\n row_number()over(partition by SRC.policy_id order by SRC.rec_crt_dtm desc ) as row_cnt,\n LKP_MAX_KEY.max_sid \n from\n (\n select distinct\n cast('axis'as varchar(10)) as src_sys_cd,\n cast(a.sseguro as integer) as policy_id,\n  --cast(cast(a.npoliza as integer) as varchar(35)) as policy_num,\n cast(TRUNC(a.npoliza) as varchar(35)) as policy_num,\n cast(cast(a.cduraci as integer) as varchar(10)) as policy_term_cd,\n cast(pol_term.REF_DESC as varchar(80)) as policy_term_desc,\n cast(pol_cnt.policy_item_count as integer) as policy_item_count,\n cast(a.CAGRSEG as varchar(35)) as contract_num,\n --cast(cast(a.NSOLICI as integer) as varchar(50)) as quot_num,\n cast(TRUNC(NSOLICI) as varchar(50)) as quot_num,\n cast(a.FEMISIO as date) as policy_issue_dt,\n cast(a.FEFECTO as date) as policy_eff_dt,\n cast(a.FVENCIM as date) as policy_exp_dt,\n cast(contract.REF_DESC as varchar(80)) as contract_desc,\n'Y' as actv_rec_ind,\n a.rec_crt_dtm as rec_crt_dtm\n from \n  (select sseguro,npoliza,cduraci,CAGRSEG,NSOLICI,FEMISIO,FEFECTO,FVENCIM,rec_crt_dtm from cdp_stg_dwh.sisaxis_seguros \n  where cast(ncertif as integer) =0) a  \nleft outer join \n(SELECT REF_CD, REF_DESC FROM cdp_stg_dwh.stg_tref_code_map_variant where ref_type_cd='policyterm_cd'and src_sys_cd = 'axis') pol_term\non cast(cast(a.cduraci as integer) as varchar(10))=pol_term.REF_CD\n left outer join \n (select count(ncertif) policy_item_count ,npoliza from cdp_ods.sisaxis_seguros where cast(ncertif as integer) >0 group by 2)pol_cnt\n on TRUNC(a.npoliza)=TRUNC(pol_cnt.npoliza)\n left outer join \n(SELECT REF_CD, REF_DESC FROM cdp_stg_dwh.stg_tref_code_map_variant where ref_type_cd='contract_num'and src_sys_cd = 'axis') contract\non cast(a.CAGRSEG as varchar(20))=contract.REF_CD\n ) SRC\n left outer join \n(select 1 dummy,max(dim_policy_key) max_sid  from  cdp_dwh.dim_policy_t) LKP_MAX_KEY\non LKP_MAX_KEY.dummy=1)\nwhere policy_id is not null and row_cnt=1"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[3].dataAdapter.object.customQuery",
        "value": "select src.dim_policy_key,src.policy_id,src.src_sys_cd from cdp_dwh.dim_policy_t src where src.src_sys_cd='axis'"
    }
]