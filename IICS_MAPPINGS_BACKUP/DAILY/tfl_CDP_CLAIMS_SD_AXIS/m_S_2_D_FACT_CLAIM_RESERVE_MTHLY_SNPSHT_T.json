[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select \nclaim_num,\nclaimant_num,\nloss_item_num,\nlob_cd,\ncov_cd,\nacct_dt,\nreserve_amt,\nceded_reserve_amt,\nretained_reserve_amt,\nreserve_amt_curr_cd,\ncoinsurance_reserve_amt,\ndim_claim_key,\ndim_claim_status_key,\ndim_claim_type_key,\ndim_branch_office_key,\ndim_claimant_key,\ndim_loss_item_key,\ndim_lob_key,\ndim_cov_key,\nsrc_sys_cd,\nrec_crt_dtm,\nactv_rec_ind,\nMAX_SID\nfrom \n(\nselect\ndistinct \nsrc.claim_num,\nsrc.claimant_num,\nsrc.loss_item_num,\nsrc.lob_cd,\nsrc.cov_cd,\nsrc.acct_dt,\nsrc.reserve_amt,\nsrc.ceded_reserve_amt,\nsrc.retained_reserve_amt,\nsrc.reserve_amt_curr_cd,\nsrc.coinsurance_reserve_amt,\nsrc.dim_claim_key,\nsrc.dim_claim_status_key,\nsrc.dim_claim_type_key,\nsrc.dim_branch_office_key,\nsrc.dim_claimant_key,\nsrc.dim_loss_item_key,\nsrc.dim_lob_key,\nsrc.dim_cov_key,\nsrc.src_sys_cd,\nsrc.rec_crt_dtm,\n'Y' as actv_rec_ind,\nLKP_MAXSID.MAX_SID,\nrow_number() over (partition by src.claim_num,src.claimant_num,src.loss_item_num, \nsrc.lob_cd,src.cov_cd,src.acct_dt order by src.rec_crt_dtm desc) as row_cnt\nfrom \n(\nselect \ndistinct \ncast (cie.cie_num_sin as varchar(35)) as claim_num,\ncast(cie.CIE_NTRAMIT as integer ) as claimant_num,\ncast (cie.CIE_NTRAMIT as integer) as loss_item_num,\ncast (g.lob_cd as varchar(10))as lob_cd,\ncast(h.cov_cd as varchar(10)) as cov_cd,\ncast(cast(cast(cie_per_con as integer) as varchar(10)) as date) as acct_dt,\ncast(cie.cie_mto_mo as numeric(25,10)) as reserve_amt, \ncast((cie.cie_mto_mo*(100-cie_por_par)/100)  - (cie.cie_mto_mo*( nvl(cie.cie_por_ret_dir,0) + nvl(cie.cie_por_ret_cnt,0) + nvl(cie.cie_por_ret_74,0) +\nnvl(cie.cie_pret_shortfall_t1,0) + nvl(cie.cie_pret_shortfall_t2,0) + nvl(cie.cie_pret_shortfall_t3,0)) /100) as numeric(25,10)) as ceded_reserve_amt,\ncast((cie.cie_mto_mo*( nvl(cie.cie_por_ret_dir,0) + nvl(cie.cie_por_ret_cnt,0) + nvl(cie.cie_por_ret_74,0) +\nnvl(cie.cie_pret_shortfall_t1,0) + nvl(cie.cie_pret_shortfall_t2,0) + nvl(cie.cie_pret_shortfall_t3,0)) /100) as numeric(25,10)) as retained_reserve_amt,\ncast(cie.cie_mon_seg as varchar(12))  as reserve_amt_curr_cd,\ncast(cie.cie_mto_mo*cie.cie_por_par/100 as numeric(25,10)) as coinsurance_reserve_amt,\ncast(nvl(c.dim_claim_key,0) as integer) as dim_claim_key,\ncast(nvl(d.dim_claim_status_key,0) as integer) as dim_claim_status_key,\ncast(nvl(e.dim_claim_type_key,0) as integer) as dim_claim_type_key,\ncast(nvl(f.dim_branch_office_key,0) as integer) as dim_branch_office_key,\ncast(nvl(j.dim_claimant_key,0) as integer) as dim_claimant_key,\ncast(nvl(k.dim_loss_item_key,0) as integer) as dim_loss_item_key,\ncast(nvl(g.dim_lob_key,0) as integer) as dim_lob_key,\ncast(nvl(h.dim_cov_key,0) as integer) as dim_cov_key,\ncast('axis' as varchar(10)) as src_sys_cd,\ncie.rec_crt_dtm as rec_crt_dtm,\n1 as dummy\nfrom \n (select * from cdp_stg_dwh.siscierres_sin_ciemen_tbl where cie_est_proceso = 1 \nand cie_tip_pro = 3 ) cie\nleft join cdp_ods.sisaxis_siniestros sis\non sis.NSINIES=cie.cie_num_sin\nleft join \n(select dim_claim_key, claim_num from cdp_dwh.dim_claim_t where src_sys_cd='axis') c\non c.claim_num=cie.cie_num_sin \nleft join \n(select dim_claim_status_key,claim_status_cd from cdp_dwh.dim_claim_status_t where src_sys_cd='axis') d\non  d.claim_status_cd=sis.CESTSIN \nleft join\n(select claim_type_cd, dim_claim_type_key from  cdp_dwh.dim_claim_type_t where src_sys_cd='axis') e\non e.claim_type_cd=sis.ccausin\nleft join\n(select dim_branch_office_key, branch_office_cd from cdp_dwh.dim_branch_office_t where src_sys_cd='axis')f\non cast(f.branch_office_cd as integer)=cast(cie.CIE_SUC_POL as integer)\nleft join \n(select lob_cd, dim_lob_key from cdp_dwh.dim_lob_t where src_sys_cd='axis') g\non cie.CIE_CRAMO=g.lob_cd\nleft join\n(select dim_cov_key,cov_cd from cdp_dwh.dim_cov_type_t where src_sys_cd='axis') h\non cie.CIE_COD_COB=h.cov_cd\nleft join\n(select claim_num, claimant_num, dim_claimant_key from cdp_dwh.dim_claimant_t where src_sys_cd='axis') j\non j.claim_num=cie.cie_num_sin\nand cast(j.claimant_num as integer)=cast(cie.CIE_NTRAMIT as integer)\nleft join \n(select dim_loss_item_key, claim_num, loss_item_num from cdp_dwh.dim_loss_item_t where src_sys_cd='axis') k\non k.claim_num=cie.cie_num_sin\nand k.loss_item_num=cie.CIE_NTRAMIT\n)\nsrc\nleft join\n(select 1 as dummy, max(fact_reserve_activity_key) as MAX_SID from cdp_dwh.fact_claim_reserve_mthly_snpsht_t) LKP_MAXSID\non src.dummy = LKP_MAXSID.dummy\n)\nwhere row_cnt = 1"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[1].dataAdapter.object.customQuery",
        "value": "select\nsrc.fact_reserve_activity_key,\nsrc.src_sys_cd,\nsrc.claim_num,\nsrc.claimant_num,\nsrc.loss_item_num,\nsrc.lob_cd,\nsrc.cov_cd,\nsrc.acct_dt\nfrom \ncdp_dwh.fact_claim_reserve_mthly_snpsht_t src\nwhere src.src_sys_cd='axis'"
    }
]