[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "SELECT * from (select \nCAST(SRC.claim_number AS INTEGER) AS claim_number,\nCAST(SRC.loss_item_number AS INTEGER) AS loss_item_number ,\nCAST(SRC.loss_item_id AS VARCHAR(35)) AS loss_item_id,\nCAST(SRC.insured_item_ind AS CHAR(1)) AS insured_item_ind,\nCAST(SRC.lic_plate_num AS VARCHAR(35)) AS lic_plate_num,\nCAST(SRC.vehicle_yr AS CHAR(4)) AS vehicle_yr,\nCAST(round(SRC.exposure_type_cd) AS VARCHAR(10)) AS exposure_type_cd,\nCAST(SRC.exposure_type_desc AS VARCHAR(80)) AS exposure_type_desc,\nCAST(round(SRC.loss_item_type_cd) AS VARCHAR(10)) AS loss_item_type_cd,\nCAST(SRC.loss_item_type_desc AS VARCHAR(4800)) AS loss_item_type_desc,\nCAST(SRC.src_sys_cd AS VARCHAR(10)) AS src_sys_cd,\nCAST(SRC.vehicle_make AS VARCHAR(35)) AS vehicle_make,\nCAST(SRC.vehicle_model AS VARCHAR(35)) AS vehicle_model,\nCAST(SRC.vehicle_type_desc AS VARCHAR(80)) AS vehicle_type_desc,\nCAST(SRC.vehicle_type_cd AS VARCHAR(10)) AS vehicle_type_cd,\nCAST(SRC.vin_num AS VARCHAR(35)) AS vin_num,\nCAST(SRC.veh_class_cd AS VARCHAR(10)) AS veh_class_cd,\nCAST(SRC.vechicle_class_desc AS VARCHAR(80)) AS vechicle_class_desc,\nCAST(SRC.rec_crt_dtm AS TIMESTAMP) AS rec_crt_dtm,\nCAST(LKP_MAX_KEY.max_sid AS INTEGER),\nrow_number()over(partition by src.claim_number,loss_item_number order by src.rec_crt_dtm desc) rnk\nFROM\n(SELECT\nCAST(AXIS_SRC.claim_number AS INTEGER) AS claim_number,\nCAST(AXIS_SRC.loss_item_number AS INTEGER) AS loss_item_number ,\nCAST(AXIS_SRC.loss_item_id AS VARCHAR(35)) AS loss_item_id,\nCAST(AXIS_SRC.insured_item_ind AS CHAR(1)) AS insured_item_ind,\nCAST(AXIS_SRC.lic_plate_num AS VARCHAR(35)) AS lic_plate_num,\nCAST(AXIS_SRC.vehicle_yr AS CHAR(4)) AS vehicle_yr,\nCAST(AXIS_SRC.exposure_type_cd AS VARCHAR(10)) AS exposure_type_cd,\nCAST(AXIS_SRC.exposure_type_desc AS VARCHAR(80)) AS exposure_type_desc,\nCAST(AXIS_SRC.loss_item_type_cd AS VARCHAR(10)) AS loss_item_type_cd,\nCAST(AXIS_SRC.loss_item_type_desc AS VARCHAR(4800)) AS loss_item_type_desc,\nCAST(AXIS_SRC.src_sys_cd AS VARCHAR(10)) AS src_sys_cd,\nCAST(AXIS_SRC.vehicle_make AS VARCHAR(35)) AS vehicle_make,\nCAST(AXIS_SRC.vehicle_model AS VARCHAR(35)) AS vehicle_model,\nCAST(AXIS_SRC.vehicle_type_desc AS VARCHAR(80)) AS vehicle_type_desc,\nCAST(AXIS_SRC.vehicle_type_cd AS VARCHAR(10)) AS vehicle_type_cd,\nCAST(AXIS_SRC.vin_num AS VARCHAR(35)) AS vin_num,\nCAST(AXIS_SRC.veh_class_cd AS VARCHAR(10)) AS veh_class_cd,\nCAST(AXIS_SRC.vechicle_class_desc AS VARCHAR(80)) AS vechicle_class_desc,\nCAST(AXIS_SRC.rec_crt_dtm AS TIMESTAMP) AS rec_crt_dtm,\nAXIS_SRC.dummy\nFROM\n(SELECT\nSUB_1.claim_number,\nSUB_1.loss_item_number,\nSUB_1.loss_item_id,\nSUB_1.insured_item_ind,\nSUB_1.lic_plate_num,\nSUB_1.vehicle_yr,\nSUB_1.exposure_type_cd,\nSUB_1.exposure_type_desc,\nSUB_1.loss_item_type_cd,\nSUB_1.loss_item_type_desc,\nSUB_1.src_sys_cd,\nSUB_1.vehicle_make,\nSUB_1.vehicle_model,\nSUB_1.vehicle_type_desc,\nSUB_1.vehicle_type_cd,\nSUB_1.vin_num,\nSUB_1.veh_class_cd,\nSUB_1.vechicle_class_desc,\nSUB_1.rec_crt_dtm,\nSUB_1.dummy,\nrow_number()over(partition by SUB_1.claim_number,SUB_1.loss_item_number order by SUB_1.rec_crt_dtm desc) as row_cnt\nFROM\n(\nselect distinct  cast (sisaxis_tramitacionsini.NSINIES as integer) as claim_number,\ncast(sisaxis_tramitacionsini.NTRAMIT as integer ) as loss_item_number,\ncast(sisaxis_tramitacionsini.SPERSON as integer) as loss_item_id,\ncase  when sisaxis_tramitacionsini.NTRAMIT=1 then 'S' else 'N' end as insured_item_ind,\nCASE WHEN sisaxis_tramitacionsini.NTRAMIT=1  THEN aut1.cmatric ELSE sisaxis_tramitacionsini.CMATRIC END AS lic_plate_num,\nsisaxis_tramitacionsini.CMATRIC,\nsisaxis_tramitacionsini.CMARCA,\nsisaxis_tramitacionsini.NANOFAB,\ncast(sisaxis_tramitacionsini.CCAUEST as varchar(10)) as exposure_type_cd,\ncast(sisaxis_CAUSAESTSIN.TCAUEST as varchar(80))as exposure_type_desc,\ncast(sisaxis_tramitacionsini.CTRAMIT as varchar(10)) as loss_item_type_cd,\ncast(sisaxis_DESTRAMITACION.TTRAMIT as varchar(2000)) as loss_item_type_desc,\nCAST('axis' AS VARCHAR(10)) AS src_sys_cd ,                                                       \nCASE WHEN sisaxis_tramitacionsini.ntramit = 1 THEN NVL(veh_make_1.mkt_ref_code_desc,mar_1.TMARCA)\nWHEN sisaxis_tramitacionsini.ntramit<>1 AND sisaxis_tramitacionsini.CMARCA IS NULL OR LTRIM(RTRIM(sisaxis_tramitacionsini.CMARCA))=''THEN NULL\nELSE NVL(veh_make_2.mkt_ref_code_desc,mar_2.TMARCA) \nEND AS vehicle_make,\nCASE WHEN sisaxis_tramitacionsini.ntramit = 1 THEN NVL(veh_model_1.mkt_ref_code_desc,AUTMODELOS_1.TMODELO)\nELSE NVL(veh_model_2.mkt_ref_code_desc,AUTMODELOS_2.TMODELO) END AS vehicle_model,\nCASE WHEN sisaxis_tramitacionsini.ntramit = 1 THEN aut1.nanofab\nELSE sisaxis_tramitacionsini.NANOFAB END AS vehicle_yr,\nCASE WHEN sisaxis_tramitacionsini.ntramit = 1 THEN NVL(veh_type_cd_1.mkt_ref_code_desc,AUTTIPVEHICULOS_1.ttipveh)\nELSE NVL(veh_type_cd_2.mkt_ref_code_desc,AUTTIPVEHICULOS_2.ttipveh) END AS vehicle_type_desc,\nCASE WHEN sisaxis_tramitacionsini.ntramit = 1 THEN NVL(veh_type_cd_1.mkt_ref_code,sisaxis_autversiones.CTIPVEH)\nELSE NVL(veh_type_cd_2.mkt_ref_code,sisaxis_tramitacionsini.CTIPVEH) END  AS  vehicle_type_cd,\nnull as vin_num,\nnull as veh_class_cd,\nnull as vechicle_class_desc,\nsisaxis_tramitacionsini.rec_crt_dtm,\n1 AS dummy\nfrom (Select * from cdp_stg_dwh.sisaxis_tramitacionsini where ntramit <> 0  ) sisaxis_tramitacionsini\nleft outer join cdp_ods.sisaxis_CAUSAESTSIN\non sisaxis_tramitacionsini.CCAUEST = sisaxis_CAUSAESTSIN.CCAUEST\nleft outer join cdp_ods.sisaxis_DESTRAMITACION\non sisaxis_tramitacionsini.CTRAMIT = sisaxis_DESTRAMITACION.CTRAMIT\nLEFT OUTER JOIN cdp_ods.sisaxis_siniestros sin\nON sin.nsinies = sisaxis_tramitacionsini.nsinies\nLEFT OUTER JOIN \n(\nSelect row_number() over(partition by t.NSINIES,t.NTRAMIT,t.SPERSON order by aut1.nmovimi desc) as row_num,\nt.NSINIES,t.NTRAMIT,t.SPERSON ,aut1.nmovimi,\naut1.sseguro,aut1.nriesgo,aut1.CVERSION,aut1.cmatric,aut1.nanofab\nfrom cdp_stg_dwh.sisaxis_tramitacionsini t\ninner join cdp_ods.sisaxis_siniestros sin\nON sin.nsinies = t.nsinies\nand ntramit <> 0\ninner join cdp_ods.sisaxis_autriesgos aut1\nON aut1.sseguro = sin.sseguro\nAND aut1.nriesgo = sin.nriesgo\ninner join cdp_ods.sisaxis_movseguro mov\non aut1.sseguro = mov.sseguro\nand cast(mov.fefecto as date) <= cast(sin.fsinies as date)\nand aut1.nmovimi <=mov.nmovimi\n) aut1\nON aut1.sseguro = sin.sseguro\nAND aut1.nriesgo = sin.nriesgo\nAnd aut1. row_num  = 1\nleft outer join (SELECT DISTINCT CVERSION,SMODELO,CMARCA,CTIPVEH FROM  cdp_ods.sisaxis_autversiones) sisaxis_autversiones\non aut1.CVERSION = sisaxis_autversiones.CVERSION\nleft outer join (select distinct SMODELO,CMARCA,TMODELO from  cdp_ods.sisaxis_AUTMODELOS) AUTMODELOS_1\non sisaxis_autversiones.SMODELO = AUTMODELOS_1.SMODELO\nand sisaxis_autversiones.CMARCA = AUTMODELOS_1.CMARCA\nleft outer join (select distinct SMODELO,CMARCA,TMODELO from  cdp_ods.sisaxis_AUTMODELOS) AUTMODELOS_2\non sisaxis_tramitacionsini.SMODELO = AUTMODELOS_2.SMODELO\nand sisaxis_tramitacionsini.CMARCA = AUTMODELOS_2.CMARCA\nleft outer join (select distinct CTIPVEH,ttipveh from cdp_ods.sisaxis_AUTTIPVEHICULOS) AUTTIPVEHICULOS_1\non sisaxis_autversiones.CTIPVEH = AUTTIPVEHICULOS_1.CTIPVEH\nleft outer join (select distinct CTIPVEH,ttipveh from cdp_ods.sisaxis_AUTTIPVEHICULOS) AUTTIPVEHICULOS_2\non sisaxis_tramitacionsini.CTIPVEH = AUTTIPVEHICULOS_2.CTIPVEH\nLEFT OUTER JOIN cdp_ods.sisaxis_autmarcas mar_1 \nON mar_1.cmarca = sisaxis_autversiones.CMARCA\nLEFT OUTER JOIN cdp_ods.sisaxis_autmarcas mar_2 \nON mar_2.cmarca = sisaxis_tramitacionsini.CMARCA \nleft outer join\ncdp_stg_dwh.stg_tref_code_map_variant veh_make_1\non mar_1.CMARCA=veh_make_1.ref_cd and veh_make_1.src_sys_cd='axis'\nand veh_make_1.ref_type_cd='veh_make'\nleft outer join\ncdp_stg_dwh.stg_tref_code_map_variant veh_make_2\non mar_2.CMARCA=veh_make_2.ref_cd and veh_make_2.src_sys_cd='axis'\nand veh_make_2.ref_type_cd='veh_make'\nleft outer join\ncdp_stg_dwh.stg_tref_code_map_variant veh_model_1\non cast(AUTMODELOS_1.CMARCA||'|'||cast(AUTMODELOS_1.SMODELO as int) as varchar(20)) =veh_model_1.ref_cd and veh_model_1.src_sys_cd='axis'\nand veh_model_1.ref_type_cd='veh_model'\nLEFT JOIN\ncdp_stg_dwh.stg_tref_code_map_variant veh_model_2\non cast(AUTMODELOS_2.CMARCA||'|'||cast(AUTMODELOS_2.SMODELO as int) as varchar(20)) =veh_model_2.ref_cd and veh_model_2.src_sys_cd='axis'\nand veh_model_2.ref_type_cd='veh_model'\nleft outer join\ncdp_stg_dwh.stg_tref_code_map_variant veh_type_cd_1\non sisaxis_autversiones.CTIPVEH=veh_type_cd_1.ref_cd and veh_type_cd_1.src_sys_cd='axis'\nand veh_type_cd_1.ref_type_cd='veh_type'\nleft outer join\ncdp_stg_dwh.stg_tref_code_map_variant veh_type_cd_2\non sisaxis_tramitacionsini.CTIPVEH=veh_type_cd_2.ref_cd and veh_type_cd_2.src_sys_cd='axis'\nand veh_type_cd_2.ref_type_cd='veh_type'\n) SUB_1 where SUB_1.loss_item_number is not null )AXIS_SRC\nWHERE AXIS_SRC.row_cnt=1)SRC\nleft outer join\n(select 1 dummy,max(dim_loss_item_key) max_sid  from  cdp_dwh.dim_loss_item_t) LKP_MAX_KEY\non SRC.dummy=LKP_MAX_KEY.dummy) where rnk=1\nAND claim_number IS NOT NULL\nAND loss_item_number IS NOT NULL"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[1].dataAdapter.object.customQuery",
        "value": "select dim_loss_item_key,claim_num,loss_item_num,src_sys_cd from cdp_dwh.dim_loss_item_t  where src_sys_cd='axis'"
    }
]