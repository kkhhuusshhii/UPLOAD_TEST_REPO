[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "SELECT src_sys_cd\n\t,curr_cd\n\t,vltn_dtm\n\t,lcl_curr_clsng_val\n\t,curr_desc\n\t,uf_lcl_curr_clsng_val\n\t,usd_lcl_curr_clsng_val\n\t,curr_conv_frequency_cd\n\t,actv_rec_ind\n\t,max_sid\nFROM (\n\tSELECT src.src_sys_cd\n\t\t,src.curr_cd\n\t\t,src.vltn_dtm\n\t\t,cast(src.lcl_curr_clsng_val AS NUMERIC(25, 10)) lcl_curr_clsng_val\n\t\t,src.curr_desc\n\t\t,cast(src.uf_lcl_curr_clsng_val AS NUMERIC(30, 15)) uf_lcl_curr_clsng_val\n\t\t,cast(src.usd_lcl_curr_clsng_val AS NUMERIC(30, 15)) usd_lcl_curr_clsng_val\n\t\t,src.curr_conv_frequency_cd\n\t\t,'Y' AS actv_rec_ind\n\t\t,LKP_MAXSID.max_sid /*,\nROW_NUMBER()OVER(PARTITION BY src.src_sys_cd,src.curr_conv_frequency_cd,src.vltn_dtm order by src.vltn_dtm desc) rnk*/\n\tFROM (\n\t\tSELECT cast('axis' AS VARCHAR(10)) AS src_sys_cd\n\t\t\t,M.curr_cd\n\t\t\t,cast('Daily' AS VARCHAR(10)) AS curr_conv_frequency_cd\n\t\t\t,cast('RDM  money' AS VARCHAR(80)) AS curr_desc\n\t\t\t,M.vltn_dtm\n\t\t\t,M.lcl_curr_clsng_val\n\t\t\t,M.usd_lcl_curr_clsng_val\n\t\t\t,M.uf_lcl_curr_clsng_val\n\t\t\t,1 DUMMY\n\t\tFROM (\n\t\t\tSELECT CAST(S1.ITASA AS NUMERIC(25, 10)) lcl_curr_clsng_val\n\t\t\t\t,CAST(1 AS NUMERIC(30, 15)) usd_lcl_curr_clsng_val\n\t\t\t\t,CAST(CAST(S1.ITASA AS NUMERIC(30,20)) / NULLIF(S2.ITASA,0) AS NUMERIC(30,20))  uf_lcl_curr_clsng_val\n\t\t\t\t,cast(S1.FCAMBIO AS TIMESTAMP) vltn_dtm\n\t\t\t\t,cast(S1.CMONORI AS VARCHAR(10)) curr_cd\n\t\t\t\t,S1.CMONDES\n\t\t\tFROM cdp_ods.sisaxis_eco_tipocambio S1\n\t\t\tLEFT JOIN cdp_ods.sisaxis_eco_tipocambio S2 ON S1.FCAMBIO = S2.FCAMBIO\n\t\t\t\tAND S2.CMONORI = 'CLF'\n\t\t\tWHERE S1.CMONORI = 'USD'\n\t\t\t\n\t\t\tUNION\n\t\t\t\n\t\t\tSELECT CAST(S1.ITASA AS NUMERIC(25, 10)) lcl_curr_clsng_val\n\t\t\t\t,CAST(CAST(S1.ITASA AS NUMERIC(30,20)) / NULLIF(S2.ITASA,0) AS NUMERIC(30,20))  usd_lcl_curr_clsng_val\n\t\t\t\t,CAST(1 AS NUMERIC(30, 15)) uf_lcl_curr_clsng_val\n\t\t\t\t,cast(S1.FCAMBIO AS TIMESTAMP) vltn_dtm\n\t\t\t\t,cast(S1.CMONORI AS VARCHAR(10)) curr_cd\n\t\t\t\t,S1.CMONDES\n\t\t\tFROM cdp_ods.sisaxis_eco_tipocambio S1\n\t\t\tLEFT JOIN cdp_ods.sisaxis_eco_tipocambio S2 ON S1.FCAMBIO = S2.FCAMBIO\n\t\t\t\tAND S2.CMONORI = 'USD'\n\t\t\tWHERE S1.CMONORI = 'CLF'\n\t\t\t\n\t\t\tUNION\n\t\t\t\n\t\t\tSELECT CAST(1 AS NUMERIC(25, 10)) lcl_curr_clsng_val\n\t\t\t\t,CAST(/*S1.ITASA*/ 1/ NULLIF(S2.ITASA, 0) AS NUMERIC(30, 20)) usd_lcl_curr_clsng_val /**ADDED FOR CLP DID232**/\n\t\t\t\t,CAST(/*S1.ITASA*/ 1/ NULLIF(S3.ITASA, 0) AS NUMERIC(30, 20)) uf_lcl_curr_clsng_val /**ADDED FOR CLP DID232**/\n\t\t\t\t,cast(S1.FCAMBIO AS TIMESTAMP) vltn_dtm\n\t\t\t\t,cast(/*S1.CMONORI*/'CLP' AS VARCHAR(10)) curr_cd\n\t\t\t\t,S1.CMONDES\n\t\t\tFROM cdp_ods.sisaxis_eco_tipocambio S1\n\t\t\tLEFT JOIN cdp_ods.sisaxis_eco_tipocambio S2 ON S1.FCAMBIO = S2.FCAMBIO /**ADDED FOR CLP DID232**/\n\t\t\t\tAND S2.CMONORI = 'USD'\n\t\t\tLEFT JOIN cdp_ods.sisaxis_eco_tipocambio S3 ON S1.FCAMBIO = S3.FCAMBIO  /**ADDED FOR CLP DID232**/\n\t\t\t\tAND S3.CMONORI = 'CLF'\n\t\t\tWHERE S1.CMONORI IN ('USD','CLF') /**ADDED FOR CLP DID232**/\n\t\t\tGROUP BY lcl_curr_clsng_val,usd_lcl_curr_clsng_val,uf_lcl_curr_clsng_val,vltn_dtm,curr_cd,S1.CMONDES /**ADDED FOR CLP DID232**/\n\t\t\t\n\t\t\tUNION\n\t\t\t\n\t\t\tSELECT CAST(S1.ITASA AS NUMERIC(25, 10)) lcl_curr_clsng_val\n\t\t\t\t,CAST(CAST(S1.ITASA AS NUMERIC(30,20)) / NULLIF(S2.ITASA,0) AS NUMERIC(30,20)) usd_lcl_curr_clsng_val\n\t\t\t\t,CAST(CAST(S1.ITASA AS NUMERIC(30,20)) / NULLIF(S3.ITASA,0) AS NUMERIC(30,20)) uf_lcl_curr_clsng_val\n\t\t\t\t,cast(S1.FCAMBIO AS TIMESTAMP) vltn_dtm\n\t\t\t\t,cast(S1.CMONORI AS VARCHAR(10)) curr_cd\n\t\t\t\t,S1.CMONDES\n\t\t\tFROM cdp_ods.sisaxis_eco_tipocambio S1\n\t\t\tLEFT JOIN cdp_ods.sisaxis_eco_tipocambio S2 ON S1.FCAMBIO = S2.FCAMBIO\n\t\t\t\tAND S2.CMONORI = 'USD'\n\t\t\tLEFT JOIN cdp_ods.sisaxis_eco_tipocambio S3 ON S1.FCAMBIO = S3.FCAMBIO\n\t\t\t\tAND S3.CMONORI = 'CLF'\n\t\t\tWHERE S1.CMONORI NOT IN (\n\t\t\t\t\t'CLP'\n\t\t\t\t\t,'USD'\n\t\t\t\t\t,'CLF'\n\t\t\t\t\t)\n\t\t\t) M\n\t\tWHERE M.CMONDES = 'CLP'\n\t\t\n\t\tUNION\n\t\t\n\t\tSELECT B.src_sys_cd\n\t\t\t,B.curr_cd\n\t\t\t,B.curr_conv_frequency_cd\n\t\t\t,B.curr_desc\n\t\t\t,B.vltn_dtm\n\t\t\t,B.lcl_curr_clsng_val\n\t\t\t,B.usd_lcl_curr_clsng_val\n\t\t\t,B.uf_lcl_curr_clsng_val\n\t\t\t,B.DUMMY\n\t\tFROM (\n\t\t\tSELECT A.src_sys_cd\n\t\t\t\t,A.curr_cd\n\t\t\t\t,A.curr_conv_frequency_cd\n\t\t\t\t,A.curr_desc\n\t\t\t\t,A.vltn_dtm\n\t\t\t\t,A.lcl_curr_clsng_val\n\t\t\t\t,A.usd_lcl_curr_clsng_val\n\t\t\t\t,A.uf_lcl_curr_clsng_val\n\t\t\t\t,A.DUMMY\n\t\t\t\t,ROW_NUMBER() OVER (\n\t\t\t\t\tPARTITION BY A.src_sys_cd\n\t\t\t\t\t,A.vltn_dtm\n\t\t\t\t\t,A.curr_conv_frequency_cd\n\t\t\t\t\t,A.curr_cd ORDER BY A.vltn_dtm DESC\n\t\t\t\t\t) RNK\n\t\t\tFROM (\n\t\t\t\tSELECT cast('axis' AS VARCHAR(10)) AS src_sys_cd\n\t\t\t\t\t,cast(S1.CIVA_CD_MONORI AS VARCHAR(10)) curr_cd\n\t\t\t\t\t,cast('Monthly' AS VARCHAR(10)) AS curr_conv_frequency_cd\n\t\t\t\t\t,cast('RDM  money' AS VARCHAR(80)) AS curr_desc\n\t\t\t\t\t,cast(S1.CIVA_FE_CIERRE AS TIMESTAMP) vltn_dtm\n\t\t\t\t\t,CAST(S1.CIVA_MT_CAMBIO AS NUMERIC(25, 10)) lcl_curr_clsng_val\n\t\t\t\t\t,CAST(1 AS NUMERIC(30, 15)) usd_lcl_curr_clsng_val\n\t\t\t\t\t,CAST(CAST(S1.CIVA_MT_CAMBIO AS NUMERIC(30,20)) / NULLIF(S2.CIVA_MT_CAMBIO, 0) AS NUMERIC(30,20)) uf_lcl_curr_clsng_val\n\t\t\t\t\t,1 DUMMY\n\t\t\t\tFROM cdp_ods.siscierres_ciet_valorescierre S1\n\t\t\t\tINNER JOIN cdp_ods.sisaxis_cierres b ON S1.CIVA_FE_CIERRE = b.FCIERRE\n\t\t\t\t\tAND b.CESTADO = 1\n\t\t\t\t\tAND b.CTIPO = 7\n\t\t\t\t\tAND S1.CIVA_CD_PROCESO = 1\n\t\t\t\tLEFT JOIN cdp_ods.siscierres_ciet_valorescierre S2 ON S1.CIVA_FE_CIERRE = S2.CIVA_FE_CIERRE\n\t\t\t\t\tAND S2.CIVA_CD_MONORI = 'CLF'\n\t\t\t\t\tAND S2.CIVA_CD_PROCESO = 1\n\t\t\t\tWHERE S1.CIVA_CD_MONORI = 'USD'\n\t\t\t\t\n\t\t\t\tUNION\n\t\t\t\t\n\t\t\t\tSELECT cast('axis' AS VARCHAR(10)) AS src_sys_cd\n\t\t\t\t\t,cast(S1.CIVA_CD_MONORI AS VARCHAR(10)) curr_cd\n\t\t\t\t\t,cast('Monthly' AS VARCHAR(10)) AS curr_conv_frequency_cd\n\t\t\t\t\t,cast('RDM  money' AS VARCHAR(80)) AS curr_desc\n\t\t\t\t\t,cast(S1.CIVA_FE_CIERRE AS TIMESTAMP) vltn_dtm\n\t\t\t\t\t,CAST(S1.CIVA_MT_CAMBIO AS NUMERIC(25, 10)) lcl_curr_clsng_val\n\t\t\t\t\t,CAST(CAST(S1.CIVA_MT_CAMBIO AS NUMERIC(30,20)) / NULLIF(S2.CIVA_MT_CAMBIO, 0) AS NUMERIC(30,20))  usd_lcl_curr_clsng_val\n\t\t\t\t\t,CAST(1 AS NUMERIC(30, 15)) uf_lcl_curr_clsng_val\n\t\t\t\t\t,1 DUMMY\n\t\t\t\tFROM cdp_ods.siscierres_ciet_valorescierre S1\n\t\t\t\tINNER JOIN cdp_ods.sisaxis_cierres b ON S1.CIVA_FE_CIERRE = b.FCIERRE\n\t\t\t\t\tAND b.CESTADO = 1\n\t\t\t\t\tAND b.CTIPO = 7\n\t\t\t\t\tAND S1.CIVA_CD_PROCESO = 1\n\t\t\t\tLEFT JOIN cdp_ods.siscierres_ciet_valorescierre S2 ON S1.CIVA_FE_CIERRE = S2.CIVA_FE_CIERRE\n\t\t\t\t\tAND S2.CIVA_CD_MONORI = 'USD'\n\t\t\t\t\tAND S2.CIVA_CD_PROCESO = 1\n\t\t\t\tWHERE S1.CIVA_CD_MONORI = 'CLF'\n\t\t\t\t\n\t\t\t\tUNION\n\t\t\t\t\n\t\t\t\tSELECT cast('axis' AS VARCHAR(10)) AS src_sys_cd\n\t\t\t\t\t,cast('CLP' AS VARCHAR(10)) curr_cd\n\t\t\t\t\t,cast('Monthly' AS VARCHAR(10)) AS curr_conv_frequency_cd\n\t\t\t\t\t,cast('RDM  money' AS VARCHAR(80)) AS curr_desc\n\t\t\t\t\t,cast(S1.CIVA_FE_CIERRE AS TIMESTAMP) vltn_dtm\n\t\t\t\t\t,CAST(1 AS NUMERIC(25, 10)) lcl_curr_clsng_val\n\t\t\t\t\t,CAST(/*S1.CIVA_MT_CAMBIO*/1 / NULLIF(S2.CIVA_MT_CAMBIO, 0) AS NUMERIC(30,20)) usd_lcl_curr_clsng_val  /**ADDED FOR CLP DID232**/\n\t\t\t\t\t,CAST(/*S1.CIVA_MT_CAMBIO*/1 / NULLIF(S3.CIVA_MT_CAMBIO, 0) AS NUMERIC(30,20)) uf_lcl_curr_clsng_val /**ADDED FOR CLP DID232**/\n\t\t\t\t\t,1 DUMMY\n\t\t\t\tFROM cdp_ods.siscierres_ciet_valorescierre S1\n\t\t\t\tINNER JOIN cdp_ods.sisaxis_cierres b ON S1.CIVA_FE_CIERRE = b.FCIERRE\n\t\t\t\t\tAND b.CESTADO = 1\n\t\t\t\t\tAND b.CTIPO = 7\n\t\t\t\t\tAND S1.CIVA_CD_PROCESO = 1\n\t\t\t\tLEFT JOIN cdp_ods.siscierres_ciet_valorescierre S2 ON S1.CIVA_FE_CIERRE = S2.CIVA_FE_CIERRE\n\t\t\t\t\tAND S2.CIVA_CD_MONORI = 'USD'\n\t\t\t\t\tAND S2.CIVA_CD_PROCESO = 1\n\t\t\t\tLEFT JOIN cdp_ods.siscierres_ciet_valorescierre S3 ON S1.CIVA_FE_CIERRE = S3.CIVA_FE_CIERRE\n\t\t\t\t\tAND S3.CIVA_CD_MONORI = 'CLF'\n\t\t\t\t\tAND S3.CIVA_CD_PROCESO = 1\n\t\t\t\tWHERE S1.CIVA_CD_MONORI IN ('USD','CLF') AND S1.CIVA_CD_PROCESO = 1 /**ADDED FOR CLP DID232**/\n\t\t\t\tGROUP BY src_sys_cd,curr_cd,curr_conv_frequency_cd,curr_desc,vltn_dtm,lcl_curr_clsng_val,usd_lcl_curr_clsng_val,uf_lcl_curr_clsng_val,DUMMY /**ADDED FOR CLP DID232**/\n\t\t\t\t\n\t\t\t\tUNION\n\t\t\t\t\n\t\t\t\tSELECT cast('axis' AS VARCHAR(10)) AS src_sys_cd\n\t\t\t\t\t,cast(S1.CIVA_CD_MONORI AS VARCHAR(10)) curr_cd\n\t\t\t\t\t,cast('Monthly' AS VARCHAR(10)) AS curr_conv_frequency_cd\n\t\t\t\t\t,cast('RDM  money' AS VARCHAR(80)) AS curr_desc\n\t\t\t\t\t,cast(S1.CIVA_FE_CIERRE AS TIMESTAMP) vltn_dtm\n\t\t\t\t\t,CAST(S1.CIVA_MT_CAMBIO AS NUMERIC(25, 10)) lcl_curr_clsng_val\n\t\t\t\t\t,CAST(CAST(S1.CIVA_MT_CAMBIO AS NUMERIC(30,20)) / NULLIF(S2.CIVA_MT_CAMBIO, 0) AS NUMERIC(30,20))  usd_lcl_curr_clsng_val\n\t\t\t\t\t,CAST(CAST(S1.CIVA_MT_CAMBIO AS NUMERIC(30,20)) / NULLIF(S3.CIVA_MT_CAMBIO, 0) AS NUMERIC(30,20))  uf_lcl_curr_clsng_val\n\t\t\t\t\t,1 DUMMY\n\t\t\t\tFROM cdp_ods.siscierres_ciet_valorescierre S1\n\t\t\t\tINNER JOIN cdp_ods.sisaxis_cierres b ON S1.CIVA_FE_CIERRE = b.FCIERRE\n\t\t\t\t\tAND b.CESTADO = 1\n\t\t\t\t\tAND b.CTIPO = 7\n\t\t\t\t\tAND S1.CIVA_CD_PROCESO = 1\n\t\t\t\tLEFT JOIN cdp_ods.siscierres_ciet_valorescierre S2 ON S1.CIVA_FE_CIERRE = S2.CIVA_FE_CIERRE\n\t\t\t\t\tAND S2.CIVA_CD_MONORI = 'USD'\n\t\t\t\t\tAND S2.CIVA_CD_PROCESO = 1\n\t\t\t\tLEFT JOIN cdp_ods.siscierres_ciet_valorescierre S3 ON S1.CIVA_FE_CIERRE = S3.CIVA_FE_CIERRE\n\t\t\t\t\tAND S3.CIVA_CD_MONORI = 'CLF'\n\t\t\t\t\tAND S3.CIVA_CD_PROCESO = 1\n\t\t\t\tWHERE S1.CIVA_CD_MONORI NOT IN (\n\t\t\t\t\t\t'CLP'\n\t\t\t\t\t\t,'USD'\n\t\t\t\t\t\t,'CLF'\n\t\t\t\t\t\t)\n\t\t\t\t) A\n\t\t\t) B\n\t\tWHERE B.RNK = 1\n\t\t) src\n\tLEFT OUTER JOIN (\n\t\tSELECT 1 AS DUMMY\n\t\t\t,max(curr_conv_key) AS MAX_SID\n\t\tFROM cdp_dwh.curr_conv_t\n\t\t) LKP_MAXSID ON src.DUMMY = LKP_MAXSID.DUMMY\n\t)"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[1].dataAdapter.object.customQuery",
        "value": "SELECT curr_conv_key, src_sys_cd,vltn_dtm,curr_conv_frequency_cd,curr_cd \nFROM cdp_dwh.curr_conv_t \nwhere src_sys_cd='axis';"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "delete from cdp_dwh.curr_conv_t where src_sys_cd='axis'"
    }
]