[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "SELECT SSEGURO\n\t,POLIZA\n\t,ITEM\n\t,CRAMO\n\t,ID_SUCURSAL\n\t,INI_VIG\n\t,FANULAC\n\t,FCARPRO\n\t,FVENCIM\n\t,FIN_VIG_ORIG\n\t,FIN_VIG_ACT\n\t,DIAS_VIGENTE\n\t,DIAS_SUSCRITOS\n\t,ASEGURADO_RUT\n\t,VEH_CMARCA\n\t,VEH_CMODELO\n\t,VEH_CLASE\n\t,USO\n\t,VEH_ANO\n\t,PATENTE\n\t,VEH_CTIPO\n\t,VEH_TIPO\n\t,TMARCA\n\t,TMODELO\n\t,NUM_MOTOR\n\t,CORREDOR_RUT\n\t,CORREDOR\n\t,COD_PRODUCTO\n\t,PRODUCTO\n\t,COD_PLAN\n\t,PLAN\n\t,DEDUCIBLE\n\t,NUM_ENDOSO\n\t,CONTRATANTE_RUT\n\t,CONTRATANTE_NOMBRE\n\t,cast(FLOTA as integer) as flota\n\t,NRO_MASIVO\n\t,PRIMA\n\t,PRIMA_TARIFA\n\t,DESCUENTO\n\t,COMISION\n\t,COD_ENDOSO\n\t,TDESCRIP\n\t,ENDOSO_AGRUP\n\t,COB_PLAN\n\t,ORIGEN\n\t,LKP_MAX_KEY.max_sid\n\t,csituac\n\t,cactivi\n\t,cagrseg\n\t,cagente\n\t,cflota\n\t,sperson -- for joining base_final_liberty with other columns for fleet\nFROM (\n\tSELECT T1.SSEGURO\n\t\t,POLIZA\n\t\t,ITEM\n\t\t,T1.CRAMO\n\t\t,T1.ID_SUCURSAL\n\t\t,INI_VIG\n\t\t,T1.FANULAC\n\t\t,T1.FCARPRO\n\t\t,T1.FVENCIM\n\t\t,FIN_VIG_ORIG\n\t\t,FIN_VIG_ACT\n\t\t,DIAS_VIGENTE\n\t\t,DIAS_SUSCRITOS\n\t\t,ASEGURADO_RUT\n\t\t,VEH_CMARCA\n\t\t,VEH_CMODELO\n\t\t,VEH_CLASE\n\t\t,USO\n\t\t,VEH_ANO\n\t\t,PATENTE\n\t\t,VEH_CTIPO\n\t\t,VEH_TIPO\n\t\t,TMARCA\n\t\t,TMODELO\n\t\t,NUM_MOTOR\n\t\t,CORREDOR_RUT\n\t\t,CORREDOR\n\t\t,T6.COD_PRODUCTO\n\t\t,PRODUCTO\n\t\t,COD_PLAN\n\t\t,PLAN\n\t\t,DEDUCIBLE\n\t\t,NUM_ENDOSO\n\t\t,T8.CONTRATANTE_RUT\n\t\t,CONTRATANTE_NOMBRE\n\t\t,CASE \n\t\t\tWHEN T1.FVENCIM >= '2019-01-01'\n\t\t\t\tTHEN T1.CFLOTA\n\t\t\tELSE (\n\t\t\t\t\tCASE \n\t\t\t\t\t\tWHEN (\n\t\t\t\t\t\t\t\t(T1.CFLOTA = 1)\n\t\t\t\t\t\t\t\tOR (\n\t\t\t\t\t\t\t\t\tT6.COD_PRODUCTO IN (\n\t\t\t\t\t\t\t\t\t\tSELECT DISTINCT prod_flotas_lib\n\t\t\t\t\t\t\t\t\t\tFROM cdp_stg_dwh.renewals_param_axis\n\t\t\t\t\t\t\t\t\t\tWHERE prod_flotas_lib IS NOT NULL\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tOR (\n\t\t\t\t\t\t\t\t\tT8.CONTRATANTE_RUT IN (\n\t\t\t\t\t\t\t\t\t\tSELECT DISTINCT contr_flotas_lib\n\t\t\t\t\t\t\t\t\t\tFROM cdp_stg_dwh.renewals_param_axis\n\t\t\t\t\t\t\t\t\t\tWHERE contr_flotas_lib IS NOT NULL\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\tTHEN 1\n\t\t\t\t\t\tELSE 0 END) END AS FLOTA\n\t\t\t\t\t,NRO_MASIVO\n\t\t\t\t\t,PRIMA\n\t\t\t\t\t,PRIMA_TARIFA\n\t\t\t\t\t,DESCUENTO\n\t\t\t\t\t,COMISION\n\t\t\t\t\t,COD_ENDOSO\n\t\t\t\t\t,TDESCRIP\n\t\t\t\t\t,ENDOSO_AGRUP\n\t\t\t\t\t,COB_PLAN\n\t\t\t\t\t,'axis' AS ORIGEN\n\t\t\t\t\t,T1.csituac\n\t\t\t\t\t,-- will help in Estado_Actual\n\t\t\t\t\tT1.cactivi\n\t\t\t\t\t,-- will help in Actividad join\n\t\t\t\t\tT1.cagrseg\n\t\t\t\t\t,-- will help in Num_Convenio / Numero Convenio\n\t\t\t\t\tT1.cflota\n\t\t\t\t\t,-- will help in case cflota logic\n\t\t\t\t\tT5.cagente\n\t\t\t\t\t,T3.SPERSON FROM CDP_STG_DWH.BASE_LIB T1 -- 3063100 has more data since refreshed\n\t\t\t\t\t\t--FROM cdp_stg_dwh.BASE_LIB T1 -- commented for fleet logic 2598979\n\t\t\t\t\t\t--LEFT JOIN FECHAS_LIB T2\n\t\t\t\t\t\t--ON T1.SSEGURO = T2.SSEGURO\n\t\t\t\t\tLEFT JOIN cdp_stg_dwh.ASEGURADOS_LIB T3 ON T1.SSEGURO = T3.SSEGURO\n\t\t\t\t\tLEFT JOIN cdp_stg_dwh.VEHICULOS_LIB T4 ON T1.SSEGURO = T4.SSEGURO\n\t\t\t\t\tLEFT JOIN cdp_stg_dwh.CORREDORES_LIB T5 ON T1.SSEGURO = T5.SSEGURO\n\t\t\t\t\tLEFT JOIN cdp_stg_dwh.PRODUCTOS_LIB T6 ON T1.SSEGURO = T6.SSEGURO\n\t\t\t\t\tLEFT JOIN cdp_stg_dwh.DEDUCIBLES_LIB T7 ON T1.SSEGURO = T7.SSEGURO\n\t\t\t\t\tLEFT JOIN cdp_stg_dwh.CONTRATANTES_LIB T8 ON T1.SSEGURO = T8.SSEGURO\n\t\t\t\t\tLEFT JOIN cdp_ods.sisaxis_seguros T9 ON T1.SSEGURO = T9.SSEGURO\n\t\t\t\t\t--LEFT JOIN NRO_MASIVOS_LIB T10\n\t\t\t\t\t--ON T1.SSEGURO = T10.SSEGURO\n\t\t\t\t\tLEFT JOIN cdp_stg_dwh.PRIMAS_LIB T11 ON T1.SSEGURO = T11.SSEGURO\n\t\t\t\t\tLEFT JOIN cdp_stg_dwh.ENDOSOS_LIB T12 ON T1.SSEGURO = T12.SSEGURO\n\t\t\t\t\tLEFT JOIN cdp_stg_dwh.COBERTURAS_LIB T13 ON T1.SSEGURO = T13.SSEGURO\n\t\t\t\t\t) \n\t\t\t\t\tsrc LEFT OUTER JOIN (\n\t\t\t\tSELECT 1 DUMMY\n\t\t\t\t\t,max(base_final_fleet_liberty_key) max_sid\n\t\t\t\tFROM cdp_dwh.BASE_FINAL_LIBERTY\n\t\t\t\t) LKP_MAX_KEY ON LKP_MAX_KEY.DUMMY = 1 \n\t\t\t\tWHERE SSEGURO IS NOT NULL ;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_dwh.BASE_FINAL_LIBERTY;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[2].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_dwh.BASE_FINAL_LIBERTY;\ncommit;\n"
    }
]