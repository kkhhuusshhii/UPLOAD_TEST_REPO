[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select * from (\nselect \nsmq.cotizacion_correlativo,\nsmq.corredor_rut,\nsmq.anyo_cot,\nsmq.mes_cot,\nsmq.dia_cot,\nsmq.asegurado_rut,\nsmq.vehiculo_ano,\nsmq.vehiculo_cod_marca,\nsmq.vehiculo_cod_modelo,\nsmq.sseguro,\nsmq.npoliza,\nsmq.ncertif,\nsmq.npropm,\nsmq.sproduc,\nsmq.iprianuseg,\nsmq.ipritar,\nsmq.pdtocom,\nsmq.ifranquseg,\nsmq.femisio,\nsmq.fefecto,\nsmq.fin_vig,\nsmq.fvencim,\nsmq.cactivi,\nsmq.fanulac,\nsmq.ttitulo,\nsmq.cagente,\nsmq.id_sucursal,\nsmq.nombre_sucursal,\nsmq.tbuscar,\nsmq.sperson,\nsmq.csituac,\nsmq.anyo_pol,\nsmq.mes_pol,\nsmq.dia_pol,\nsmq.anyo_mes,\nsmq.comuna,\nsmq.fecha_nacimiento,\nsmq.sexo,\nsmq.stamp,\nsmq.cant_sin,\nsmq.mont_sin,\nsmq.veh_tasacion,\nsmq.veh_marca,\nsmq.veh_modelo,\nsmq.marca_modelo,\nsmq.flag_robot,\nsmq.emision,\nisnull(omq.max_anyo_cot,1111,omq.max_anyo_cot) as max_anyo_cot, \nisnull(omq.max_mes_cot,0,omq.max_mes_cot) as max_mes_cot\nfrom \n(SELECT\ncotizacion_correlativo,\ncorredor_rut,\nanyo_cot,\nmes_cot,\ndia_cot,\nasegurado_rut,\nvehiculo_ano,\nvehiculo_cod_marca,\nvehiculo_cod_modelo,\nsseguro,\nnpoliza,\nncertif,\nnpropm,\nsproduc,\ncase when (iprianuseg is null or iprianuseg ='') then 0::Numeric(25,10) \nelse replace(iprianuseg,',','.')::Numeric(25,10) end as iprianuseg,\ncase when (ipritar is null or ipritar ='') then 0::Numeric(25,10) \nelse replace(ipritar,',','.')::Numeric(25,10) end as ipritar,\npdtocom,\nifranquseg,\ncase when femisio='' then null else TO_TIMESTAMP(femisio, 'DD-MM-YYYY HH24:MI') at time zone 'UTC' end as femisio,\ncase when fefecto='' then null else TO_TIMESTAMP(fefecto, 'DD-MM-YYYY HH24:MI') at time zone 'UTC' end as fefecto,\ncase when fin_vig='' then null else TO_TIMESTAMP(fin_vig, 'DD-MM-YYYY HH24:MI') at time zone 'UTC' end as fin_vig,\ncase when fvencim='' then null else TO_TIMESTAMP(fvencim, 'DD-MM-YYYY HH24:MI') at time zone 'UTC' end as fvencim,\ncactivi,\ncase when fanulac='' then null else TO_TIMESTAMP(fanulac, 'DD-MM-YYYY HH24:MI') at time zone 'UTC' end as fanulac,\nttitulo,\ncagente,\nid_sucursal,\nnombre_sucursal,\ntbuscar,\nsperson,\ncsituac,\nanyo_pol,\nmes_pol,\ndia_pol,\nanyo_mes,\ncomuna,\nfecha_nacimiento,\nsexo,\ncase when stamp='' then null else TO_TIMESTAMP(stamp, 'DD-MM-YYYY HH24:MI') at time zone 'UTC' end as stamp,\ncant_sin,\nmont_sin,\nveh_tasacion,\nveh_marca,\nveh_modelo,\nmarca_modelo,\nflag_robot,\nemision\nFROM cdp_stg_dwh.massivequote) smq\nleft join (select cotizacion_correlativo,corredor_rut, \nisnull(max(anyo_cot),1111,max(anyo_cot)) as max_anyo_cot, \nisnull(max(mes_cot),0,max(mes_cot)) as max_mes_cot\nfrom cdp_ods.massivequote group by cotizacion_correlativo,corredor_rut) omq\non smq.cotizacion_correlativo=omq.cotizacion_correlativo and smq.corredor_rut=omq.corredor_rut\n)\nwhere to_char(to_date(anyo_cot||mes_cot,'YYYYMM'),'YYYYMM') > to_char(to_date(max_anyo_cot||max_mes_cot,'YYYYMM'),'YYYYMM')"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[3].dataAdapter.object.customQuery",
        "value": "select \ncotizacion_correlativo,\ncorredor_rut,\nanyo_cot,\nmes_cot\nfrom cdp_ods.massivequote--"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.massivequote;\ncopy cdp_stg_dwh.massivequote\nfrom 's3://$$S3_Bucket_Name/CDP/AWS/MassQuotation/MassiveQuote.csv' \niam_role '$$AWS_IAM_ROLE' \nDELIMITER as '|' IGNOREHEADER 1 REMOVEQUOTES ESCAPE NULL AS '\\0'"
    }
]