[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select\nclaim_num,\nclaimant_num,\nloss_item_num,\norder_num,\nadj_num,\nappraiser_estimated_amt,\ncoverage_type_cd,\ndim_cov_key,\ndim_bdshp_key,\ndim_claim_type_key,\ndim_claim_key,\ndim_Spare_Parts_Analyst_key,\ndim_claimant_key,\ndim_claim_adjuster_key,\ndim_loss_item_key,\ndim_parts_provdr_key,\nestimated_order_completion_dt,\norder_awarded_count,\norder_close_dt,\norder_creation_dt,\norder_issue_dt,\norder_paid_dt,\norder_status_cd,\norder_type_cd,\nquot_dt,\ntotal_order_cost_amt,\ntotal_accessory_cost_amt,\ntotal_adjustment_amt,\ntotal_discount_amt,\ntotal_labor_cost_amt,\ntotal_spare_parts_amount,\nfirst_adj_dt, --Added for DID-158\nadj_dt, --Added for DID-158\nclaim_closed_dt,\ntotal_parts_qty,\ntotal_tax_amt,\nvehicle_discharged_dt,\nvehicle_received_dt,\ntotal_awarded_adj_count,--new\ndim_branch_office_key,---new\norder_paid_ind,--new\norder_cost_curr_cd,---new\nadjuster_assign_dt,---new\norder_type_desc,---new\norder_status_desc,---new\ntotal_adj_count,---new\norder_count,---new\nsrc_sys_cd,\nactv_rec_ind,\nMAX_SID\nfrom\n(\nselect\nnvl(src.claim_num,'0') as claim_num ,\nnvl(src.claimant_num,0)  claimant_num,\nnvl(src.loss_item_num,0) as loss_item_num,\nnvl(src.order_num,'0') as order_num,\nsrc.adj_num,\nsrc.appraiser_estimated_amt,\ncoverage_type_cd,\n--nvl(src.dim_cov_key,0) dim_cov_key, commented as part of DID-181\nnvl((select  dim_cov_key from cdp_dwh.dim_cov_type_t where src_sys_cd='axis' and cov_cd = coverage_type_cd),0) dim_cov_key, --DID-181\nnvl(src.dim_bdshp_key,0) dim_bdshp_key,\nnvl(src.dim_claim_type_key,0) dim_claim_type_key,\nnvl(src.dim_claim_key,0) dim_claim_key,\nnvl(src.dim_Spare_Parts_Analyst_key,0) dim_Spare_Parts_Analyst_key,\nnvl(src.dim_claimant_key,0) dim_claimant_key,\nnvl(src.dim_claim_adjuster_key,0) dim_claim_adjuster_key,\nnvl(src.dim_loss_item_key,0) dim_loss_item_key,\nnvl(src.dim_parts_provdr_key,0) dim_parts_provdr_key,\nsrc.estimated_order_completion_dt,\nsrc.order_awarded_count,---new renamed one\nsrc.order_close_dt,\nsrc.order_creation_dt,\nsrc.order_issue_dt,\nsrc.order_paid_dt,\nsrc.order_status_cd,\nsrc.order_type_cd,\nsrc.quot_dt,\nsrc.total_order_cost_amt,\nsrc.total_accessory_cost_amt,\nsrc.total_adjustment_amt,\nsrc.total_discount_amt,\nsrc.total_labor_cost_amt,\nsrc.total_spare_parts_amount,\nsrc.first_adj_dt, --Added for DID-158\nsrc.adj_dt, --Added for DID-158\nsrc.claim_closed_dt,\nsrc.total_parts_qty,\nsrc.total_tax_amt,\nsrc.vehicle_discharged_dt,\nsrc.vehicle_received_dt,\nsrc.total_awarded_adj_count,--new\nnvl(src.dim_branch_office_key,0) as dim_branch_office_key, ---new\nsrc.order_paid_ind,--new\nsrc.order_cost_curr_cd,---new\nsrc.liquidator_assignment_dt adjuster_assign_dt,---new\nsrc.order_type_desc,\nsrc.order_status_desc,\nsrc.total_adj_count,\nsrc.order_count,\nsrc.src_sys_cd,\n'Y' as actv_rec_ind,\nLKP_MAXSID.MAX_SID,\nrow_number() over (partition by src.claim_num,src.claimant_num,src.loss_item_num,src.order_num,src.adj_num order by src.rec_crt_dtm desc) as row_cnt\nfrom\n(select distinct cast('axis' as varchar(10)) src_sys_cd,\ncast(sars.AUOR_SISI_NU_SINIESTRO as varchar(35)) as claim_num,\ncast(sars.AUOR_NU_IMPLICADO as smallint) as claimant_num,\ncast(sars.AUOR_NU_IMPLICADO as smallint) as loss_item_num,\ncast (cast(sars.AUOR_NU_ORDEN_REPARACION as integer) as varchar(35)) as order_num,\ncast (sars.AUOR_NU_ORDEN_REPARACION as integer) as order_id, \ncast (cast(sars.AUOR_AUAD_NU_AJUSTE as integer) as varchar(35)) as adj_num,\n--cast(appraisal_est_dt.appraisal_estimate_dt as date) appraisal_estimate_dt,\ncast(appraisal_est_dt.appraisal_estimate_dt as date) first_adj_dt, --Added for DID-158\ncast(adjustment_dt.adj_dt as date) adj_dt, --Added for DID-158\ncast(appraiser_est_amt.appraiser_estimated_amt as numeric(25,10)) appraiser_estimated_amt,\ncast(ssgr.FENTREGA_REAL_VEH as date) client_inspection_approval_dt,\ncast(NVL(cast(stcmv.mkt_ref_code as integer),cast(sars.CGARANT as integer)) as varchar(10)) coverage_type_cd,\n--cast(NVL(stcmv.mkt_ref_code,cast(sars.CGARANT as varchar(20))) as varchar(10)) coverage_type_cd,\n--cast(clm.dim_cov_key as integer) dim_cov_key, --DID181\ncast(z.dim_bdshp_key as integer) dim_bdshp_key,\ncast(AA.dim_claim_type_key as integer) dim_claim_type_key,\ncast(dim_claim.dim_claim_key as integer) dim_claim_key,\ncast(w.dim_claim_analyst_key as integer) dim_Spare_Parts_Analyst_key,\ncast(cl.dim_claimant_key as integer)  dim_claimant_key,\ncast(u.dim_claim_adjuster_key as integer)  dim_claim_adjuster_key,\ncast(ls.dim_loss_item_key as integer) dim_loss_item_key,\ncast(t.dim_parts_provdr_key as integer) dim_parts_provdr_key,\ncast(ssg.FENTREGA_PROB_VEH as date) estimated_order_completion_dt,\ncast(s.FINIVIG as date) liquidator_assignment_dt,\ncast(q.FECHA_AUTORIZA as date) order_approval_dt,\ncast(1 as integer) order_awarded_count,\ncast(sars.AUOR_FE_STATUS as date) order_close_dt,\ncast(sars.AUOR_FE_REGISTRO as date) order_creation_dt,\ncast(sars.AUOR_FE_IMPRESION as date) order_issue_dt,\ncast(pa.FORDPAG as date) order_paid_dt,\ncast(cast(sars.AUOR_ST_ORDEN as integer) as varchar(10)) order_status_cd,\ncast(sars.AUOR_TP_ORDEN as varchar(10)) order_type_cd,\ncast(quot_date.quot_dt as date) quot_dt,\ncast(null as date) repair_completion_dt,\ncast(ad3.total_accessory_cost_amt as numeric(25,10)) total_accessory_cost_amt,\ncast(ad4.total_mecanica as numeric(25,10)) total_adjustment_amt,\ncast(ad5.AUDO_AUDO_MT_DESCUENTO as numeric(25,10)) total_discount_amt,\ncast(ad6.total_labor_cost_amt as numeric(25,10)) total_labor_cost_amt,\ncast(ad8.total_repuestos as numeric(25,10)) total_spare_parts_amount,\ncast(CCD.claim_closed_dt as date) claim_closed_dt,\ncast(null as integer) total_labor_hours_qty,\ncast(sars.AUOR_MT_TOTAL_ORDEN as numeric(25,10))total_order_cost_amt,\ncast(ad9.total_parts_qty as integer) total_parts_qty,\ncast(round(((nvl(ad6.total_labor_cost_amt,0)+nvl(ad4.total_mecanica,0)+nvl(ad8.total_repuestos,0)+nvl(ad3.total_accessory_cost_amt,0)-nvl(ad5.AUDO_AUDO_MT_DESCUENTO,0))*0.19),0) as numeric(25,10))total_tax_amt,\ncast(ssgr.FENTREGA_REAL_VEH as date) vehicle_discharged_dt,\ncast(ssgr.FINGRESO_REAL_VEH as date) vehicle_received_dt,\ncast((case when sars.AUOR_NU_ORDEN_REPARACION is null then 0 else 1 end) as smallint) total_awarded_adj_count, --new\ncast(branch_key.dim_branch_office_key as integer) dim_branch_office_key,----new\ncast((case when (AUOR_SIDEPAG is null or AUOR_SIDEPAG = 0) then 'N' else 'S' end) as char(10)) order_paid_ind,---new\ncast('CLP' as varchar(10)) order_cost_curr_cd,--new----fields name confirmation needed\ncast(nvl(ad12.mkt_ref_code_desc,ad12.ref_desc) as varchar(80)) order_type_desc,--new\ncast(nvl(ad13.mkt_ref_code_desc,ad13.ref_desc) as varchar(80)) order_status_desc,--new\ncast(1 as smallint) total_adj_count, \ncast(null as integer) order_count,\nsars.rec_crt_dtm,\n1 dummy\nfrom cdp_stg_dwh.SISSINIESTRO_AUTT_ORDENES_REPARACION sars\nleft outer join\n(Select  to_date(to_char(a.AUAJ_FE_AJUSTE ,'dd/mm/yyyy'),'dd/mm/yyyy') appraisal_estimate_dt,o.AUOR_SISI_NU_SINIESTRO,\no.AUOR_NU_IMPLICADO,o.AUOR_NU_ORDEN_REPARACION,o.AUOR_AUAD_NU_AJUSTE\n\t from cdp_ods.SISSINIESTRO_autt_ajuste_danos a, cdp_stg_dwh.SISSINIESTRO_autt_ordenes_reparacion o \n\t Where  a.AUAJ_SISI_NU_SINIESTRO = o. AUOR_SISI_NU_SINIESTRO\n\t   and    a.AUAJ_NU_IMPLICADO =  o. AUOR_NU_IMPLICADO\n\t   and    a.AUAJ_NU_AJUSTE = (Select min(b.auaj_nu_ajuste) \n\t\t\t\t\t\t\t  from cdp_ods.SISSINIESTRO_autt_ajuste_danos b\n\t\t\t\t\t\t\t where o. AUOR_SISI_NU_SINIESTRO = b.AUAJ_SISI_NU_SINIESTRO\n\t\t\t\t\t\t\t   and o. AUOR_NU_IMPLICADO  = b.AUAJ_NU_IMPLICADO )) appraisal_est_dt\n\t\t\t\t\t\t\t   on sars.AUOR_SISI_NU_SINIESTRO=appraisal_est_dt.AUOR_SISI_NU_SINIESTRO\n\t\t\t\t\t\t\t   and sars.AUOR_NU_IMPLICADO=appraisal_est_dt.AUOR_NU_IMPLICADO\n\t\t\t\t\t\t\t   and sars.AUOR_NU_ORDEN_REPARACION=appraisal_est_dt.AUOR_NU_ORDEN_REPARACION\n\t\t\t   and sars.AUOR_AUAD_NU_AJUSTE=appraisal_est_dt.AUOR_AUAD_NU_AJUSTE\n\nLeft outer join\n(Select  to_date(to_char(a.AUAJ_FE_AJUSTE ,'dd/mm/yyyy'),'dd/mm/yyyy') as adj_dt, \n\to.AUOR_SISI_NU_SINIESTRO, o. AUOR_NU_IMPLICADO, o.AUOR_NU_ORDEN_REPARACION, o.AUOR_AUAD_NU_AJUSTE\n\t from cdp_ods.SISSINIESTRO_autt_ajuste_danos a, cdp_stg_dwh.SISSINIESTRO_autt_ordenes_reparacion o \n         Where  a.AUAJ_SISI_NU_SINIESTRO = o. AUOR_SISI_NU_SINIESTRO\n           and    a.AUAJ_NU_IMPLICADO =  o. AUOR_NU_IMPLICADO\n           and    a.AUAJ_NU_AJUSTE = o.AUOR_AUAD_NU_AJUSTE) adjustment_dt  \n--Added adjustment_dt join for DID-158\t\t\t   \non sars.AUOR_SISI_NU_SINIESTRO=adjustment_dt.AUOR_SISI_NU_SINIESTRO\nand sars.AUOR_NU_IMPLICADO=adjustment_dt.AUOR_NU_IMPLICADO\nand sars.AUOR_NU_ORDEN_REPARACION=adjustment_dt.AUOR_NU_ORDEN_REPARACION\nand sars.AUOR_AUAD_NU_AJUSTE=adjustment_dt.AUOR_AUAD_NU_AJUSTE\n\t\t   \n\t\t\t   \t\t   \nleft outer join\t\t\t   \n(select sum( nvl(d.audl_auaa_mt_total,0)) appraiser_estimated_amt,o1.AUOR_SISI_NU_SINIESTRO,o1.AUOR_NU_IMPLICADO,\n o1.AUOR_NU_ORDEN_REPARACION,o1.AUOR_AUAD_NU_AJUSTE\n from cdp_ods.SISSINIESTRO_autt_ajuste_danos a1, cdp_stg_dwh.SISSINIESTRO_autt_ordenes_reparacion o1 , cdp_ods.SISSINIESTRO_autt_detalle_ordenes d\n\t Where a1.AUAJ_SISI_NU_SINIESTRO = o1.AUOR_SISI_NU_SINIESTRO\n\t   and a1.AUAJ_NU_IMPLICADO =  o1.AUOR_NU_IMPLICADO\n\t   and o1.AUOR_SISI_NU_SINIESTRO =  d.AUDL_AUOR_NU_SINIESTRO  \n\t   and o1.AUOR_NU_ORDEN_REPARACION =  d.audl_auor_nu_orden  \n\t   and o1.AUOR_AUAD_NU_AJUSTE     = d.audl_auor_nu_ajuste   \n\t   and  d.audl_auor_nu_ajuste  = (Select min(b1.auaj_nu_ajuste) \n\t\t\t\t\t\t\t  from cdp_ods.SISSINIESTRO_autt_ajuste_danos b1\n\t\t\t\t\t\t\t\twhere o1.AUOR_SISI_NU_SINIESTRO = b1.AUAJ_SISI_NU_SINIESTRO\n\t\t\t\t\t\t\t\tand o1.AUOR_NU_IMPLICADO  = b1.AUAJ_NU_IMPLICADO )\n\t\t\tgroup by o1.AUOR_SISI_NU_SINIESTRO,o1.AUOR_NU_IMPLICADO,\n\t\t\to1.AUOR_NU_ORDEN_REPARACION,o1.AUOR_AUAD_NU_AJUSTE) appraiser_est_amt\n\t\t\ton sars.AUOR_SISI_NU_SINIESTRO=appraiser_est_amt.AUOR_SISI_NU_SINIESTRO\n\t\t\t\t\t\t\t   and sars.AUOR_NU_IMPLICADO=appraiser_est_amt.AUOR_NU_IMPLICADO\n\t\t\t\t\t\t\t   and sars.AUOR_NU_ORDEN_REPARACION=appraiser_est_amt.AUOR_NU_ORDEN_REPARACION\n\t\t\t   and sars.AUOR_AUAD_NU_AJUSTE=appraiser_est_amt.AUOR_AUAD_NU_AJUSTE\n\t\t\t   left outer join  \n(select MAX(FENTREGA_REAL_VEH) as  FENTREGA_REAL_VEH, MIN(FINGRESO_REAL_VEH) as FINGRESO_REAL_VEH,\nNSINIES,NTRAMIT from  cdp_ods.sisaxis_sin_gestion_reparacion \ngroup by NSINIES, NTRAMIT) ssgr \non sars.AUOR_SISI_NU_SINIESTRO=  ssgr.NSINIES and \nsars.AUOR_NU_IMPLICADO = ssgr.NTRAMIT\nleft outer join \n( select distinct mkt_ref_code, ref_cd from cdp_stg_dwh.stg_tref_code_map_variant \nwhere src_sys_cd='axis' and ref_type_cd='coverage_code') stcmv\non stcmv.ref_cd=sars.CGARANT\nleft outer join\n(select distinct NSINIES,CCAUSIN,nriesgo from cdp_ods.sisaxis_siniestros) a2 \non sars.AUOR_SISI_NU_SINIESTRO = a2.NSINIES\nand a2.nriesgo=sars.AUOR_NU_IMPLICADO\n/*Commented as part of DID-181*/\n/* left outer join\n(select  dim_cov_key,cov_cd from cdp_dwh.dim_cov_type_t where src_sys_cd='axis') clm\non clm.cov_cd=a2.CCAUSIN */ \nleft outer join\n(select  distinct a3.AUDL_AUAA_CD_PROVEEDOR,a3.AUDL_AUOR_NU_SINIESTRO,a3.audl_auor_nu_orden,\na3.audl_auor_nu_ajuste,a3.audl_auaa_tp_detalle   from cdp_ods.SISSINIESTRO_AUTT_DETALLE_ORDENES  a3 \n, cdp_ods.sisaxis_personas p\nWHERE a3.AUDL_AUAA_TP_PROVEEDOR= 90\nand a3.AUDL_AUAA_CD_PROVEEDOR = p.sperson) ad\non sars.AUOR_SISI_NU_SINIESTRO =  ad.AUDL_AUOR_NU_SINIESTRO and \nsars.AUOR_NU_ORDEN_REPARACION =  ad.audl_auor_nu_orden and \nsars.AUOR_AUAD_NU_AJUSTE     = ad.audl_auor_nu_ajuste \n--and sars.AUOR_NU_IMPLICADO=ad.audl_auaa_tp_detalle\nleft outer join\n(select distinct dim_bdshp_key,bdshp_id from cdp_dwh.dim_bdshp_t where src_sys_cd='axis') z\non z.bdshp_id=ad.AUDL_AUAA_CD_PROVEEDOR\nleft outer join\n(select distinct dim_claim_type_key,claim_type_cd from cdp_dwh.dim_claim_type_t where src_sys_cd='axis') y\non y.claim_type_cd=a2.CCAUSIN\nleft outer join\n(select distinct CUSUARI,SPERSON from cdp_ods.sisaxis_USUARIOS) x\non sars.AUOR_CD_ANALISTA = x.CUSUARI\nleft outer join\ncdp_ods.sisaxis_personas p1\non x.SPERSON  = p1.sperson\nleft outer join\n(select distinct AUDL_AUOR_NU_SINIESTRO,AUDL_AUOR_NU_ORDEN,AUDL_AUOR_NU_AJUSTE from cdp_ods.SISSINIESTRO_autt_detalle_ordenes) ad1\non ad1.AUDL_AUOR_NU_SINIESTRO = sars.AUOR_SISI_NU_SINIESTRO\nand ad1.AUDL_AUOR_NU_ORDEN =  sars.AUOR_NU_ORDEN_REPARACION \nand ad1.AUDL_AUOR_NU_AJUSTE = sars.AUOR_AUAD_NU_AJUSTE\nleft outer join\n(select distinct dim_claim_analyst_key,claim_analyst_id from cdp_dwh.dim_claim_analyst_t \nwhere src_sys_cd='axis' and analyst_profile_desc='Spare Parts Analyst') w\non w.claim_analyst_id=p1.sperson\nleft outer join \n(select distinct dim_claimant_key,claimant_num,claim_num from cdp_dwh.dim_claimant_t where src_sys_cd='axis') cl\non cl.claimant_num=sars.AUOR_NU_IMPLICADO \nand cl.claim_num=sars.AUOR_SISI_NU_SINIESTRO\n/*Updated as a part of DID-174*/\nleft outer join\n(select AUAJ_SISI_NU_SINIESTRO,AUAJ_NU_AJUSTE,AUAJ_CAPS_CD_PROVEEDOR,pers.sperson\nfrom cdp_ods.sissiniestro_AUTT_AJUSTE_DANOS aajd,\ncdp_ods.sisaxis_personas pers\n WHERE AUAJ_CAPS_TP_PROVEEDOR IN (332,333) \n and aajd.auaj_caps_cd_proveedor = pers.sperson\n ) adj\n on ad1.AUDL_AUOR_NU_SINIESTRO = adj.AUAJ_SISI_NU_SINIESTRO\nand ad1.AUDL_AUOR_NU_AJUSTE = adj.AUAJ_NU_AJUSTE\nleft outer join\n(select distinct dim_claim_adjuster_key,adjuster_id from cdp_dwh.dim_claim_adjuster_t where src_sys_cd='axis') u\non adj.sperson=u.adjuster_id\nleft outer join\n(select distinct dim_loss_item_key,loss_item_num,claim_num\nfrom cdp_dwh.dim_loss_item_t where src_sys_cd='axis'\n) ls\non ls.loss_item_num=sars.AUOR_NU_IMPLICADO\nand ls.claim_num=sars.AUOR_SISI_NU_SINIESTRO\nleft outer join\n(select distinct a4.AUDL_AUAA_CD_PROVEEDOR,a4.AUDL_AUOR_NU_SINIESTRO,\na4.audl_auor_nu_orden,a4.audl_auor_nu_ajuste  from cdp_ods.SISSINIESTRO_AUTT_DETALLE_ORDENES  a4\nWHERE a4.AUDL_AUAA_TP_PROVEEDOR= 340) ad2  \non sars. AUOR_SISI_NU_SINIESTRO =  ad2.AUDL_AUOR_NU_SINIESTRO and \nsars.AUOR_NU_ORDEN_REPARACION =  ad2.audl_auor_nu_orden and \nsars.AUOR_AUAD_NU_AJUSTE     = ad2.audl_auor_nu_ajuste\nleft outer join\n(select distinct dim_parts_provdr_key,provdr_id from cdp_dwh.dim_parts_provdr_t where src_sys_cd='axis') t\non t.provdr_id=ad2.AUDL_AUAA_CD_PROVEEDOR\nleft outer join  \n(select distinct NSINIES,NTRAMIT,max(FENTREGA_PROB_VEH) FENTREGA_PROB_VEH\nfrom cdp_ods.sisaxis_sin_gestion_reparacion \nwhere FENTREGA_PROB_VEH is not null\ngroup by NSINIES,NTRAMIT \n) ssg\non sars.AUOR_SISI_NU_SINIESTRO=  ssg.NSINIES and \nsars.AUOR_NU_IMPLICADO = ssg.NTRAMIT\nleft outer join\n(select min(FINIVIG) FINIVIG,NTRAMIT,NSINIES from cdp_ods.sisaxis_asigprotrami where CACTPRO in (332,333)\ngroup by NTRAMIT,NSINIES) s\non sars.AUOR_SISI_NU_SINIESTRO=  s.NSINIES and \nsars.AUOR_NU_IMPLICADO = s.NTRAMIT\nleft outer join\n(select distinct FECHA_AUTORIZA,NSINIES,NU_AJUSTE,ORDEN_REPARACION from cdp_ods.sissiniestro_sin_autoriza_ordenes where CESTAUT = 2) q\non sars.AUOR_SISI_NU_SINIESTRO=q.NSINIES and \nsars.AUOR_AUAD_NU_AJUSTE = q.NU_AJUSTE and\nsars.AUOR_NU_ORDEN_REPARACION= q.ORDEN_REPARACION\nleft outer join\n(select distinct SIDEPAG,FORDPAG from cdp_ods.sisaxis_PAGOSINITRAMI) pa\non sars.AUOR_SIDEPAG = pa.SIDEPAG\nleft outer join                                                              \n(SELECT min(a5.CRCO_FE_GENERACION) quot_dt,b5.crcr_auaa_nu_siniestro\nFROM cdp_ods.sisaxis_CRVT_COTIZACIONES a5, cdp_ods.sisaxis_CRVT_COT_REPUESTO b5\nWHERE a5.CRCO_SQ_COTIZACION = b5.CRCR_CRCO_COTIZACION\ngroup by b5.crcr_auaa_nu_siniestro ) quot_date\t\t\non quot_date.crcr_auaa_nu_siniestro = sars.auor_sisi_nu_siniestro\nleft outer join\n(SELECT  nvl(sum( nvl(a6.audl_auaa_mt_total,0) +  nvl(a6.audl_auaa_mt_flete,0 )),0) total_accessory_cost_amt ,\no6. AUOR_SISI_NU_SINIESTRO,\no6.AUOR_NU_IMPLICADO,\no6.AUOR_NU_ORDEN_REPARACION,\no6.AUOR_AUAD_NU_AJUSTE\nfrom  cdp_ods.sisaxis_TRAMITACIONSINI t1, cdp_stg_dwh.SISSINIESTRO_autt_ordenes_reparacion o6, cdp_ods.SISSINIESTRO_autt_detalle_ordenes a6\nwhere t1.NSINIES = o6. AUOR_SISI_NU_SINIESTRO  and \n  t1.NTRAMIT =  o6.AUOR_NU_IMPLICADO and \n  o6. AUOR_SISI_NU_SINIESTRO =  a6.AUDL_AUOR_NU_SINIESTRO and \n  o6.AUOR_NU_ORDEN_REPARACION =  a6.audl_auor_nu_orden and \n  o6.AUOR_AUAD_NU_AJUSTE     = a6.audl_auor_nu_ajuste  and \n  a6.audl_auaa_tp_detalle = '4' \n  group by o6. AUOR_SISI_NU_SINIESTRO,\no6.AUOR_NU_IMPLICADO,\no6.AUOR_NU_ORDEN_REPARACION,\no6.AUOR_AUAD_NU_AJUSTE) ad3\non  ad3.AUOR_SISI_NU_SINIESTRO=sars.AUOR_SISI_NU_SINIESTRO and \nad3.AUOR_NU_IMPLICADO=sars.AUOR_NU_IMPLICADO and\nad3.AUOR_NU_ORDEN_REPARACION=sars.AUOR_NU_ORDEN_REPARACION and\nad3.AUOR_AUAD_NU_AJUSTE=sars.AUOR_AUAD_NU_AJUSTE\nleft outer join\t  \n(SELECT SUM( a7.audl_auaa_mt_concepto)     total_mecanica,\na7.AUDL_AUOR_NU_SINIESTRO,\na7.audl_auor_nu_orden,\na7.audl_auor_nu_ajuste\nFROM cdp_ods.SISSINIESTRO_autt_detalle_ordenes a7, \n   cdp_ods.SISSINIESTRO_autt_mecanica_sini b7,\n   cdp_ods.SISSINIESTRO_autt_detalle_ajuste aju2\n   WHERE   \na7.audl_auor_nu_ajuste = aju2.auaa_auaj_nu_ajuste\nAND a7.audl_auor_nu_orden = aju2.auaa_nro_orden  \nand aju2.auaa_tp_detalle = a7.audl_auaa_tp_detalle \nand aju2.auaa_item_anulado = 0\nAND a7.audl_auaa_tp_detalle = '2'\nAND a7.audl_auaa_cd_concepto = b7.aums_cd_mecanica\nand a7.audl_auaa_cd_concepto = aju2.auaa_cd_concepto --included as part of fix, dexon # 86566-20190214\ngroup by a7.AUDL_AUOR_NU_SINIESTRO,\na7.audl_auor_nu_orden,\na7.audl_auor_nu_ajuste) ad4\non  sars.AUOR_SISI_NU_SINIESTRO =  ad4.AUDL_AUOR_NU_SINIESTRO and \n  sars.AUOR_NU_ORDEN_REPARACION =  ad4.audl_auor_nu_orden and \n  sars.AUOR_AUAD_NU_AJUSTE     = ad4.audl_auor_nu_ajuste\n  left outer join\n  (select distinct AUDO_AUOR_NU_SINIESTRO,AUDO_AUOR_NU_ORDEN,\n  AUDO_AUOR_NU_AJUSTE,AUDO_AUOR_NU_IMPLICADO,sum(AUDO_AUDO_MT_DESCUENTO) AUDO_AUDO_MT_DESCUENTO\n  from cdp_ods.SISSINIESTRO_autt_descuento_ordenes\n  group by AUDO_AUOR_NU_SINIESTRO,AUDO_AUOR_NU_ORDEN,\n  AUDO_AUOR_NU_AJUSTE,AUDO_AUOR_NU_IMPLICADO) ad5\n  on sars.AUOR_SISI_NU_SINIESTRO =  ad5.AUDO_AUOR_NU_SINIESTRO and \n  sars.AUOR_NU_ORDEN_REPARACION =  ad5.AUDO_AUOR_NU_ORDEN and \n  sars.AUOR_AUAD_NU_AJUSTE     = ad5.AUDO_AUOR_NU_AJUSTE  and \n  sars.AUOR_NU_IMPLICADO = ad5.AUDO_AUOR_NU_IMPLICADO\n  left outer join\n(SELECT distinct sum(a8.audl_auaa_mt_concepto)+sum(a8.audl_auaa_monto_pintura) total_labor_cost_amt   \n\t\t\t ,a8.AUDL_AUOR_NU_SINIESTRO\n\t\t\t ,a8.audl_auor_nu_orden\n\t\t\t ,a8.audl_auor_nu_ajuste\n\t\t\t\t  FROM cdp_ods.SISSINIESTRO_autt_detalle_ordenes a8,\n\t-- cdp_ods.SISSINIESTRO_autt_repuestos_siniestros b8,\n\t  cdp_ods.sisaxis_detvalores d8,\n\tcdp_ods.SISSINIESTRO_autt_detalle_ajuste aju2\n\tWHERE   \n  a8.audl_auor_nu_ajuste = aju2.auaa_auaj_nu_ajuste\n AND a8.audl_auor_nu_orden = aju2.auaa_nro_orden\nand a8.audl_auaa_cd_concepto = aju2.auaa_cd_concepto\n and aju2.auaa_item_anulado = 0\n and aju2.auaa_tp_detalle = a8.audl_auaa_tp_detalle \n AND a8.audl_auaa_tp_detalle = '1'\n --AND a8.audl_auaa_cd_concepto = b8.ausr_nu_repuesto\n --AND b8.ausr_auma_cd_marca = '999'\n AND d8.catribu = a8.audl_auaa_tp_dano\n AND d8.cvalor = 400005\n group by a8.AUDL_AUOR_NU_SINIESTRO\n\t\t\t ,a8.audl_auor_nu_orden\n\t\t\t ,a8.audl_auor_nu_ajuste) ad6\n on sars.AUOR_SISI_NU_SINIESTRO =  ad6.AUDL_AUOR_NU_SINIESTRO and \n  sars.AUOR_NU_ORDEN_REPARACION =  ad6.audl_auor_nu_orden and \n  sars.AUOR_AUAD_NU_AJUSTE     = ad6.audl_auor_nu_ajuste\n  left outer join\n (select distinct sum (a9.AUDL_AUAA_MT_CONCEPTO)    total_repuestos,\n  o9.AUOR_SISI_NU_SINIESTRO,o9.AUOR_NU_ORDEN_REPARACION \n  ,o9.AUOR_AUAD_NU_AJUSTE ,o9.AUOR_NU_IMPLICADO\nfrom cdp_ods.sisaxis_TRAMITACIONSINI t9, cdp_stg_dwh.SISSINIESTRO_autt_ordenes_reparacion o9, cdp_ods.SISSINIESTRO_autt_detalle_ordenes a9\nwhere t9.NSINIES = o9.AUOR_SISI_NU_SINIESTRO  and \n  t9.NTRAMIT =  o9.AUOR_NU_IMPLICADO and \n  o9.AUOR_SISI_NU_SINIESTRO =    a9.AUDL_AUOR_NU_SINIESTRO and \n  o9.AUOR_NU_ORDEN_REPARACION =  a9.audl_auor_nu_orden and \n  o9.AUOR_AUAD_NU_AJUSTE     =   a9.audl_auor_nu_ajuste  and \n  a9.audl_auaa_tp_detalle = '3'\n  group by o9.AUOR_SISI_NU_SINIESTRO,o9.AUOR_NU_ORDEN_REPARACION \n  ,o9.AUOR_AUAD_NU_AJUSTE ,o9.AUOR_NU_IMPLICADO)ad8\n\t\t   on ad8.AUOR_SISI_NU_SINIESTRO=sars.AUOR_SISI_NU_SINIESTRO and\n\t\t   ad8.AUOR_NU_ORDEN_REPARACION=sars.AUOR_NU_ORDEN_REPARACION and\n\t\t   ad8.AUOR_AUAD_NU_AJUSTE=sars.AUOR_AUAD_NU_AJUSTE and\n\t\t   ad8.AUOR_NU_IMPLICADO =sars.AUOR_NU_IMPLICADO\n/*Updated as a part of DID-166*/\t\t   \nleft outer join \t\t\t\t\t\t\t\t\t \n( select t11.NTRAMIT NTRAMIT,t11.NSINIES NSINIES,max(m11.fmovimi) as claim_closed_dt \nfrom cdp_ods.sisaxis_TRAMITACIONSINI t11 \n\t\t\t\t\t   \nleft outer join cdp_ods.sisaxis_MOVSINIESTRO m11\n\t\t\t\t\t\t\t\t  \non t11.NSINIES = m11.NSINIES\nand t11.NTRAMIT = m11.NTRAMIT\nand   m11.CESTADO = 1 \ngroup by t11.NTRAMIT,t11.NSINIES) CCD \non CCD.NSINIES = sars.AUOR_SISI_NU_SINIESTRO\nand  CCD.NTRAMIT =  sars.AUOR_NU_IMPLICADO \nand   CCD.NTRAMIT > 0            \nleft outer join\n(SELECT SUM( a10.AUDL_AUAA_NU_CANTIDAD) total_parts_qty,a10.AUDL_AUOR_NU_SINIESTRO,a10.audl_auor_nu_orden,a10.audl_auor_nu_ajuste       \nFROM cdp_ods.SISSINIESTRO_autt_detalle_ordenes a10, \n   cdp_ods.SISSINIESTRO_autt_mecanica_sini b10,\n   cdp_ods.SISSINIESTRO_autt_detalle_ajuste aju4\nWHERE  \na10.audl_auor_nu_ajuste = aju4.auaa_auaj_nu_ajuste\nAND a10.audl_auor_nu_orden = aju4.auaa_nro_orden  \nand aju4.auaa_tp_detalle = a10.audl_auaa_tp_detalle \nand aju4.auaa_item_anulado = 0\nAND a10.audl_auaa_tp_detalle = '3'\nAND a10.audl_auaa_cd_concepto = b10.aums_cd_mecanica\nand a10.audl_auaa_cd_concepto = aju4.auaa_cd_concepto --included as part of fix, dexon # 86566-20190214\ngroup by a10.AUDL_AUOR_NU_SINIESTRO,a10.audl_auor_nu_orden,a10.audl_auor_nu_ajuste) ad9\non  sars.AUOR_SISI_NU_SINIESTRO =  ad9.AUDL_AUOR_NU_SINIESTRO and \n  sars.AUOR_NU_ORDEN_REPARACION =  ad9.audl_auor_nu_orden and \n  sars.AUOR_AUAD_NU_AJUSTE     = ad9.audl_auor_nu_ajuste      \n  left outer join cdp_stg_dwh.stg_tref_code_map_variant brch_stg_map\n on right( '00000000' + cast( substring(sars.AUOR_SISI_CASU_CD_SUCURSAL,2) as varchar), 8)=brch_stg_map.ref_cd \n and brch_stg_map.src_sys_cd='axis' and brch_stg_map.ref_type_cd='branch_office' \nleft outer join cdp_dwh.dim_branch_office_t branch_key \n on branch_key.branch_office_cd=nvl(brch_stg_map.mkt_ref_code,right( '00000000' + cast( substring(sars.AUOR_SISI_CASU_CD_SUCURSAL,2) as varchar), 8))\nleft outer join \n\t\t\t (select distinct status_desc.mkt_ref_code_desc,status_desc.ref_desc,status_desc.ref_cd\n\t\t\t  from cdp_stg_dwh.stg_tref_code_map_variant status_desc \n\t\t\t\t where status_desc.ref_type_cd = 'order_type' and src_sys_cd = 'axis') ad12\n\t\t\ton ad12.ref_cd=sars.AUOR_TP_ORDEN\n--Proposed Change\nleft outer join \n(select distinct status_desc.mkt_ref_code_desc,status_desc.ref_desc,status_desc.ref_cd\nfrom cdp_stg_dwh.stg_tref_code_map_variant status_desc \nwhere status_desc.ref_type_cd = 'order_status' and src_sys_cd = 'axis') ad13\non ad13.ref_cd=sars.AUOR_ST_ORDEN\nleft outer join\n(select distinct dim_claim_key,claim_num from cdp_dwh.dim_claim_t\nwhere src_sys_cd='axis') dim_claim\non sars.AUOR_SISI_NU_SINIESTRO=dim_claim.claim_num\n/*New logic for dim_claim_type_key*/\nleft outer join\n(select distinct dim_claim_type_key,claim_type_cd,a. NSINIES from \ncdp_dwh.dim_claim_type_t y, cdp_ods.sisaxis_siniestros  a\nwhere y.claim_type_cd=a.CCAUSIN and src_sys_cd='axis') AA\non sars.AUOR_SISI_NU_SINIESTRO = AA.NSINIES\n/*left outer join\n(select count(AUOR_SISI_NU_SINIESTRO) total_adj_count,AUOR_SISI_NU_SINIESTRO from cdp_ods.SISSINIESTRO_AUTT_ORDENES_REPARACION\ngroup by AUOR_SISI_NU_SINIESTRO) adj_ord_cnt\non sars.AUOR_SISI_NU_SINIESTRO=adj_ord_cnt.total_adj_count\nleft outer join\n(select count(AUOR_SISI_NU_SINIESTRO) order_cnt_num,AUOR_SISI_NU_SINIESTRO from(select distinct AUOR_SISI_NU_SINIESTRO,\nAUOR_NU_ORDEN_REPARACION from cdp_ods.SISSINIESTRO_AUTT_ORDENES_REPARACION)\ngroup by AUOR_SISI_NU_SINIESTRO) ord_num\non sars.AUOR_SISI_NU_SINIESTRO=ord_num.order_cnt_num */\n)\nsrc\nleft outer join\n(select 1 as dummy, max(fact_parts_svc_order_key) as MAX_SID from cdp_dwh.fact_parts_svc_order_summary_t_test) LKP_MAXSID\non src.dummy = LKP_MAXSID.dummy\n)\nwhere row_cnt = 1"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[1].dataAdapter.object.customQuery",
        "value": "SELECT \nfact_parts_svc_order_key,\nsrc_sys_cd,\nclaim_num,\nclaimant_num,\nloss_item_num,\norder_Num,\nadj_num\nFROM cdp_dwh.fact_parts_svc_order_summary_t_test\nwhere src_sys_cd='axis'"
    }
]