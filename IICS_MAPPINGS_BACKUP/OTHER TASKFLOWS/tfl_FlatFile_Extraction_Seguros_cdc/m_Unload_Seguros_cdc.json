[
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.oprRuntimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "Truncate table cdp_stg_dwh.sisaxis_seguros_cdc_incremental;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.oprRuntimeAttributes.attributes[10]",
        "name": "Post-sql",
        "value": "insert into cdp_stg_dwh.sisaxis_seguros_cdc_incremental (select  op,sseguro,cmodali,ccolect,ctipseg,casegur,cagente,cramo,npoliza,ncertif,nsuplem,fefecto,creafac,ctarman,cobjase,ctipreb,cactivi,ccobban,ctipcoa,ctiprea,crecman,creccob,ctipcom,fvencim,femisio,fanulac,fcancel,csituac,cbancar,ctipcol,fcarant,fcarpro,fcaranu,cduraci,nduraci,nanuali,iprianu,cidioma,nfracci,cforpag,pdtoord,nrenova,crecfra,tasegur,creteni,ndurcob,sciacoa,pparcoa,npolcoa,nsupcoa,tnatrie,pdtocom,prevali,irevali,ncuacoa,nedamed,crevali,cempres,cagrpro,nsolici,intpres,fimpsol,nmescob,sproduc,ccompani,nparben,nbns,ctramo,cindext,pdispri,idispri,cimpase,cagecob,csolici,cnatrie,pdtoaseg,cnotibaja,ccartera,cagencorr,cmigra,cmonseg,clinneg,cagrseg,iprianuseg,irevaliseg,fcambio,crfaage,nsuppol,npropm,cflota,creserva,rec_crt_dtm,seq_id,md5(nvl(sseguro||'','')||nvl(cmodali||'','')||nvl(ccolect||'','')||nvl(ctipseg||'','')||nvl(casegur||'','')||nvl(cagente||'','')||nvl(cramo||'','')||nvl(npoliza||'','')||nvl(ncertif||'','')||nvl(nsuplem||'','')||nvl(fefecto||'','')||nvl(creafac||'','')||nvl(ctarman||'','')||nvl(cobjase||'','')||nvl(ctipreb||'','')||nvl(cactivi||'','')||nvl(ccobban||'','')||nvl(ctipcoa||'','')||nvl(ctiprea||'','')||nvl(crecman||'','')||nvl(creccob||'','')||nvl(ctipcom||'','')||nvl(fvencim||'','')||nvl(femisio||'','')||nvl(fanulac||'','')||nvl(fcancel||'','')||nvl(csituac||'','')||nvl(cbancar||'','')||nvl(ctipcol||'','')||nvl(fcarant||'','')||nvl(fcarpro||'','')||nvl(fcaranu||'','')||nvl(cduraci||'','')||nvl(nduraci||'','')||nvl(nanuali||'','')||nvl(iprianu||'','')||nvl(cidioma||'','')||nvl(nfracci||'','')||nvl(cforpag||'','')||nvl(pdtoord||'','')||nvl(nrenova||'','')||nvl(crecfra||'','')||nvl(tasegur||'','')||nvl(creteni||'','')||nvl(ndurcob||'','')||nvl(sciacoa||'','')||nvl(pparcoa||'','')||nvl(npolcoa||'','')||nvl(nsupcoa||'','')||nvl(tnatrie||'','')||nvl(pdtocom||'','')||nvl(prevali||'','')||nvl(irevali||'','')||nvl(ncuacoa||'','')||nvl(nedamed||'','')||nvl(crevali||'','')||nvl(cempres||'','')||nvl(cagrpro||'','')||nvl(nsolici||'','')||nvl(intpres||'','')||nvl(fimpsol||'','')||nvl(nmescob||'','')||nvl(sproduc||'','')||nvl(ccompani||'','')||nvl(nparben||'','')||nvl(nbns||'','')||nvl(ctramo||'','')||nvl(cindext||'','')||nvl(pdispri||'','')||nvl(idispri||'','')||nvl(cimpase||'','')||nvl(cagecob||'','')||nvl(csolici||'','')||nvl(cnatrie||'','')||nvl(pdtoaseg||'','')||nvl(cnotibaja||'','')||nvl(ccartera||'','')||nvl(cagencorr||'','')||nvl(cmigra||'','')||nvl(cmonseg||'','')||nvl(clinneg||'','')||nvl(cagrseg||'','')||nvl(iprianuseg||'','')||nvl(irevaliseg||'','')||nvl(fcambio||'','')||nvl(crfaage||'','')||nvl(nsuppol||'','')||nvl(npropm||'','')||nvl(cflota||'','')||nvl(creserva||'',''))\nAS hash_value from\ncdp_stg_dwh.sisaxis_seguros\nwhere op='I');\n\n\n\ninsert into cdp_stg_dwh.sisaxis_seguros_cdc_incremental(op,sseguro,cmodali,ccolect,ctipseg,casegur,cagente,cramo,npoliza,ncertif,nsuplem,fefecto,creafac,ctarman,cobjase,ctipreb,cactivi,ccobban,ctipcoa,ctiprea,crecman,creccob,ctipcom,fvencim,femisio,fanulac,fcancel,csituac,cbancar,ctipcol,fcarant,fcarpro,fcaranu,cduraci,nduraci,nanuali,iprianu,cidioma,nfracci,cforpag,pdtoord,nrenova,crecfra,tasegur,creteni,ndurcob,sciacoa,pparcoa,npolcoa,nsupcoa,tnatrie,pdtocom,prevali,irevali,ncuacoa,nedamed,crevali,cempres,cagrpro,nsolici,intpres,fimpsol,nmescob,sproduc,ccompani,nparben,nbns,ctramo,cindext,pdispri,idispri,cimpase,cagecob,csolici,cnatrie,pdtoaseg,cnotibaja,ccartera,cagencorr,cmigra,cmonseg,clinneg,cagrseg,iprianuseg,irevaliseg,fcambio,crfaage,nsuppol,npropm,cflota,creserva,hash_value)\n(select stg_ods_src.op,stg_ods_src.sseguro,stg_ods_src.cmodali,stg_ods_src.ccolect,stg_ods_src.ctipseg,stg_ods_src.casegur,stg_ods_src.cagente,stg_ods_src.cramo,stg_ods_src.npoliza,stg_ods_src.ncertif,stg_ods_src.nsuplem,stg_ods_src.fefecto,stg_ods_src.creafac,stg_ods_src.ctarman,stg_ods_src.cobjase,stg_ods_src.ctipreb,stg_ods_src.cactivi,stg_ods_src.ccobban,stg_ods_src.ctipcoa,stg_ods_src.ctiprea,stg_ods_src.crecman,stg_ods_src.creccob,stg_ods_src.ctipcom,stg_ods_src.fvencim,stg_ods_src.femisio,stg_ods_src.fanulac,stg_ods_src.fcancel,stg_ods_src.csituac,stg_ods_src.cbancar,stg_ods_src.ctipcol,stg_ods_src.fcarant,stg_ods_src.fcarpro,stg_ods_src.fcaranu,stg_ods_src.cduraci,stg_ods_src.nduraci,stg_ods_src.nanuali,stg_ods_src.iprianu,stg_ods_src.cidioma,stg_ods_src.nfracci,stg_ods_src.cforpag,stg_ods_src.pdtoord,stg_ods_src.nrenova,stg_ods_src.crecfra,stg_ods_src.tasegur,stg_ods_src.creteni,stg_ods_src.ndurcob,stg_ods_src.sciacoa,stg_ods_src.pparcoa,stg_ods_src.npolcoa,stg_ods_src.nsupcoa,stg_ods_src.tnatrie,stg_ods_src.pdtocom,stg_ods_src.prevali,stg_ods_src.irevali,stg_ods_src.ncuacoa,stg_ods_src.nedamed,stg_ods_src.crevali,stg_ods_src.cempres,stg_ods_src.cagrpro,stg_ods_src.nsolici,stg_ods_src.intpres,stg_ods_src.fimpsol,stg_ods_src.nmescob,stg_ods_src.sproduc,stg_ods_src.ccompani,stg_ods_src.nparben,stg_ods_src.nbns,stg_ods_src.ctramo,stg_ods_src.cindext,stg_ods_src.pdispri,stg_ods_src.idispri,stg_ods_src.cimpase,stg_ods_src.cagecob,stg_ods_src.csolici,stg_ods_src.cnatrie,stg_ods_src.pdtoaseg,stg_ods_src.cnotibaja,stg_ods_src.ccartera,stg_ods_src.cagencorr,stg_ods_src.cmigra,stg_ods_src.cmonseg,stg_ods_src.clinneg,stg_ods_src.cagrseg,stg_ods_src.iprianuseg,stg_ods_src.irevaliseg,stg_ods_src.fcambio,stg_ods_src.crfaage,stg_ods_src.nsuppol,stg_ods_src.npropm,stg_ods_src.cflota,stg_ods_src.creserva,stg_ods_src.hashvalue from\n(select distinct op,sseguro,cmodali,ccolect,ctipseg,casegur,cagente,cramo,npoliza,ncertif,nsuplem,fefecto,creafac,ctarman,cobjase,ctipreb,cactivi,ccobban,ctipcoa,ctiprea,crecman,creccob,ctipcom,fvencim,femisio,fanulac,fcancel,csituac,cbancar,ctipcol,fcarant,fcarpro,fcaranu,cduraci,nduraci,nanuali,iprianu,cidioma,nfracci,cforpag,pdtoord,nrenova,crecfra,tasegur,creteni,ndurcob,sciacoa,pparcoa,npolcoa,nsupcoa,tnatrie,pdtocom,prevali,irevali,ncuacoa,nedamed,crevali,cempres,cagrpro,nsolici,intpres,fimpsol,nmescob,sproduc,ccompani,nparben,nbns,ctramo,cindext,pdispri,idispri,cimpase,cagecob,csolici,cnatrie,pdtoaseg,cnotibaja,ccartera,cagencorr,cmigra,cmonseg,clinneg,cagrseg,iprianuseg,irevaliseg,fcambio,crfaage,nsuppol,npropm,cflota,creserva,\nmd5(nvl(sseguro||'','')||nvl(cmodali||'','')||nvl(ccolect||'','')||nvl(ctipseg||'','')||nvl(casegur||'','')||nvl(cagente||'','')||nvl(cramo||'','')||nvl(npoliza||'','')||nvl(ncertif||'','')||nvl(nsuplem||'','')||nvl(fefecto||'','')||nvl(creafac||'','')||nvl(ctarman||'','')||nvl(cobjase||'','')||nvl(ctipreb||'','')||nvl(cactivi||'','')||nvl(ccobban||'','')||nvl(ctipcoa||'','')||nvl(ctiprea||'','')||nvl(crecman||'','')||nvl(creccob||'','')||nvl(ctipcom||'','')||nvl(fvencim||'','')||nvl(femisio||'','')||nvl(fanulac||'','')||nvl(fcancel||'','')||nvl(csituac||'','')||nvl(cbancar||'','')||nvl(ctipcol||'','')||nvl(fcarant||'','')||nvl(fcarpro||'','')||nvl(fcaranu||'','')||nvl(cduraci||'','')||nvl(nduraci||'','')||nvl(nanuali||'','')||nvl(iprianu||'','')||nvl(cidioma||'','')||nvl(nfracci||'','')||nvl(cforpag||'','')||nvl(pdtoord||'','')||nvl(nrenova||'','')||nvl(crecfra||'','')||nvl(tasegur||'','')||nvl(creteni||'','')||nvl(ndurcob||'','')||nvl(sciacoa||'','')||nvl(pparcoa||'','')||nvl(npolcoa||'','')||nvl(nsupcoa||'','')||nvl(tnatrie||'','')||nvl(pdtocom||'','')||nvl(prevali||'','')||nvl(irevali||'','')||nvl(ncuacoa||'','')||nvl(nedamed||'','')||nvl(crevali||'','')||nvl(cempres||'','')||nvl(cagrpro||'','')||nvl(nsolici||'','')||nvl(intpres||'','')||nvl(fimpsol||'','')||nvl(nmescob||'','')||nvl(sproduc||'','')||nvl(ccompani||'','')||nvl(nparben||'','')||nvl(nbns||'','')||nvl(ctramo||'','')||nvl(cindext||'','')||nvl(pdispri||'','')||nvl(idispri||'','')||nvl(cimpase||'','')||nvl(cagecob||'','')||nvl(csolici||'','')||nvl(cnatrie||'','')||nvl(pdtoaseg||'','')||nvl(cnotibaja||'','')||nvl(ccartera||'','')||nvl(cagencorr||'','')||nvl(cmigra||'','')||nvl(cmonseg||'','')||nvl(clinneg||'','')||nvl(cagrseg||'','')||nvl(iprianuseg||'','')||nvl(irevaliseg||'','')||nvl(fcambio||'','')||nvl(crfaage||'','')||nvl(nsuppol||'','')||nvl(npropm||'','')||nvl(cflota||'','')||nvl(creserva||'',''))\n AS hashvalue\nfrom cdp_stg_dwh.sisaxis_seguros) stg_ods_src\nLEFT JOIN cdp_stg_dwh.sisaxis_seguros_cdc tgt_ods\nON tgt_ods.hash_value = stg_ods_src.hashvalue\nwhere tgt_ods.hash_value is Null\nand stg_ods_src.op ='U'  );\n\ndelete from cdp_stg_dwh.sisaxis_seguros_cdc_incremental\nWHERE HASH_VALUE IN\n(SELECT DISTINCT A.HASH_VALUE\nFROM  cdp_stg_dwh.sisaxis_seguros_cdc_incremental A,\n      cdp_stg_dwh.sisaxis_seguros_cdc_incremental B\nWHERE A.sseguro = B.sseguro\nAND   A.HASH_VALUE= B.HASH_VALUE\ngroup by A.HASH_VALUE\nhaving count(A.HASH_VALUE) > 1)  and op = 'U';\n\n\nupdate cdp_stg_dwh.sisaxis_seguros_cdc_incremental set rec_crt_dtm=stg_ods_src.rec_crt_dtm,seq_id=stg_ods_src.seq_id from \n(select op,rec_crt_dtm,seq_id,\nmd5(nvl(sseguro||'','')||nvl(cmodali||'','')||nvl(ccolect||'','')||nvl(ctipseg||'','')||nvl(casegur||'','')||nvl(cagente||'','')||nvl(cramo||'','')||nvl(npoliza||'','')||nvl(ncertif||'','')||nvl(nsuplem||'','')||nvl(fefecto||'','')||nvl(creafac||'','')||nvl(ctarman||'','')||nvl(cobjase||'','')||nvl(ctipreb||'','')||nvl(cactivi||'','')||nvl(ccobban||'','')||nvl(ctipcoa||'','')||nvl(ctiprea||'','')||nvl(crecman||'','')||nvl(creccob||'','')||nvl(ctipcom||'','')||nvl(fvencim||'','')||nvl(femisio||'','')||nvl(fanulac||'','')||nvl(fcancel||'','')||nvl(csituac||'','')||nvl(cbancar||'','')||nvl(ctipcol||'','')||nvl(fcarant||'','')||nvl(fcarpro||'','')||nvl(fcaranu||'','')||nvl(cduraci||'','')||nvl(nduraci||'','')||nvl(nanuali||'','')||nvl(iprianu||'','')||nvl(cidioma||'','')||nvl(nfracci||'','')||nvl(cforpag||'','')||nvl(pdtoord||'','')||nvl(nrenova||'','')||nvl(crecfra||'','')||nvl(tasegur||'','')||nvl(creteni||'','')||nvl(ndurcob||'','')||nvl(sciacoa||'','')||nvl(pparcoa||'','')||nvl(npolcoa||'','')||nvl(nsupcoa||'','')||nvl(tnatrie||'','')||nvl(pdtocom||'','')||nvl(prevali||'','')||nvl(irevali||'','')||nvl(ncuacoa||'','')||nvl(nedamed||'','')||nvl(crevali||'','')||nvl(cempres||'','')||nvl(cagrpro||'','')||nvl(nsolici||'','')||nvl(intpres||'','')||nvl(fimpsol||'','')||nvl(nmescob||'','')||nvl(sproduc||'','')||nvl(ccompani||'','')||nvl(nparben||'','')||nvl(nbns||'','')||nvl(ctramo||'','')||nvl(cindext||'','')||nvl(pdispri||'','')||nvl(idispri||'','')||nvl(cimpase||'','')||nvl(cagecob||'','')||nvl(csolici||'','')||nvl(cnatrie||'','')||nvl(pdtoaseg||'','')||nvl(cnotibaja||'','')||nvl(ccartera||'','')||nvl(cagencorr||'','')||nvl(cmigra||'','')||nvl(cmonseg||'','')||nvl(clinneg||'','')||nvl(cagrseg||'','')||nvl(iprianuseg||'','')||nvl(irevaliseg||'','')||nvl(fcambio||'','')||nvl(crfaage||'','')||nvl(nsuppol||'','')||nvl(npropm||'','')||nvl(cflota||'','')||nvl(creserva||'',''))\n AS hashvalue, row_number() over ( partition by hashvalue order by rec_crt_dtm,seq_id desc)rnk\nfrom cdp_stg_dwh.sisaxis_seguros) stg_ods_src\ninner JOIN cdp_stg_dwh.sisaxis_seguros_cdc_incremental tgt_ods\nON tgt_ods.hash_value = stg_ods_src.hashvalue\nwhere tgt_ods.op ='U' and stg_ods_src.rnk=1 ;\n\n\nunload ('select op,sseguro,cmodali,ccolect,ctipseg,casegur,cagente,cramo,npoliza,ncertif,nsuplem,fefecto,creafac,ctarman,cobjase,ctipreb,cactivi,ccobban,ctipcoa,ctiprea,crecman,creccob,ctipcom,fvencim,femisio,fanulac,fcancel,csituac,cbancar,ctipcol,fcarant,fcarpro,fcaranu,cduraci,nduraci,nanuali,iprianu,cidioma,nfracci,cforpag,pdtoord,nrenova,crecfra,tasegur,creteni,ndurcob,sciacoa,pparcoa,npolcoa,nsupcoa,tnatrie,pdtocom,prevali,irevali,ncuacoa,nedamed,crevali,cempres,cagrpro,nsolici,intpres,fimpsol,nmescob,sproduc,ccompani,nparben,nbns,ctramo,cindext,pdispri,idispri,cimpase,cagecob,csolici,cnatrie,pdtoaseg,cnotibaja,ccartera,cagencorr,cmigra,cmonseg,clinneg,cagrseg,iprianuseg,irevaliseg,fcambio,crfaage,nsuppol,npropm,cflota,creserva,rec_crt_dtm,seq_id\n from  cdp_stg_dwh.sisaxis_seguros_cdc_incremental order by sseguro, op, rec_crt_dtm,seq_id')\nto 's3://$$S3_Bucket_Name/consolidated-files-history-CDC/sisaxis_seguros_cdc/SISAXIS_SEGUROS_CDC' IAM_ROLE '$$AWS_IAM_ROLE'\nCSV DELIMITER AS '|' PARALLEL OFF HEADER gzip allowoverwrite NULL AS '\\0';"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "Truncate table cdp_stg_dwh.sisaxis_seguros_cdc_incremental;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[10]",
        "name": "Post-sql",
        "value": "insert into cdp_stg_dwh.sisaxis_seguros_cdc_incremental (select  op,sseguro,cmodali,ccolect,ctipseg,casegur,cagente,cramo,npoliza,ncertif,nsuplem,fefecto,creafac,ctarman,cobjase,ctipreb,cactivi,ccobban,ctipcoa,ctiprea,crecman,creccob,ctipcom,fvencim,femisio,fanulac,fcancel,csituac,cbancar,ctipcol,fcarant,fcarpro,fcaranu,cduraci,nduraci,nanuali,iprianu,cidioma,nfracci,cforpag,pdtoord,nrenova,crecfra,tasegur,creteni,ndurcob,sciacoa,pparcoa,npolcoa,nsupcoa,tnatrie,pdtocom,prevali,irevali,ncuacoa,nedamed,crevali,cempres,cagrpro,nsolici,intpres,fimpsol,nmescob,sproduc,ccompani,nparben,nbns,ctramo,cindext,pdispri,idispri,cimpase,cagecob,csolici,cnatrie,pdtoaseg,cnotibaja,ccartera,cagencorr,cmigra,cmonseg,clinneg,cagrseg,iprianuseg,irevaliseg,fcambio,crfaage,nsuppol,npropm,cflota,creserva,rec_crt_dtm,seq_id,md5(nvl(sseguro||'','')||nvl(cmodali||'','')||nvl(ccolect||'','')||nvl(ctipseg||'','')||nvl(casegur||'','')||nvl(cagente||'','')||nvl(cramo||'','')||nvl(npoliza||'','')||nvl(ncertif||'','')||nvl(nsuplem||'','')||nvl(fefecto||'','')||nvl(creafac||'','')||nvl(ctarman||'','')||nvl(cobjase||'','')||nvl(ctipreb||'','')||nvl(cactivi||'','')||nvl(ccobban||'','')||nvl(ctipcoa||'','')||nvl(ctiprea||'','')||nvl(crecman||'','')||nvl(creccob||'','')||nvl(ctipcom||'','')||nvl(fvencim||'','')||nvl(femisio||'','')||nvl(fanulac||'','')||nvl(fcancel||'','')||nvl(csituac||'','')||nvl(cbancar||'','')||nvl(ctipcol||'','')||nvl(fcarant||'','')||nvl(fcarpro||'','')||nvl(fcaranu||'','')||nvl(cduraci||'','')||nvl(nduraci||'','')||nvl(nanuali||'','')||nvl(iprianu||'','')||nvl(cidioma||'','')||nvl(nfracci||'','')||nvl(cforpag||'','')||nvl(pdtoord||'','')||nvl(nrenova||'','')||nvl(crecfra||'','')||nvl(tasegur||'','')||nvl(creteni||'','')||nvl(ndurcob||'','')||nvl(sciacoa||'','')||nvl(pparcoa||'','')||nvl(npolcoa||'','')||nvl(nsupcoa||'','')||nvl(tnatrie||'','')||nvl(pdtocom||'','')||nvl(prevali||'','')||nvl(irevali||'','')||nvl(ncuacoa||'','')||nvl(nedamed||'','')||nvl(crevali||'','')||nvl(cempres||'','')||nvl(cagrpro||'','')||nvl(nsolici||'','')||nvl(intpres||'','')||nvl(fimpsol||'','')||nvl(nmescob||'','')||nvl(sproduc||'','')||nvl(ccompani||'','')||nvl(nparben||'','')||nvl(nbns||'','')||nvl(ctramo||'','')||nvl(cindext||'','')||nvl(pdispri||'','')||nvl(idispri||'','')||nvl(cimpase||'','')||nvl(cagecob||'','')||nvl(csolici||'','')||nvl(cnatrie||'','')||nvl(pdtoaseg||'','')||nvl(cnotibaja||'','')||nvl(ccartera||'','')||nvl(cagencorr||'','')||nvl(cmigra||'','')||nvl(cmonseg||'','')||nvl(clinneg||'','')||nvl(cagrseg||'','')||nvl(iprianuseg||'','')||nvl(irevaliseg||'','')||nvl(fcambio||'','')||nvl(crfaage||'','')||nvl(nsuppol||'','')||nvl(npropm||'','')||nvl(cflota||'','')||nvl(creserva||'',''))\nAS hash_value from\ncdp_stg_dwh.sisaxis_seguros\nwhere op='I');\n\n\n\ninsert into cdp_stg_dwh.sisaxis_seguros_cdc_incremental(op,sseguro,cmodali,ccolect,ctipseg,casegur,cagente,cramo,npoliza,ncertif,nsuplem,fefecto,creafac,ctarman,cobjase,ctipreb,cactivi,ccobban,ctipcoa,ctiprea,crecman,creccob,ctipcom,fvencim,femisio,fanulac,fcancel,csituac,cbancar,ctipcol,fcarant,fcarpro,fcaranu,cduraci,nduraci,nanuali,iprianu,cidioma,nfracci,cforpag,pdtoord,nrenova,crecfra,tasegur,creteni,ndurcob,sciacoa,pparcoa,npolcoa,nsupcoa,tnatrie,pdtocom,prevali,irevali,ncuacoa,nedamed,crevali,cempres,cagrpro,nsolici,intpres,fimpsol,nmescob,sproduc,ccompani,nparben,nbns,ctramo,cindext,pdispri,idispri,cimpase,cagecob,csolici,cnatrie,pdtoaseg,cnotibaja,ccartera,cagencorr,cmigra,cmonseg,clinneg,cagrseg,iprianuseg,irevaliseg,fcambio,crfaage,nsuppol,npropm,cflota,creserva,hash_value)\n(select stg_ods_src.op,stg_ods_src.sseguro,stg_ods_src.cmodali,stg_ods_src.ccolect,stg_ods_src.ctipseg,stg_ods_src.casegur,stg_ods_src.cagente,stg_ods_src.cramo,stg_ods_src.npoliza,stg_ods_src.ncertif,stg_ods_src.nsuplem,stg_ods_src.fefecto,stg_ods_src.creafac,stg_ods_src.ctarman,stg_ods_src.cobjase,stg_ods_src.ctipreb,stg_ods_src.cactivi,stg_ods_src.ccobban,stg_ods_src.ctipcoa,stg_ods_src.ctiprea,stg_ods_src.crecman,stg_ods_src.creccob,stg_ods_src.ctipcom,stg_ods_src.fvencim,stg_ods_src.femisio,stg_ods_src.fanulac,stg_ods_src.fcancel,stg_ods_src.csituac,stg_ods_src.cbancar,stg_ods_src.ctipcol,stg_ods_src.fcarant,stg_ods_src.fcarpro,stg_ods_src.fcaranu,stg_ods_src.cduraci,stg_ods_src.nduraci,stg_ods_src.nanuali,stg_ods_src.iprianu,stg_ods_src.cidioma,stg_ods_src.nfracci,stg_ods_src.cforpag,stg_ods_src.pdtoord,stg_ods_src.nrenova,stg_ods_src.crecfra,stg_ods_src.tasegur,stg_ods_src.creteni,stg_ods_src.ndurcob,stg_ods_src.sciacoa,stg_ods_src.pparcoa,stg_ods_src.npolcoa,stg_ods_src.nsupcoa,stg_ods_src.tnatrie,stg_ods_src.pdtocom,stg_ods_src.prevali,stg_ods_src.irevali,stg_ods_src.ncuacoa,stg_ods_src.nedamed,stg_ods_src.crevali,stg_ods_src.cempres,stg_ods_src.cagrpro,stg_ods_src.nsolici,stg_ods_src.intpres,stg_ods_src.fimpsol,stg_ods_src.nmescob,stg_ods_src.sproduc,stg_ods_src.ccompani,stg_ods_src.nparben,stg_ods_src.nbns,stg_ods_src.ctramo,stg_ods_src.cindext,stg_ods_src.pdispri,stg_ods_src.idispri,stg_ods_src.cimpase,stg_ods_src.cagecob,stg_ods_src.csolici,stg_ods_src.cnatrie,stg_ods_src.pdtoaseg,stg_ods_src.cnotibaja,stg_ods_src.ccartera,stg_ods_src.cagencorr,stg_ods_src.cmigra,stg_ods_src.cmonseg,stg_ods_src.clinneg,stg_ods_src.cagrseg,stg_ods_src.iprianuseg,stg_ods_src.irevaliseg,stg_ods_src.fcambio,stg_ods_src.crfaage,stg_ods_src.nsuppol,stg_ods_src.npropm,stg_ods_src.cflota,stg_ods_src.creserva,stg_ods_src.hashvalue from\n(select distinct op,sseguro,cmodali,ccolect,ctipseg,casegur,cagente,cramo,npoliza,ncertif,nsuplem,fefecto,creafac,ctarman,cobjase,ctipreb,cactivi,ccobban,ctipcoa,ctiprea,crecman,creccob,ctipcom,fvencim,femisio,fanulac,fcancel,csituac,cbancar,ctipcol,fcarant,fcarpro,fcaranu,cduraci,nduraci,nanuali,iprianu,cidioma,nfracci,cforpag,pdtoord,nrenova,crecfra,tasegur,creteni,ndurcob,sciacoa,pparcoa,npolcoa,nsupcoa,tnatrie,pdtocom,prevali,irevali,ncuacoa,nedamed,crevali,cempres,cagrpro,nsolici,intpres,fimpsol,nmescob,sproduc,ccompani,nparben,nbns,ctramo,cindext,pdispri,idispri,cimpase,cagecob,csolici,cnatrie,pdtoaseg,cnotibaja,ccartera,cagencorr,cmigra,cmonseg,clinneg,cagrseg,iprianuseg,irevaliseg,fcambio,crfaage,nsuppol,npropm,cflota,creserva,\nmd5(nvl(sseguro||'','')||nvl(cmodali||'','')||nvl(ccolect||'','')||nvl(ctipseg||'','')||nvl(casegur||'','')||nvl(cagente||'','')||nvl(cramo||'','')||nvl(npoliza||'','')||nvl(ncertif||'','')||nvl(nsuplem||'','')||nvl(fefecto||'','')||nvl(creafac||'','')||nvl(ctarman||'','')||nvl(cobjase||'','')||nvl(ctipreb||'','')||nvl(cactivi||'','')||nvl(ccobban||'','')||nvl(ctipcoa||'','')||nvl(ctiprea||'','')||nvl(crecman||'','')||nvl(creccob||'','')||nvl(ctipcom||'','')||nvl(fvencim||'','')||nvl(femisio||'','')||nvl(fanulac||'','')||nvl(fcancel||'','')||nvl(csituac||'','')||nvl(cbancar||'','')||nvl(ctipcol||'','')||nvl(fcarant||'','')||nvl(fcarpro||'','')||nvl(fcaranu||'','')||nvl(cduraci||'','')||nvl(nduraci||'','')||nvl(nanuali||'','')||nvl(iprianu||'','')||nvl(cidioma||'','')||nvl(nfracci||'','')||nvl(cforpag||'','')||nvl(pdtoord||'','')||nvl(nrenova||'','')||nvl(crecfra||'','')||nvl(tasegur||'','')||nvl(creteni||'','')||nvl(ndurcob||'','')||nvl(sciacoa||'','')||nvl(pparcoa||'','')||nvl(npolcoa||'','')||nvl(nsupcoa||'','')||nvl(tnatrie||'','')||nvl(pdtocom||'','')||nvl(prevali||'','')||nvl(irevali||'','')||nvl(ncuacoa||'','')||nvl(nedamed||'','')||nvl(crevali||'','')||nvl(cempres||'','')||nvl(cagrpro||'','')||nvl(nsolici||'','')||nvl(intpres||'','')||nvl(fimpsol||'','')||nvl(nmescob||'','')||nvl(sproduc||'','')||nvl(ccompani||'','')||nvl(nparben||'','')||nvl(nbns||'','')||nvl(ctramo||'','')||nvl(cindext||'','')||nvl(pdispri||'','')||nvl(idispri||'','')||nvl(cimpase||'','')||nvl(cagecob||'','')||nvl(csolici||'','')||nvl(cnatrie||'','')||nvl(pdtoaseg||'','')||nvl(cnotibaja||'','')||nvl(ccartera||'','')||nvl(cagencorr||'','')||nvl(cmigra||'','')||nvl(cmonseg||'','')||nvl(clinneg||'','')||nvl(cagrseg||'','')||nvl(iprianuseg||'','')||nvl(irevaliseg||'','')||nvl(fcambio||'','')||nvl(crfaage||'','')||nvl(nsuppol||'','')||nvl(npropm||'','')||nvl(cflota||'','')||nvl(creserva||'',''))\n AS hashvalue\nfrom cdp_stg_dwh.sisaxis_seguros) stg_ods_src\nLEFT JOIN cdp_stg_dwh.sisaxis_seguros_cdc tgt_ods\nON tgt_ods.hash_value = stg_ods_src.hashvalue\nwhere tgt_ods.hash_value is Null\nand stg_ods_src.op ='U'  );\n\ndelete from cdp_stg_dwh.sisaxis_seguros_cdc_incremental\nWHERE HASH_VALUE IN\n(SELECT DISTINCT A.HASH_VALUE\nFROM  cdp_stg_dwh.sisaxis_seguros_cdc_incremental A,\n      cdp_stg_dwh.sisaxis_seguros_cdc_incremental B\nWHERE A.sseguro = B.sseguro\nAND   A.HASH_VALUE= B.HASH_VALUE\ngroup by A.HASH_VALUE\nhaving count(A.HASH_VALUE) > 1)  and op = 'U';\n\n\nupdate cdp_stg_dwh.sisaxis_seguros_cdc_incremental set rec_crt_dtm=stg_ods_src.rec_crt_dtm,seq_id=stg_ods_src.seq_id from \n(select op,rec_crt_dtm,seq_id,\nmd5(nvl(sseguro||'','')||nvl(cmodali||'','')||nvl(ccolect||'','')||nvl(ctipseg||'','')||nvl(casegur||'','')||nvl(cagente||'','')||nvl(cramo||'','')||nvl(npoliza||'','')||nvl(ncertif||'','')||nvl(nsuplem||'','')||nvl(fefecto||'','')||nvl(creafac||'','')||nvl(ctarman||'','')||nvl(cobjase||'','')||nvl(ctipreb||'','')||nvl(cactivi||'','')||nvl(ccobban||'','')||nvl(ctipcoa||'','')||nvl(ctiprea||'','')||nvl(crecman||'','')||nvl(creccob||'','')||nvl(ctipcom||'','')||nvl(fvencim||'','')||nvl(femisio||'','')||nvl(fanulac||'','')||nvl(fcancel||'','')||nvl(csituac||'','')||nvl(cbancar||'','')||nvl(ctipcol||'','')||nvl(fcarant||'','')||nvl(fcarpro||'','')||nvl(fcaranu||'','')||nvl(cduraci||'','')||nvl(nduraci||'','')||nvl(nanuali||'','')||nvl(iprianu||'','')||nvl(cidioma||'','')||nvl(nfracci||'','')||nvl(cforpag||'','')||nvl(pdtoord||'','')||nvl(nrenova||'','')||nvl(crecfra||'','')||nvl(tasegur||'','')||nvl(creteni||'','')||nvl(ndurcob||'','')||nvl(sciacoa||'','')||nvl(pparcoa||'','')||nvl(npolcoa||'','')||nvl(nsupcoa||'','')||nvl(tnatrie||'','')||nvl(pdtocom||'','')||nvl(prevali||'','')||nvl(irevali||'','')||nvl(ncuacoa||'','')||nvl(nedamed||'','')||nvl(crevali||'','')||nvl(cempres||'','')||nvl(cagrpro||'','')||nvl(nsolici||'','')||nvl(intpres||'','')||nvl(fimpsol||'','')||nvl(nmescob||'','')||nvl(sproduc||'','')||nvl(ccompani||'','')||nvl(nparben||'','')||nvl(nbns||'','')||nvl(ctramo||'','')||nvl(cindext||'','')||nvl(pdispri||'','')||nvl(idispri||'','')||nvl(cimpase||'','')||nvl(cagecob||'','')||nvl(csolici||'','')||nvl(cnatrie||'','')||nvl(pdtoaseg||'','')||nvl(cnotibaja||'','')||nvl(ccartera||'','')||nvl(cagencorr||'','')||nvl(cmigra||'','')||nvl(cmonseg||'','')||nvl(clinneg||'','')||nvl(cagrseg||'','')||nvl(iprianuseg||'','')||nvl(irevaliseg||'','')||nvl(fcambio||'','')||nvl(crfaage||'','')||nvl(nsuppol||'','')||nvl(npropm||'','')||nvl(cflota||'','')||nvl(creserva||'',''))\n AS hashvalue, row_number() over ( partition by hashvalue order by rec_crt_dtm,seq_id desc)rnk\nfrom cdp_stg_dwh.sisaxis_seguros) stg_ods_src\ninner JOIN cdp_stg_dwh.sisaxis_seguros_cdc_incremental tgt_ods\nON tgt_ods.hash_value = stg_ods_src.hashvalue\nwhere tgt_ods.op ='U' and stg_ods_src.rnk=1 ;\n\n\nunload ('select op,sseguro,cmodali,ccolect,ctipseg,casegur,cagente,cramo,npoliza,ncertif,nsuplem,fefecto,creafac,ctarman,cobjase,ctipreb,cactivi,ccobban,ctipcoa,ctiprea,crecman,creccob,ctipcom,fvencim,femisio,fanulac,fcancel,csituac,cbancar,ctipcol,fcarant,fcarpro,fcaranu,cduraci,nduraci,nanuali,iprianu,cidioma,nfracci,cforpag,pdtoord,nrenova,crecfra,tasegur,creteni,ndurcob,sciacoa,pparcoa,npolcoa,nsupcoa,tnatrie,pdtocom,prevali,irevali,ncuacoa,nedamed,crevali,cempres,cagrpro,nsolici,intpres,fimpsol,nmescob,sproduc,ccompani,nparben,nbns,ctramo,cindext,pdispri,idispri,cimpase,cagecob,csolici,cnatrie,pdtoaseg,cnotibaja,ccartera,cagencorr,cmigra,cmonseg,clinneg,cagrseg,iprianuseg,irevaliseg,fcambio,crfaage,nsuppol,npropm,cflota,creserva,rec_crt_dtm,seq_id\n from  cdp_stg_dwh.sisaxis_seguros_cdc_incremental order by sseguro, op, rec_crt_dtm,seq_id')\nto 's3://$$S3_Bucket_Name/consolidated-files-history-CDC/sisaxis_seguros_cdc/SISAXIS_SEGUROS_CDC' IAM_ROLE '$$AWS_IAM_ROLE'\nCSV DELIMITER AS '|' PARALLEL OFF HEADER gzip allowoverwrite NULL AS '\\0';"
    }
]