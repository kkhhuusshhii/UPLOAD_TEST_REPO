[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select ref_cd,ref_cd_desc,ref_cd_variant_id,ref_alt_val,mkt_ref_cd, mkt_cd_desc,mkt_ref_cd_variant_id,\nmkt_ref_alt_val, gbl_ref_cd, gbl_ref_cd_desc,gbl_trgt_ref_cd_variant_id,type_cd,sys_cd,ref_data_set_cd,\nrec_eff_dtm,rec_exp_dtm\nfrom\n(\nselect src3.ref_cd,src3.ref_cd_desc,src3.ref_cd_variant_id,src3.ref_alt_val,src3.mkt_ref_cd, src3.mkt_cd_desc,src3.mkt_ref_cd_variant_id,\nsrc3.mkt_ref_alt_val,gbl.ref_cd as gbl_ref_cd, gbl.ref_cd_desc as gbl_ref_cd_desc,src3.gbl_trgt_ref_cd_variant_id,src3.type_cd,src3.sys_cd,src3.ref_data_set_cd,\nsrc3.rec_eff_dtm,src3.rec_exp_dtm\nfrom \n(\nselect src2.ref_cd, src2.ref_cd_desc,src2.ref_cd_variant_id,src2.ref_alt_val,src2.mkt_ref_cd, src2.mkt_cd_desc,src2.trgt_ref_cd_variant_id as mkt_ref_cd_variant_id,\nsrc2.mkt_ref_alt_val,map2.trgt_ref_cd_variant_id as gbl_trgt_ref_cd_variant_id,src2.type_cd,src2.sys_cd,src2.ref_data_set_cd,src2.rec_eff_dtm,src2.rec_exp_dtm\nfrom \n(\nselect src.ref_cd, src.ref_cd_desc,src.ref_cd_variant_id,src.ref_alt_val as ref_alt_val,mkt.ref_cd as mkt_ref_cd, mkt.ref_cd_desc as mkt_cd_desc,mkt.ref_alt_val as mkt_ref_alt_val,\nsrc.trgt_ref_cd_variant_id,src.type_cd,src.sys_cd,src.ref_data_set_cd,src.rec_eff_dtm,src.rec_exp_dtm\nfrom \n(\nselect A.ref_cd,A.ref_cd_desc,A.ref_cd_variant_id,A.ref_alt_val,map.trgt_ref_cd_variant_id,A.type_cd,A.sys_cd,A.ref_data_set_cd,\nA.rec_eff_dtm,A.rec_exp_dtm\nfrom cdp_rdm.TREFERENCECODEVARIANT A \nleft join cdp_rdm.TREFERENCEMAPVARIANT map on ref_cd_variant_id=map.src_ref_cd_variant_id and map.ref_data_set_cd='market' \nAND map.ltst_rec_ind='Y'\nwhere (A.sys_cd = 'axis' /*OR A.sys_cd='penta'*/\n)\nAND A.ltst_rec_ind='Y'\n) src\nLeft Join cdp_rdm.TREFERENCECODEVARIANT mkt on src.trgt_ref_cd_variant_id=mkt.ref_cd_variant_id\n)src2\nleft join cdp_rdm.TREFERENCEMAPVARIANT map2 on src2.trgt_ref_cd_variant_id=map2.src_ref_cd_variant_id and map2.ref_data_set_cd='global'\n)src3\nleft join cdp_rdm.TREFERENCECODEVARIANT gbl on src3.gbl_trgt_ref_cd_variant_id=gbl.ref_cd_variant_id\n)FINAL_SRC"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[3].dataAdapter.oprRuntimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "DELETE from cdp_stg_dwh.stg_tref_code_map_variant where src_sys_cd='axis';"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[3].dataAdapter.oprRuntimeAttributes.attributes[15]",
        "name": "Post-sql",
        "value": "CALL cdp_stg_dwh.sp_reference_code_duplication_handling();"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[3].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "DELETE from cdp_stg_dwh.stg_tref_code_map_variant where src_sys_cd='axis';"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[3].dataAdapter.runtimeAttributes.attributes[15]",
        "name": "Post-sql",
        "value": "CALL cdp_stg_dwh.sp_reference_code_duplication_handling();"
    }
]