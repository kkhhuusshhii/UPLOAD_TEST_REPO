[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "SELECT\ndistinct \nreference_table_type_name,\nsystem_code,\nsrc_ref_cd_variant_id,\ntgt_ref_cd_variant_id,\nref_data_set_cd,\nLKP_MAXSID.MAX_SID as MAX_SID\nFROM\n(SELECT\ndistinct \ncast(SRC1.reference_table_type_name as CHAR(200)) as reference_table_type_name,\ncast(SRC1.system_code as CHAR(200)) as system_code,\n(TRCV_SRC1.ref_cd_variant_id) AS src_ref_cd_variant_id,\n(TRCV_MKT1.ref_cd_variant_id) AS tgt_ref_cd_variant_id,\ncast(SRC1.system_code as CHAR(200)) AS ref_data_set_cd,\n1 as dummy\nFROM\n(SELECT \nDISTINCT\nreference_table_type_name,\n'market' as system_code,\nsource_system_code,\nsource_ref_code,\n'market' as market_system_code,\n market_ref_code \n FROM cdp_rdm.STG_TREFERENCEMAPVARIANT) SRC1\n LEFT JOIN cdp_rdm.TREFERENCECODEVARIANT TRCV_SRC1\n ON SRC1.reference_table_type_name=TRCV_SRC1.TYPE_CD\n AND SRC1.source_system_code = TRCV_SRC1.SYS_CD\n AND SRC1.source_ref_code = TRCV_SRC1.ref_cd\n AND TRCV_SRC1.LTST_REC_IND = 'Y'\n LEFT JOIN cdp_rdm.TREFERENCECODEVARIANT TRCV_MKT1\n ON SRC1.reference_table_type_name=TRCV_MKT1.TYPE_CD\n AND SRC1.market_system_code = TRCV_MKT1.SYS_CD\n AND SRC1.market_ref_code = TRCV_MKT1.ref_cd\n AND TRCV_MKT1.LTST_REC_IND = 'Y'\n  \n UNION\n \nSELECT\ndistinct \ncast(SRC2.reference_table_type_name as CHAR(200)) as reference_table_type_name,\ncast(SRC2.global_system_code as CHAR(200)) as system_code,\n(TRCV_MKT2.ref_cd_variant_id ) AS src_ref_cd_variant_id,\n(TRCV_GLB2.ref_cd_variant_id ) AS tgt_ref_cd_variant_id,\ncast(SRC2.global_system_code as CHAR(200)) AS ref_data_set_cd,\n1 as dummy\nFROM\n(SELECT \nDISTINCT\nreference_table_type_name,\n'market' as market_system_code,\n market_ref_code,\n'global' as global_system_code,\n global_ref_code \n FROM cdp_rdm.STG_TREFERENCEMAPVARIANT) SRC2\n LEFT JOIN cdp_rdm.TREFERENCECODEVARIANT TRCV_MKT2\n ON SRC2.reference_table_type_name=TRCV_MKT2.TYPE_CD\n AND SRC2.market_system_code = TRCV_MKT2.SYS_CD\n AND SRC2.market_ref_code = TRCV_MKT2.ref_cd\n AND TRCV_MKT2.LTST_REC_IND = 'Y'\n LEFT JOIN cdp_rdm.TREFERENCECODEVARIANT TRCV_GLB2\n ON SRC2.reference_table_type_name=TRCV_GLB2.TYPE_CD\n AND SRC2.global_system_code = TRCV_GLB2.SYS_CD\n AND SRC2.global_ref_code = TRCV_GLB2.ref_cd\n AND TRCV_GLB2.LTST_REC_IND = 'Y'\n )SRC left join\n(select 1 as dummy, max(ref_map_variant_id) as MAX_SID from cdp_rdm.TREFERENCEMAPVARIANT) LKP_MAXSID\non SRC.dummy = LKP_MAXSID.dummy\n ORDER BY reference_table_type_name, system_code,src_ref_cd_variant_id,tgt_ref_cd_variant_id--"
    }
]