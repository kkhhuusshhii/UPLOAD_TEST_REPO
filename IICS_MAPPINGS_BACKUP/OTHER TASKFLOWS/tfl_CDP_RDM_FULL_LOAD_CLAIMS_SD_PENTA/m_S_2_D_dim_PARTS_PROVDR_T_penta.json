[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select\nsrc_sys_cd,\nprovdr_name,\nprovdr_id,\nprovdr_type_cd,\nprovdr_type_desc,\nprovdr_rut_num,\nactv_rec_ind,\nMAX_SID\nfrom\n(\nselect\nsrc.src_sys_cd,\nsrc.provdr_name,\nsrc.provdr_id,\ncast(src.provdr_type_cd as varchar(10)) as provdr_type_cd ,\ncast(src.provdr_type_desc as varchar(80)) as provdr_type_desc,\nsrc.provdr_rut_num,\n'Y' as actv_rec_ind,\nLKP_MAXSID.MAX_SID,\nrow_number() over (partition by src.provdr_id order by src.fecha_modif_alta_reg desc) as row_cnt\nfrom\n(\nselect\ndistinct \ncast('penta' as varchar(10)) as src_sys_cd,\ncast(rsin.rut_suc_taller as integer) as provdr_id,\ncast(rsin.razon_social as varchar(100)) as provdr_name,\ncast(snsgrl.tip_pro_taller as varchar(10)) as provdr_type_cd, \ncast(RDM.ref_desc as varchar(80)) as provdr_type_desc,\ncast(rsin.rut_suc_taller as varchar(35)) as provdr_rut_num,\nrsin.fecha_modif_alta_reg,\n1 as dummy\nfrom \n(select rut_suc_taller,razon_social,fecha_modif_alta_reg from cdp_ods.bd_sinie_x_rsin_sucursal_taller where tipo in(1,3)) rsin \nleft join \ncdp_ods.snsmst_snsgrl_tallerprov snsgrl\non rsin.rut_suc_taller=snsgrl.rut_taller\n/*Added this code as a part of DID-53*/\nleft join  \n(select ref_cd,ref_desc from cdp_stg_dwh.stg_tref_code_map_variant \nwhere ref_type_cd='partsprovider_type' and src_sys_cd = 'penta') RDM\non trim(RDM.ref_cd)=trim(cast(cast(snsgrl.tip_pro_taller as int) as varchar(10)))\n) src\nleft join\n(select 1 as dummy, max(dim_parts_provdr_key) as MAX_SID from cdp_dwh.dim_parts_provdr_t) LKP_MAXSID\non src.dummy = LKP_MAXSID.dummy\n) where row_cnt = 1"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[1].dataAdapter.object.customQuery",
        "value": "select src.dim_parts_provdr_key,src.src_sys_cd,src.provdr_id from cdp_dwh.dim_parts_provdr_t src where src.src_sys_cd='penta'"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[4].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "delete from cdp_dwh.dim_parts_provdr_t where src_sys_cd='penta';\ncommit;"
    }
]