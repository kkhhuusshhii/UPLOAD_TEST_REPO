[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "SELECT \n        fact_renovaciones_integrado_key ,\n        src_sys_cd ,\n        policy_num ,\n        policy_item_num ,\n\t\tpolicy_item_id ,\n        policy_status_desc ,\n        policy_eff_dt ,\n        policy_exp_dt ,\n        policy_issue_dt ,\n        acct_mth ,\n        acct_yr ,\n        agreement ,\n        coins_type_cd ,\n        policy_curr_cd ,\n        dim_branch_office_key ,\n        dim_broker_key ,\n        dim_insured_key ,\n        dim_lob_key ,\n        dim_policyholder_key ,\n        dim_prd_pln_hrchy_key ,\n        facult_prem_amt ,\n        facult_ind ,\n        fleet_ind ,\n        broker_comm_amt ,\n        gwp_amt ,\n        rec_crt_dtm ,\n        rec_updt_dtm ,\n        actv_rec_ind ,\n        etl_audit_id ,\n        document_type ,\n        sales_type ,\n        valid_ind ,\n        affects_direct_premium_amt ,\n        exempt_direct_premium_amt ,\n        new_direct_premium_amt ,\n        renewal_direct_premium_amt ,\n        endorsement_direct_premium_amt,\n        next_policy ,\n        previous_policy ,\n        item_renovated_ind ,\n        cycle_number ,\n        cycle_state ,\n        renovation_type ,\n        plate_number ,\n        insured_rut_num ,\n        policyholder_rut_num ,\n        Lob_mkt_ref_code ,\n        mv_id ,\n        mv_reason_cd ,\n        mv_reason_desc ,\n        branch_office_name ,\n        broker_name ,\n        insured_name ,\n        lob_desc ,\n        policyholder_name ,\n        prd_desc ,\n        broker_rut_num ,\n        lob_cd ,\n        pln_cd ,\n        address_desc_insured,\n        comuna_name_insured,\n        region_name_insured,\n        address_desc_policyholder,\n        comuna_name_policyholder,\n        region_name_policyholder,\n\t\tcoaseguro\n\nFROM\n    (\n        SELECT\n            fact.fact_renovaciones_integrado_key ,\n            fact.src_sys_cd ,\n            fact.policy_num ,\n            fact.policy_item_num,\n            fact.policy_item_id ,\n            fact.policy_status_desc ,\n            fact.policy_eff_dt ,\n            fact.policy_exp_dt ,\n            fact.policy_issue_dt ,\n            fact.acct_mth ,\n            fact.acct_yr ,\n            fact.agreement ,\n            fact.coins_type_cd ,\n            fact.policy_curr_cd ,\n            fact.dim_branch_office_key ,\n            fact.dim_broker_key ,\n            fact.dim_insured_key ,\n            fact.dim_lob_key ,\n            fact.dim_policyholder_key ,\n            fact.dim_prd_pln_hrchy_key ,\n            fact.facult_prem_amt ,\n            fact.facult_ind ,\n            fact.fleet_ind ,\n            fact.broker_comm_amt ,\n            fact.gwp_amt ,\n            fact.rec_crt_dtm ,\n            fact.rec_updt_dtm ,\n            fact.actv_rec_ind ,\n            fact.etl_audit_id ,\n            fact.document_type ,\n            fact.sales_type ,\n            fact.valid_ind ,\n            fact.affects_direct_premium_amt ,\n            fact.exempt_direct_premium_amt ,\n            fact.new_direct_premium_amt ,\n            fact.renewal_direct_premium_amt ,\n            fact.endorsement_direct_premium_amt ,\n            fact.next_policy ,\n            fact.previous_policy ,\n            fact.item_renovated_ind ,\n            fact.cycle_number ,\n            fact.cycle_state ,\n            fact.renovation_type ,\n            fact.plate_number ,\n            fact.insured_rut_num ,\n            fact.policyholder_rut_num ,\n            fact.Lob_mkt_ref_code ,\n            fact.mv_id ,\n            fact.mv_reason_cd ,\n            fact.mv_reason_desc ,\n            branch.branch_office_name ,\n            broker.broker_name ,\n            insured.insured_name ,\n            lob.lob_desc ,\n            policyholder.policyholder_name ,\n            prd_pln.prd_desc ,\n            broker.broker_rut_num,\n            lob.lob_cd,\n            prd_pln.pln_cd,\n            insured.address_desc as address_desc_insured,\n            insured.comuna_name as comuna_name_insured,\n            insured.region_name as region_name_insured,\n            policyholder.address_desc as address_desc_policyholder,\n            policyholder.comuna_name as comuna_name_policyholder,\n            policyholder.region_name as region_name_policyholder,\n\t\t\tstg.ref_desc as coaseguro\n        FROM\n            cdp_dwh.fact_renovaciones_integrado_t fact\n        LEFT JOIN\n            cdp_dwh.dim_branch_office_t branch\n        ON\n            fact.dim_branch_office_key=branch.dim_branch_office_key\n        LEFT JOIN\n            cdp_dwh.dim_broker_t broker\n        ON\n            fact.dim_broker_key=broker.dim_broker_key\n        LEFT JOIN\n            cdp_dwh.dim_insured_t insured\n        ON\n            fact.dim_insured_key=insured.dim_insured_key\n        LEFT JOIN\n            cdp_dwh.dim_lob_t lob\n        ON\n            fact.dim_lob_key=lob.dim_lob_key\n        LEFT JOIN\n            cdp_dwh.dim_policyholder_t policyholder\n        ON\n            fact.dim_policyholder_key=policyholder.dim_policyholder_key\n        LEFT JOIN\n            cdp_dwh.dim_prd_pln_hrchy_t prd_pln\n        ON\n            fact.dim_prd_pln_hrchy_key=prd_pln.dim_prd_pln_hrchy_key\n\t\t\t\n\t\tleft  join cdp_stg_dwh.stg_tref_code_map_variant stg\n              on stg.ref_type_cd = 'cod_tipo_coaseguro' \n             and stg.src_sys_cd = 'penta' \n             and fact.coins_type_cd = stg.ref_cd\n        WHERE\n            fact.acct_yr >='2019'\n        AND fact.src_sys_cd='penta');"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "delete from cdp_dwh.fact_renovaciones_integrado_t_powerbi where src_sys_cd='penta';"
    }
]