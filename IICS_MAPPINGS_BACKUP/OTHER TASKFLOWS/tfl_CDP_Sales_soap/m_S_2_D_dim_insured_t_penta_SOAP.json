[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select\ncast(max_sid as integer) as max_sid,\ncast(src_sys_cd as varchar(10)) as src_sys_cd,\ncast(insured_id as varchar(35)) as insured_id,\ncast(address_id as integer) as address_id,\ncast(insured_name as varchar(150)) as insured_name, \ncast(gender_cd as varchar(10)) as gender_cd,\ncast(gender_desc as varchar(80)) as gender_desc,\nbirth_dt,\ncast(address_desc as varchar(150)) as address_desc,\ncast(postal_cd as varchar(10)) as postal_cd,\ncast(region_cd as varchar(10)) as region_cd,\ncast(region_name as varchar(100)) as region_name,\ncast(comuna_cd as varchar(10)) as comuna_cd,\ncast(comuna_name as varchar(100)) as comuna_name,\ncast(city_cd as varchar(10)) as city_cd,\ncast(city_name as varchar(35)) as city_name,\ncast(insured_rut_num as varchar(35)) as insured_rut_num,\ncast(actv_rec_ind as varchar(1)) as actv_rec_ind,\ncast(etl_audit_id as integer) as etl_audit_id\nfrom(\nselect \nLKP_MAXSID.MAX_SID AS MAX_SID,\nsrc.* from \n(\n(select distinct \ncast('penta' as varchar(10)) as src_sys_cd,\n0 as insured_id,\ncast(0 as integer)  as address_id,\nstg_informeventas.insured_name, \nnull as gender_cd ,\nnull as gender_desc,\ncast(null as date) as birth_dt,\nnull as address_desc,\nnull as postal_cd,\nnull as region_cd,\nnull as region_name,\nnull as comuna_cd,\nnull as comuna_name,\nnull as city_cd,\nnull as city_name,\nstg_informeventas.insured_rut_num,\n'Y' as actv_rec_ind,\ncast(0 as integer) as etl_audit_id,\n1 as DUMMY\nfrom (SELECT distinct \nrut_asegurado as insured_rut_num,trim(nombre_asegurado) as insured_name\n FROM cdp_stg_dwh.stg_informeventas WHERE trim(codigo_ramo)='24') stg_informeventas\nwhere insured_rut_num not in \n(select distinct insured_rut_num from cdp_dwh.dim_insured_t where src_sys_cd='penta')\n) src\nleft outer join\n(select 1 as dummy, max(dim_insured_key) as MAX_SID from cdp_dwh.dim_insured_t) LKP_MAXSID\non src.dummy = LKP_MAXSID.dummy)\n)"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.oprRuntimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "DELETE FROM CDP_DWH.dim_insured_t\nWHERE src_sys_cd='penta' and etl_audit_id=0;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "DELETE FROM CDP_DWH.dim_insured_t\nWHERE src_sys_cd='penta' and etl_audit_id=0;"
    }
]