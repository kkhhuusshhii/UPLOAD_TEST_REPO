[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select SSEGURO,\n\t\tPOLIZA,\n\t\tITEM,\n\t\tCRAMO,\n\t\tID_SUCURSAL,\n               policy_issue_date ,\n              ASEGURADO_RUT,\n\t\tmax_sid\nfrom\n(\nselect SSEGURO,\n\t\tPOLIZA,\n\t\tITEM,\n\t\tCRAMO,\n\t\tID_SUCURSAL,\n                policy_issue_date ,\n                ASEGURADO_RUT,\n\t\trow_number()over(partition by src.SSEGURO order by src.policy_issue_date desc ) as row_cnt,\n\t\tLKP_MAX_KEY.max_sid\nfrom\n(SELECT DISTINCT\nT1.ITE_INT_POLIZA   || '-' || T1.ITE_SMA_ITEM AS SSEGURO,\n\t\tT1.ITE_INT_POLIZA AS POLIZA,\n\t\tT1.ITE_SMA_ITEM AS ITEM,\n\t\tT1.ITE_SMA_RAMO  AS CRAMO,\n\t\tT3.pol_tin_oficin as ID_SUCURSAL,\n\t\tT1.ite_fec_ingres as policy_issue_date,\n                T1.ITE_INT_RUTASE AS ASEGURADO_RUT\nFROM\tcdp_ods.bd_produ_x_pro_item  T1\nINNER JOIN cdp_ods.bd_produ_x_pro_primas T2 ON T1.ITE_INT_POLIZA = T2.PRI_INT_POLIZA AND T1.ITE_SMA_ITEM = T2.PRI_SMA_ITEM\nINNER JOIN cdp_ods.bd_produ_x_pro_poliza T3 ON T1.ITE_INT_POLIZA = T3.pol_int_poliza\nWHERE\tT1.ITE_SMA_RAMO = 9\nAND\t\tT1.ITE_SMA_ITEM > 0\nAND\t\tT1.ITE_INT_POLIZA NOT IN (11000327,11000792,11001199,11002786,11002787,31025690,60048158)\nAND\t\tT1.ITE_FEC_VIGDES >= '2010-01-01 00:00:00'\n--AND\t\tT1.ITE_FEC_VIGDES < &FECHA_FIN\nAND\t\tT1.ITE_DEC_BRUITE > 0\nORDER BY POLIZA, ITEM)src\nleft outer join \n(select 1 dummy,max(base_penta_key) max_sid  from  cdp_stg_dwh.base_penta) LKP_MAX_KEY\non LKP_MAX_KEY.dummy=1)\nwhere SSEGURO is not null and row_cnt=1"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.BASE_PENTA; "
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[2].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.BASE_PENTA;\ncommit;"
    }
]