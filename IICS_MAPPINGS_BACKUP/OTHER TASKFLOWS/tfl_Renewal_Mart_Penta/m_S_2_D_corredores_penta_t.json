[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select SSEGURO,\n\t\tCORREDOR_RUT,\n\t\tNUM_NEG ,\n\t\tCORREDOR,\n\t\tmax_sid\nfrom\n(select SSEGURO,\n\t\tCORREDOR_RUT,\n\t\tNUM_NEG ,\n\t\tCORREDOR,\n\t\trow_number()over(partition by SRC.SSEGURO order by SRC.rec_crt_dtm desc ) as row_cnt,\n\t\tLKP_MAX_KEY.max_sid \n\t\tfrom\n(\n\n\nSELECT    T1.POLIZA  || '-' || T1.ITEM AS SSEGURO,\n\t\tT2.POL_INT_RUTCOR AS CORREDOR_RUT,\n\t\tT2.POL_INT_NEGOCI AS NUM_NEG,\n  \t\tT3.AGT_NOMBRE AS CORREDOR,\n  \t\tT1.policy_issue_date as rec_crt_dtm\nFROM\tcdp_stg_dwh.BASE_PENTA T1\nLEFT JOIN cdp_ods.bd_produ_x_pro_poliza T2\nON T1.POLIZA = T2.POL_INT_POLIZA\nLEFT JOIN cdp_ods.agtmst_grlagt_agentes T3\nON T2.POL_INT_RUTCOR = T3.AGT_RUT\n\n) SRC\nleft outer join \n(select 1 dummy,max(corredores_penta_key) max_sid  from  cdp_stg_dwh.corredores_penta ) LKP_MAX_KEY\non LKP_MAX_KEY.dummy=1)\nwhere SSEGURO is not null and row_cnt=1"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.CORREDORES_PENTA;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[2].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.CORREDORES_PENTA;\ncommit;"
    }
]