[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select SSEGURO,COD_ENDOSO,ENDOSO_AGRUP\n\t\t,max_sid \nfrom\n(\n\nselect SSEGURO,COD_ENDOSO,\nCASE WHEN COD_ENDOSO IN (0) THEN  'NUEVA PROD'\n     WHEN  COD_ENDOSO IN (310,320,330,340,350,360,370,120) THEN  'CANCELACION'\n     WHEN  COD_ENDOSO IN (210,220,230,240,250,260) THEN 'ANULACION'\n     WHEN COD_ENDOSO IN (410,420,430,450) THEN  'REHABILITACION'\n     ELSE 'NO CLASIFICADO' END AS ENDOSO_AGRUP,\n     row_number()over(partition by SRC.SSEGURO order by SRC.rec_crt_dtm desc ) as row_cnt,\n\t\tLKP_MAX_KEY.max_sid \n\t\tfrom\n(\nSELECT    T1.POLIZA  || '-' || T1.ITEM AS SSEGURO,\n\t  T2.PRO_SMA_TIPO AS COD_ENDOSO ,\n\t  -- as ENDOSO_AGRUP,\n\t  T1.policy_issue_date as rec_crt_dtm\nFROM   cdp_stg_dwh.base_penta T1 , cdp_ods.bd_produ_x_pro_prodmes T2\nWHERE  T1.POLIZA = T2.PRO_INT_POLIZA\nAND T1.ITEM = T2.PRO_SMA_ITEM\nAND T2.PRO_INT_ENDOSO = (\n                SELECT MAX(C.PRO_INT_ENDOSO)  \n\t\tFROM cdp_ods.bd_produ_x_pro_prodmes C\n\t\tWHERE T1.POLIZA = C.PRO_INT_POLIZA\n\t\tAND T1.ITEM  = C.PRO_SMA_ITEM\n\t\tAND C.PRO_SMA_TIPO NOT IN (10,20,30,40,50,910,510,550,100,140,60,150,520,530,540,560,650,710,810,999))\n)src\nleft outer join \n(select 1 dummy,max(ENDOSOS_PENTA_key) max_sid  from  cdp_stg_dwh.ENDOSOS_PENTA) LKP_MAX_KEY\non LKP_MAX_KEY.dummy=1)\nwhere SSEGURO is not null and row_cnt=1"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.ENDOSOS_PENTA;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[2].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.ENDOSOS_PENTA;\ncommit;"
    }
]