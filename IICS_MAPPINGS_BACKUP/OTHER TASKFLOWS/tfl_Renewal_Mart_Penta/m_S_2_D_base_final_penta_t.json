[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "SELECT SSEGURO,\n\t\tPOLIZA,\n\t\tITEM,\n\t\tCRAMO,\n\t\tASEGURADO_RUT,\n\t\tID_SUCURSAL,\n\t\tINI_VIG,\n\t\tFIN_VIG_ORIG,\n\t\tFIN_VIG_ACT,\n\t\tDIAS_VIGENTE,\n\t\tDIAS_SUSCRITOS,\n\t\tVEH_CMARCA,\n\t\tVEH_CMODELO,\n\t\tVEH_CLASE,\n\t\tUSO,\n\t\tVEH_ANO,\n\t\tPATENTE,\n\t\tVEH_CTIPO,\n\t\tVEH_TIPO,\n\t\tTMARCA,\n\t\tTMODELO,\n\t\tNUM_MOTOR,\n\t\tCORREDOR_RUT,\n\t\tCORREDOR,\n\t\tNUM_NEG,\n\t\tCOD_PRODUCTO,\n\t\tPRODUCTO,\n\t\tCOD_PLAN,\n\t\tPLAN,\n\t\tCONTRATANTE_RUT,\n\t\tCONTRATANTE_NOMBRE,\n\t\tNRO_MASIVO,\n\t\tDEDUCIBLE,\n\t\tFLOTA,\n\t\tPRIMA,\n\t\tCOMISION,\n\t\tCOD_ENDOSO,\n\t\tENDOSO_AGRUP,\n\t\tCOB_PLAN,\n\t\tORIGEN,\n                max_sid\nfrom\n(SELECT T1.SSEGURO,\n\t\tT1.POLIZA,\n\t\tT1.ITEM,\n\t\tT1.CRAMO,\n\t\tT1.ASEGURADO_RUT,\n\t\tT1.ID_SUCURSAL,\n\t\tT2.INI_VIG,\n\t\tT2.FIN_VIG_ORIG,\n\t\tT2.FIN_VIG_ACT,\n\t\tT2.DIAS_VIGENTE,\n\t\tT2.DIAS_SUSCRITOS,\n\t\tT4.VEH_CMARCA,\n\t\tT4.VEH_CMODELO,\n\t\tT4.VEH_CLASE,\n\t\tT4.USO,\n\t\tT4.VEH_ANO,\n\t\tT4.PATENTE,\n\t\tT4.VEH_CTIPO,\n\t\tT4.VEH_TIPO,\n\t\tT4.TMARCA,\n\t\tT4.TMODELO,\n\t\tT4.NUM_MOTOR,\n\t\tT5.CORREDOR_RUT,\n\t\tT5.CORREDOR,\n\t\tT5.NUM_NEG,\n\t\tT6.COD_PRODUCTO,\n\t\tT6.PRODUCTO,\n\t\tT6.COD_PLAN,\n\t\tT6.PLAN,\n\t\tT8.CONTRATANTE_RUT,\n\t\tT8.CONTRATANTE_NOMBRE,\n\t\tT8.NRO_MASIVO,\n\t\tT8.DEDUCIBLE,\n\t\tCASE WHEN COD_PRODUCTO IN (20163,20372,20385,20387,20388) \n        OR CONTRATANTE_RUT IN (76110960,76115928,76179107,76247229,76337693,76411482,76477160,76491522,76747300,76761540,76947190,77919930,77982160,94666000,96667660,96861280,96912590,96988330,97053000,99542780,99557070,99560130)\n\tOR\tNUM_NEG IN (125,205,206,207,208,209,210,312,320,321,322,513,514,515,517,518,519,520,521,522,523,524,525,526,527,729,1016,1034,1508,1784,1785,1933,1934,1936,1937,1977)\nTHEN 1\nELSE 0 end as FLOTA,\n\t\tT11.PRIMA,\n\t\tT11.COMISION,\n\t\tT12.COD_ENDOSO,\n\t\tT12.ENDOSO_AGRUP,\n\t\tT13.COB_PLAN,\n\t\t'penta' AS ORIGEN\nFROM cdp_stg_dwh.BASE_PENTA T1\nLEFT JOIN cdp_stg_dwh.FECHAS_PENTA T2\nON T1.SSEGURO = T2.SSEGURO\n--LEFT JOIN ASEGURADOS_PENTA T3\n--ON T1.SSEGURO = T3.SSEGURO\nLEFT JOIN cdp_stg_dwh.VEHICULOS_PENTA T4\nON T1.SSEGURO = T4.SSEGURO\nLEFT JOIN cdp_stg_dwh.CORREDORES_PENTA T5\nON T1.SSEGURO = T5.SSEGURO\nLEFT JOIN cdp_stg_dwh.PRODUCTOS_PENTA T6\nON T1.SSEGURO = T6.SSEGURO\n--LEFT JOIN DEDUCIBLES_PENTA T7\n--ON T1.SSEGURO = T7.SSEGURO\nLEFT JOIN cdp_stg_dwh.CONTRATANTES_PENTA T8\nON T1.SSEGURO = T8.SSEGURO\n--LEFT JOIN FLOTA_PENTA T9\n--ON T1.SSEGURO = T9.SSEGURO\n--LEFT JOIN NRO_MASIVOS_PENTA T10\n--ON T1.SSEGURO = T10.SSEGURO\nLEFT JOIN cdp_stg_dwh.PRIMAS_PENTA T11\nON T1.SSEGURO = T11.SSEGURO\nLEFT JOIN cdp_stg_dwh.ENDOSOS_PENTA T12\nON T1.SSEGURO = T12.SSEGURO\nLEFT JOIN cdp_stg_dwh.COBERTURAS_PENTA T13\nON T1.SSEGURO = T13.SSEGURO\n)src\nleft outer join \n(select 1 dummy,max(base_final_penta_key) max_sid  from  cdp_dwh.base_final_penta) LKP_MAX_KEY\non LKP_MAX_KEY.dummy=1\nwhere SSEGURO is not null"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_dwh.BASE_FINAL_PENTA;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[2].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_dwh.BASE_FINAL_PENTA;\ncommit;"
    }
]