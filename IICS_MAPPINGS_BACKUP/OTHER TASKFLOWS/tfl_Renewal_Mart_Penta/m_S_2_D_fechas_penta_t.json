[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select SSEGURO,\n\t\tINI_VIG,\n\t\tFIN_VIG_ORIG,\n\t\tFIN_VIG_ACT,\n\t\tdatediff(days,INI_VIG,FIN_VIG_ACT)as DIAS_VIGENTE,\n\t\tdatediff(days,INI_VIG,FIN_VIG_ORIG) as DIAS_SUSCRITOS,\n\t\tmax_sid\nfrom \n(select SSEGURO,\n\t\tINI_VIG,\n\t\tFIN_VIG_ORIG,\n\t\tFIN_VIG_ACT,\n\t\trow_number()over(partition by src.SSEGURO order by src.policy_issue_date desc ) as row_cnt,\n\t\tLKP_MAX_KEY.max_sid\nfrom\n(SELECT    T1.POLIZA  || '-' || T1.ITEM AS SSEGURO,\n\t\tDATE(T3.PRO_FEC_VIGDES) AS INI_VIG,\n\t\tDATE(T3.PRO_FEC_VIGHAS) AS FIN_VIG_ORIG,\n\t\tDATE(T2.ITE_FEC_VIGHAS) AS FIN_VIG_ACT, \n\t\tT1.policy_issue_date\nFROM\tcdp_stg_dwh.BASE_PENTA T1\nLEFT JOIN cdp_ods.bd_produ_x_pro_item  T2\nON T1.POLIZA = T2.ITE_INT_POLIZA\nAND T1.ITEM = T2.ITE_SMA_ITEM\nLEFT JOIN (\n\t\tSELECT\tB1.PRO_INT_POLIZA,\n\t\t\t\tB1.PRO_SMA_ITEM,\n\t\t\t\tB1.PRO_FEC_VIGDES,\n\t\t\t\tB1.PRO_FEC_VIGHAS\n\t\tFROM\tcdp_ods.bd_produ_x_pro_prodmes B1\n\t\tINNER JOIN\n\t\t\t(\n\t\t\tSELECT\tPRO_INT_POLIZA,\n\t\t\t\t\tPRO_SMA_ITEM,\n\t\t\t\t\tMAX(PRO_INT_ENDOSO) AS PRO_INT_ENDOSO,\n\t\t\t\t\tPRO_SMA_TIPO\n\t\t\tFROM\tcdp_ods.bd_produ_x_pro_prodmes\n\t\t\tWHERE\tPRO_TIN_RAMO = 9\n\t\t\tAND\tPRO_SMA_TIPO = 0\n\t\t\tGROUP BY PRO_INT_POLIZA, PRO_SMA_ITEM, PRO_SMA_TIPO\n\t\t\t) B2\n\t\tON B1.PRO_INT_POLIZA = B2.PRO_INT_POLIZA\n\t\tAND B1.PRO_SMA_ITEM = B2.PRO_SMA_ITEM\n\t\tAND B1.PRO_INT_ENDOSO = B2.PRO_INT_ENDOSO\n\t\tAND B1.PRO_SMA_TIPO = B2.PRO_SMA_TIPO\n) T3\nON T1.POLIZA = T3.PRO_INT_POLIZA\nAND T1.ITEM = T3.PRO_SMA_ITEM\n)src\nleft outer join \n(select 1 dummy,max(fechas_penta_key) max_sid  from  cdp_stg_dwh.fechas_penta) LKP_MAX_KEY\non LKP_MAX_KEY.dummy=1)\nwhere SSEGURO is not null and row_cnt=1"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.FECHAS_PENTA;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[2].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.FECHAS_PENTA;\ncommit;"
    }
]