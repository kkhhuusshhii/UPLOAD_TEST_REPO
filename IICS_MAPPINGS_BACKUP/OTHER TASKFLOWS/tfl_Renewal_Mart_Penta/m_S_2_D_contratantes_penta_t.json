[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select SSEGURO,\n\t\tCONTRATANTE_RUT,\n\t\tCONTRATANTE_NOMBRE ,\n\t\tNRO_MASIVO,\n\t\tDEDUCIBLE,\n\t\tmax_sid\nfrom\n(select SSEGURO,\n\t\tCONTRATANTE_RUT,\n\t\tCONTRATANTE_NOMBRE ,\n\t\tNRO_MASIVO,\n\t\tDEDUCIBLE,\n\t\trow_number()over(partition by SRC.SSEGURO order by SRC.rec_crt_dtm desc ) as row_cnt,\n\t\tLKP_MAX_KEY.max_sid \n\t\tfrom\n(\n\nSELECT          T1.POLIZA  || '-' || T1.ITEM AS SSEGURO,\n\t\tT2.ITE_CHA_REFCORR AS NRO_MASIVO,\n\t\tT3.POL_INT_RUTCON AS CONTRATANTE_RUT,\n\t\tT3.POL_CHA_NOMCON AS CONTRATANTE_NOMBRE,\n\t\tT4.ind_indica AS DEDUCIBLE,\n\t\tT1.policy_issue_date as rec_crt_dtm\nFROM\t  BASE_PENTA T1\nLEFT JOIN cdp_ods.bd_produ_x_pro_item  T2 ON T1.POLIZA = T2.ITE_INT_POLIZA AND T1.ITEM = T2.ITE_SMA_ITEM\nLEFT JOIN cdp_ods.bd_produ_x_pro_poliza  T3 ON T1.POLIZA = T3.POL_INT_POLIZA\nLEFT JOIN \n(Select\n                 Distinct\n                 ite_int_poliza,\n                 ite_sma_item,\n                 ind_indica                                       \n           From\n                 cdp_ods.PrdCdg_crp_DeduciblePlan  ,\n                 cdp_ods.GrlMst_gen_indicador      ,\n                 cdp_ods.bd_produ_x_pro_item  \n          Where\n\n                 plan_producto_ramo_IdRamo = 9  And\n                 plan_producto_idProducto  = ite_sma_subramo and\n                 ite_int_prodplan            =  plan_idPlan     and\n                 ite_int_plan_deducible    =  ind_indica     and\n                 ind_tipo                  = 11                    \n) T4\nON T1.POLIZA = T4.ITE_INT_POLIZA\nAND T1.ITEM = T4.ITE_SMA_ITEM\n \n\n) SRC\nleft outer join \n(select 1 dummy,max(contratantes_penta_key) max_sid  from  cdp_stg_dwh.contratantes_penta ) LKP_MAX_KEY\non LKP_MAX_KEY.dummy=1)\nwhere SSEGURO is not null and row_cnt=1"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.CONTRATANTES_PENTA;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[2].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.CONTRATANTES_PENTA;\ncommit;"
    }
]