[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select \nclaim_num,\nclaim_desc,\nsrc_sys_cd,\naccident_desc,\ninspection_desc,\ndim_claim_key,\nactv_rec_ind,\nmax_sid\nfrom \n(\nselect \nsrc.claim_num,\nsrc.claim_desc,\nsrc.src_sys_cd,\nsrc.accident_desc,\nsrc.inspection_desc,\nsrc.dim_claim_key,\nsrc.actv_rec_ind,\nLKP_MAXSID.max_sid,\nrow_number()over(partition by src.claim_num order by src.rec_crt_dtm desc) as row_cnt\nfrom \n(select \ncast ('penta' as varchar(10)) as src_sys_cd,\ncast(c.per_int_sinies as varchar(35)) as claim_num, \ncast(a.texto as varchar(4000)) as claim_desc,\ncast(d.observaciones AS varchar(255)) as inspection_desc,\ncast(c.per_cha_lugar AS varchar(500)) as accident_desc,\ncast(f.dim_claim_key as integer) as dim_claim_key,\ncast('Y' as char(1))as actv_rec_ind,\n1 as dummy,\nc.per_fec_denunc as rec_crt_dtm\nfrom cdp_ods.bd_sinie_x_sin_perfil c\nleft outer join  (select siniestro,listagg(texto, ',') within group (order by linea) as texto from cdp_ods.bd_sinie_x_sin_minutadenuncio\n group by siniestro)a \non c.per_int_sinies=a.siniestro\nleft outer join (select nro_siniestro,listagg(observaciones, ',')  within group (order by id_informe) as observaciones from cdp_ods.bd_sinie_x_rsin_informe_liq\ngroup by nro_siniestro) d\non c.per_int_sinies=d.nro_siniestro\nleft join \n(select dim_claim_key,claim_num from cdp_dwh.dim_claim_t where src_sys_cd='penta') f\non a.siniestro=f.claim_num)src\nleft outer join\n(select 1 as dummy, max(claim_txt_key) as MAX_SID from cdp_dwh.claim_txt_t) LKP_MAXSID\non src.dummy = LKP_MAXSID.dummy) where row_cnt=1 and 1=2"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[1].dataAdapter.object.customQuery",
        "value": "select claim_txt_key,claim_num,src_sys_cd  from cdp_dwh.claim_txt_t where src_sys_cd='penta'"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.oprRuntimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "delete from cdp_dwh.claim_txt_t where src_sys_cd='penta';\ncommit;\n\nINSERT INTO cdp_dwh.claim_txt_t \n(\nclaim_txt_key,\nclaim_num, \nclaim_desc, \nsrc_sys_cd, \naccident_desc,\ninspection_desc,\ndim_claim_key,\nrec_crt_dtm,\nrec_updt_dtm, \nactv_rec_ind, \netl_audit_id)\nselect \n(AA1.MAX_SID+AA1.num) as claim_txt_key,\nAA1.claim_num,\nAA1.claim_desc,\nAA1.src_sys_cd,\nAA1.accident_desc,\nAA1.inspection_desc,\nAA1.dim_claim_key,\nCURRENT_DATE as rec_crt_dtm,\nCURRENT_DATE as rec_updt_dtm,\nAA1.actv_rec_ind,\nAA1.audit_id\nfrom\n(select \nAA.claim_num,\nAA.claim_desc,\nAA.src_sys_cd,\nAA.accident_desc,\nAA.inspection_desc,\nAA.dim_claim_key,\nAA.actv_rec_ind,\nAA.max_sid,\nAA.num,\nAA.dummy,\nca.etl_audit_id as audit_id\nfrom(\nselect \nclaim_num,\nclaim_desc,\nsrc_sys_cd,\naccident_desc,\ninspection_desc,\ndim_claim_key,\nactv_rec_ind,\nmax_sid,\nnum,\ndummy\nfrom\n(\nselect \nsrc.claim_num,\n--src.claim_desc,\nregexp_replace( src.claim_desc, '\\r|\\n') as claim_desc,\nsrc.src_sys_cd,\n--src.accident_desc,\nregexp_replace( src.accident_desc, '\\r|\\n') as accident_desc,\n--src.inspection_desc,\nregexp_replace( src.inspection_desc, '\\r|\\n') as inspection_desc,\nsrc.dim_claim_key,\nsrc.actv_rec_ind,\nLKP_MAXSID.max_sid,\nsrc.dummy,\nrow_number()over(partition by src.claim_num order by src.rec_crt_dtm desc) as row_cnt,\nrow_number() over (order by src.claim_num) num \nfrom \n(select \ncast ('penta' as varchar(10)) as src_sys_cd,\ncast(c.per_int_sinies as varchar(35)) as claim_num, \ncast(a.texto as varchar(4000)) as claim_desc,\ncast(d.observaciones AS varchar(255)) as inspection_desc,\ncast(c.per_cha_lugar AS varchar(500)) as accident_desc,\ncast(f.dim_claim_key as integer) as dim_claim_key,\ncast('Y' as char(1))as actv_rec_ind,\n1 as dummy,\nc.per_fec_denunc as rec_crt_dtm\nfrom cdp_ods.bd_sinie_x_sin_perfil c\nleft outer join  (select siniestro,listagg(texto, ',') within group (order by linea) as texto from cdp_ods.bd_sinie_x_sin_minutadenuncio\ngroup by siniestro)a \non c.per_int_sinies=a.siniestro\nleft outer join (select nro_siniestro,listagg(observaciones, ',')  within group (order by id_informe) as observaciones from cdp_ods.bd_sinie_x_rsin_informe_liq\ngroup by nro_siniestro) d\non c.per_int_sinies=d.nro_siniestro\nleft join \n(select dim_claim_key,claim_num from cdp_dwh.dim_claim_t where src_sys_cd='penta') f\non a.siniestro=f.claim_num)src\nleft outer join\n(select 1 as dummy, cast(nvl(max(claim_txt_key),0) as integer) as MAX_SID from cdp_dwh.claim_txt_t) LKP_MAXSID\non src.dummy = LKP_MAXSID.dummy) where row_cnt=1)AA\nleft join \n  (\n  select distinct etl_audit_id, 1 as dummy from cdp_dwh.dim_claim_analyst_t where src_sys_cd='penta') ca \n  on AA.dummy =ca.dummy \n) AA1;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "delete from cdp_dwh.claim_txt_t where src_sys_cd='penta';\ncommit;\n\nINSERT INTO cdp_dwh.claim_txt_t \n(\nclaim_txt_key,\nclaim_num, \nclaim_desc, \nsrc_sys_cd, \naccident_desc,\ninspection_desc,\ndim_claim_key,\nrec_crt_dtm,\nrec_updt_dtm, \nactv_rec_ind, \netl_audit_id)\nselect \n(AA1.MAX_SID+AA1.num) as claim_txt_key,\nAA1.claim_num,\nAA1.claim_desc,\nAA1.src_sys_cd,\nAA1.accident_desc,\nAA1.inspection_desc,\nAA1.dim_claim_key,\nCURRENT_DATE as rec_crt_dtm,\nCURRENT_DATE as rec_updt_dtm,\nAA1.actv_rec_ind,\nAA1.audit_id\nfrom\n(select \nAA.claim_num,\nAA.claim_desc,\nAA.src_sys_cd,\nAA.accident_desc,\nAA.inspection_desc,\nAA.dim_claim_key,\nAA.actv_rec_ind,\nAA.max_sid,\nAA.num,\nAA.dummy,\nca.etl_audit_id as audit_id\nfrom(\nselect \nclaim_num,\nclaim_desc,\nsrc_sys_cd,\naccident_desc,\ninspection_desc,\ndim_claim_key,\nactv_rec_ind,\nmax_sid,\nnum,\ndummy\nfrom\n(\nselect \nsrc.claim_num,\n--src.claim_desc,\nregexp_replace( src.claim_desc, '\\r|\\n') as claim_desc,\nsrc.src_sys_cd,\n--src.accident_desc,\nregexp_replace( src.accident_desc, '\\r|\\n') as accident_desc,\n--src.inspection_desc,\nregexp_replace( src.inspection_desc, '\\r|\\n') as inspection_desc,\nsrc.dim_claim_key,\nsrc.actv_rec_ind,\nLKP_MAXSID.max_sid,\nsrc.dummy,\nrow_number()over(partition by src.claim_num order by src.rec_crt_dtm desc) as row_cnt,\nrow_number() over (order by src.claim_num) num \nfrom \n(select \ncast ('penta' as varchar(10)) as src_sys_cd,\ncast(c.per_int_sinies as varchar(35)) as claim_num, \ncast(a.texto as varchar(4000)) as claim_desc,\ncast(d.observaciones AS varchar(255)) as inspection_desc,\ncast(c.per_cha_lugar AS varchar(500)) as accident_desc,\ncast(f.dim_claim_key as integer) as dim_claim_key,\ncast('Y' as char(1))as actv_rec_ind,\n1 as dummy,\nc.per_fec_denunc as rec_crt_dtm\nfrom cdp_ods.bd_sinie_x_sin_perfil c\nleft outer join  (select siniestro,listagg(texto, ',') within group (order by linea) as texto from cdp_ods.bd_sinie_x_sin_minutadenuncio\ngroup by siniestro)a \non c.per_int_sinies=a.siniestro\nleft outer join (select nro_siniestro,listagg(observaciones, ',')  within group (order by id_informe) as observaciones from cdp_ods.bd_sinie_x_rsin_informe_liq\ngroup by nro_siniestro) d\non c.per_int_sinies=d.nro_siniestro\nleft join \n(select dim_claim_key,claim_num from cdp_dwh.dim_claim_t where src_sys_cd='penta') f\non a.siniestro=f.claim_num)src\nleft outer join\n(select 1 as dummy, cast(nvl(max(claim_txt_key),0) as integer) as MAX_SID from cdp_dwh.claim_txt_t) LKP_MAXSID\non src.dummy = LKP_MAXSID.dummy) where row_cnt=1)AA\nleft join \n  (\n  select distinct etl_audit_id, 1 as dummy from cdp_dwh.dim_claim_analyst_t where src_sys_cd='penta') ca \n  on AA.dummy =ca.dummy \n) AA1;"
    }
]