[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select\n src_sys_cd,\n policy_id,\n policy_num,\n policy_term_cd,\n policy_term_desc,\n policy_item_count,\n contract_num,\n quot_num,\n policy_issue_dt,\n policy_eff_dt,\n policy_exp_dt,\n contract_desc,\n actv_rec_ind,\n max_sid\n from\n (\nselect\nsrc.src_sys_cd,\nsrc.policy_id,\nsrc.policy_num,\nsrc.policy_term_cd,\nsrc.policy_term_desc,\nsrc.policy_item_count,\nsrc.contract_num,\nsrc.quot_num,\nsrc.policy_issue_dt,\nsrc.policy_eff_dt,\nsrc.policy_exp_dt,\ncontract_desc,\nsrc.actv_rec_ind,\n row_number()over(partition by src.policy_id order by src.policy_issue_dt desc ) as row_cnt,--Need to revisit\nLKP_MAX_KEY.max_sid\nfrom\n(\nselect distinct\ncast('penta' as varchar(10)) as src_sys_cd,\ncast(poliza.pol_int_poliza as integer) as policy_id,\ncast(poliza.pol_int_poliza as varchar(35)) as policy_num,\ncast(null as varchar(10)) as policy_term_cd,\ncast(null as varchar(80)) as policy_term_desc,\ncast(nvl(pol_cnt.policy_item_count,0) as integer) as policy_item_count,\ncast(pro.ite_int_cartera as varchar(35)) as contract_num,\ncast(poliza.pol_int_propneg as varchar(50)) as  quot_num,\ncast(pol_fec_ingres as date) as policy_issue_dt,\ncast(pol_fec_vigdes as date) as policy_eff_dt,\ncast(pol_fec_vighas as date) as policy_exp_dt,\ncast(null as varchar(80)) as contract_desc,\n'Y' as actv_rec_ind\nfrom cdp_ods.bd_produ_x_pro_poliza poliza \nleft join cdp_ods.bd_produ_x_pro_item pro\non poliza.pol_int_poliza=pro.ite_int_poliza\nleft outer join \n(select ite_int_poliza,count(ite_sma_item) policy_item_count from cdp_ods.bd_produ_x_pro_item group by 1) pol_cnt\non poliza.pol_int_poliza=pol_cnt.ite_int_poliza\n) src\nleft outer join\n(select 1 dummy,max(dim_policy_key) max_sid  from  cdp_dwh.dim_policy_t ) LKP_MAX_KEY\non LKP_MAX_KEY.dummy=1)\nwhere policy_id is not null and row_cnt=1"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "delete from cdp_dwh.dim_policy_t where src_sys_cd='penta';"
    }
]