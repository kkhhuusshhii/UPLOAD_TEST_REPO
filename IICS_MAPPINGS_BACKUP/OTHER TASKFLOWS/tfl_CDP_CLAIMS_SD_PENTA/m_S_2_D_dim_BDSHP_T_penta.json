[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "SELECT\nCAST(SRC_PENTA.rut_suc_taller AS INTEGER) AS bdshp_id,\nCAST(SRC_PENTA.razon_social AS VARCHAR(100)) AS TAPELLI,\nCAST(SRC_PENTA.bdshp_network_ind  AS CHAR(1)) AS bdshp_network_ind,\nCAST(SRC_PENTA.bdshp_rut_num   AS VARCHAR(35))AS NNUMNIF,\nCAST(SRC_PENTA.src_sys_cd AS VARCHAR(10)) AS src_sys_cd,\nCAST(SRC_PENTA.bdshp_type_desc AS VARCHAR(80)) AS bdshp_type_desc,\nSRC_PENTA.rec_crt_dtm,\nLKP_2.MAX_SID\nFROM \n(SELECT \nCAST(BB.rut_suc_taller AS INTEGER),\nCAST(BB.razon_social AS VARCHAR(100)),\nNULL AS bdshp_network_ind,\nCAST(RUT_NUM.rut_suc_taller AS VARCHAR(35)) as bdshp_rut_num,\n'penta' as src_sys_cd,\nCASE WHEN UPPER(BB.multimarca_sn)='S' \nTHEN  'Multimarca' ELSE 'Concesionario' \nEND AS bdshp_type_desc,\nBB.fecha_modif_alta_reg AS rec_crt_dtm,  --- Added as part of pents separation due to removal of stage table\n--BB.rec_crt_dtm,\nROW_NUMBER() OVER (PARTITION BY BB.rut_suc_taller,src_sys_cd ORDER BY BB.fecha_modif_alta_reg DESC) AS RNK_1,\n1 AS DUMMY\nFROM cdp_ods.bd_sinie_x_rsin_sucursal_taller AS BB\nLEFT JOIN(\nSELECT DISTINCT SIN_PERFIL.per_int_sinies,RSIN_SUCURSAL.sucursal_taller ,\nRSIN_SUCURSAL.rut_suc_taller\n FROM \n cdp_ods.bd_sinie_x_rsin_sucursal_taller RSIN_SUCURSAL\n INNER JOIN cdp_ods.bd_sinie_x_rsin_det_matriz_danos DET_DANOS\n ON DET_DANOS.cod_suc_taller_reparac=RSIN_SUCURSAL.sucursal_taller\n AND DET_DANOS.rut_taller_reparac=RSIN_SUCURSAL.rut_suc_taller\n INNER JOIN cdp_ods.bd_sinie_x_rsin_matriz_danos DANOS\n ON DANOS.id_mat_dano=DET_DANOS.id_mat_danos\n AND DANOS.codigo_oficina=DET_DANOS.codigo_oficina\n INNER JOIN cdp_ods.bd_sinie_x_sin_perfil SIN_PERFIL \n ON SIN_PERFIL.per_int_sinies = DANOS.nro_siniestro) RUT_NUM\n ON BB.sucursal_taller=RUT_NUM.sucursal_taller\n AND BB.rut_suc_taller=RUT_NUM.rut_suc_taller\n WHERE BB.TIPO IN(1,2)\n)SRC_PENTA\nLEFT JOIN (SELECT 1 as DUMMY, max(dim_bdshp_key) AS MAX_SID from cdp_dwh.dim_bdshp_t) LKP_2\nON LKP_2.DUMMY=SRC_PENTA.DUMMY\nWHERE SRC_PENTA.RNK_1=1"
    },
    {
        "type": "customQuery",
        "path": "content.transformations[1].dataAdapter.object.customQuery",
        "value": "SELECT\nSTG.dim_bdshp_key,\nSTG.bdshp_id,\nSTG.bdshp_name,\nSTG.bdshp_network_ind,\nSTG.src_sys_cd,\nSTG.bdshp_type_desc,\nSTG.bdshp_rut_num,\nSTG.rec_crt_dtm,\nSTG.rec_updt_dtm,\nSTG.actv_rec_ind,\nSTG.etl_audit_id\nFROM  cdp_dwh.dim_bdshp_t STG\nWHERE STG.src_sys_cd='penta'"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "DELETE FROM cdp_dwh.dim_bdshp_t WHERE src_sys_cd='penta';"
    }
]