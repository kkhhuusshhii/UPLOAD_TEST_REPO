[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select \n(A.max_sid+A.num) fact_veh_repair_detail_key,\nA.veh_repair_activity_id,\nA.dim_loss_item_key,\nA.dim_part_key,\nA.part_qty,\nA.part_cost_amt,\nA.labor_cost_amt,\nA.dim_bdshp_key,\nA.dim_claim_key,\nA.dim_parts_provdr_key,\nA.dim_claimant_key,\nA.paint_cost_amt,\nA.imp_part_ind,\nA.ship_cost_amt,\nA.tax_charges_amt,\nA.dim_spareparts_analyst_key,\nA.part_rcvd_dt,\nA.claim_num,\nA.claimant_num,\nA.loss_item_num,\nA.paint_ind,\nA.assembly_needed_ind,\nA.assembly_cost_amt,\nA.discount_pct,\nA.svc_maint_cd,\nA.svc_discount_cd,\nA.dim_claim_adjuster_key,\nA.part_group_cd,\nA.part_cd,\nA.dmg_magn_cd,\nA.dim_claim_type_key,\nA.src_sys_cd,\nA.dim_branch_office_key,\nA.order_num,\nA.adj_num,\nA.bdshp_loc_cd,\nA.bdshp_loc_name,\nA.rec_crt_dtm,\nA.rec_updt_dtm,\nA.actv_rec_ind,\nA.etl_audit_id,\nA.cost_amt_curr_cd \nfrom \n(\nselect \nveh_repair_activity_id,\ndim_loss_item_key,\ndim_part_key,\npart_qty,\npart_cost_amt,\nlabor_cost_amt,\ndim_bdshp_key,\ndim_claim_key,\ndim_parts_provdr_key,\ndim_claimant_key,\npaint_cost_amt,\nimp_part_ind,\nship_cost_amt,\ntax_charges_amt,\ndim_spareparts_analyst_key,\npart_rcvd_dt,\nclaim_num,\nclaimant_num,\nloss_item_num,\npaint_ind,\nassembly_needed_ind,\nassembly_cost_amt,\ndiscount_pct,\nsvc_maint_cd,\nsvc_discount_cd,\ndim_claim_adjuster_key,\npart_cd,\npart_group_cd,\ndmg_magn_cd,\ndim_claim_type_key,\nsrc_sys_cd,\ndim_branch_office_key,\norder_num,\nadj_num,\nbdshp_loc_cd,\nbdshp_loc_name,\nrecord_crt_dtm as rec_crt_dtm,\nrec_updt_dtm,\nactv_rec_ind,\ncost_amt_curr_cd,\netl_audit_id,\nmax_sid,\nrow_number()over(order by NULL) as num\nfrom\n(\nselect \nsrc.src_sys_cd,\nnvl(src.claim_num,' ') claim_num,\nnvl(src.claimant_num,0) claimant_num,\nnvl(src.loss_item_num,0) loss_item_num,\nsrc.veh_repair_activity_id,\nnvl(src.order_num,'0') order_num,\nnvl(src.adj_num,'0') adj_num,\nsrc.part_group_cd,\nsrc.assembly_cost_amt,\nsrc.assembly_needed_ind,\nnvl(src.dim_branch_office_key,0) dim_branch_office_key,\nsrc.damage_magnitude_cd as dmg_magn_cd,\nnvl(src.dim_bodyshop_key,0) dim_bdshp_key,\nnvl(src.bodyshp_location_cd,'0') bdshp_loc_cd,\nsrc.bodyshp_location_name as bdshp_loc_name,\nnvl(src.dim_claim_key,0) dim_claim_key,\nnvl(src.dim_Spare_Parts_Analyst_key,0) dim_spareparts_analyst_key,\nnvl(src.dim_claimant_key,0) dim_claimant_key,\nnvl(src.dim_claim_adjuster_key,0) dim_claim_adjuster_key,\nnvl(src.dim_loss_item_key,0) dim_loss_item_key,\nnvl(src.dim_part_key,0) dim_part_key,\nnvl(src.dim_parts_provdr_key,0) dim_parts_provdr_key,\nsrc.discount_percentage as discount_pct,\nsrc.imported_part_ind as imp_part_ind,\nsrc.item_num,\nsrc.labor_hours_qty,\nsrc.labor_total_charges_amt as labor_cost_amt,\n--src.labor_unit_charge_amt,\nsrc.paint_cost_amt,\nsrc.paint_ind,\n--src.paint_type_cd,\n--src.part_discount_applied_ind,\n--src.part_discount_percentage_amt,\nnvl(src.part_cd,' ') part_cd,\n--src.part_receipt_dt,\nsrc.part_received_dt as part_rcvd_dt,\nsrc.part_cost_amt,\nsrc.parts_qty as part_qty,\n--src.parts_total_charges_amt,\n--src.qty_unit_cd,\nsrc.service_discount_cd as svc_discount_cd,\nsrc.service_maintenance_cd as svc_maint_cd,\nsrc.shipping_charges_amt as ship_cost_amt,\nsrc.tax_charges_amt, \nnvl(dim_claim_type_key,0) dim_claim_type_key,\nrecord_crt_dtm,\nrec_updt_dtm,\nactv_rec_ind,\netl_id.etl_audit_id etl_audit_id,\ncost_amt_curr_cd,\nNVL(LKP_MAXSID.max_sid,0) max_sid,\nROW_NUMBER()OVER(PARTITION BY src.claim_num,src.veh_repair_activity_id\norder by src.rec_crt_dtm desc,src.claimant_num desc,src.loss_item_num desc,src.assembly_cost_amt desc) rnk\nFROM( \nselect distinct cast('penta' as varchar(10)) src_sys_cd,\ncast(a.nro_siniestro as varchar(35)) claim_num,\ncast((case when a.id_tercero>0 then l5.claimant_num when a.id_tercero=0 then l6.claimant_num end) as smallint) claimant_num,\ncast((case when a.id_tercero>0 then l3.loss_item_num when a.id_tercero=0 then l4.loss_item_num end) as smallint) loss_item_num,\n--cast(b.id_mat_danos||'-'||b.nro_item||'-'||b.codigo_oficina as varchar(100)) veh_repair_activity_id,--Commented based on version 4.82 change\ncast(b.id_mat_danos||'-'||b.codigo_oficina||'-'||va_oc.order_type||'-'||va_oc.order_num||'-'||b.nro_item as varchar(100)) veh_repair_activity_id,\n--cast(c.order_num as varchar(35)),\n--cast(nvl(orden_vala.codigo_orden_valorizada,nvl(ocr_rup.numero_oc,oc_ext.numero_oc)) as varchar(35)) order_num, --Commented based on QAS3 change\ncast(va_oc.order_num as varchar(35)) as order_num, \n--cast('0' as varchar(35)) adj_num, --Commented based on QAS3 change\ncast(va_oc.nro_item as varchar(35)) adj_num,\n--cast(nvl(cast(PG.mkt_ref_code as varchar(20)),nvl(orden_vala.grupo_pieza,nvl(ocr_rup.grupo_pieza,oc_ext.grupo_pieza))) as varchar(20)) part_group_cd, --Commented based on QAS3 change\ncast(nvl(PG.mkt_ref_code,va_oc.part_group_cd) as varchar(20)) as part_group_cd,\n--cast(b.costo_montaje as numeric(21,4)) assembly_cost_amt,\n--cast(nvl(orden_vala.costo_montaje,nvl(ocr_rup.costo_montaje,oc_ext.costo_montaje)) as numeric(25,10)) assembly_cost_amt, --Commented based on QAS3 change\ncast(va_oc.assembly_cost_amt as numeric(25,10)) assembly_cost_amt,\ncast((case when va_oc.montaje_sn='S' then 'S' else 'N' end) as char(1)) assembly_needed_ind,\nCAST(g.dim_branch_office_key as integer) dim_branch_office_key,\n--CAST(b.magnitud as varchar(10)) damage_magnitude_cd,\n--cast(nvl(orden_vala.magnitud,nvl(ocr_rup.magnitud,oc_ext.magnitud)) as varchar(10)) damage_magnitude_cd, --Commented based on QAS3 change\ncast(va_oc.damage_magnitude_cd as varchar(10)) damage_magnitude_cd,\nCAST(h.dim_bdshp_key as integer) dim_bodyshop_key,\ncast('0' as varchar(10)) bodyshp_location_cd,\nCAST(i.direccion as varchar(100)) bodyshp_location_name,\nCAST(j.dim_claim_key as integer) dim_claim_key,\n--CAST(k.rutusuario as integer) dim_Spare_Parts_Analyst_key,---have doubt--\nCAST(null as integer) dim_Spare_Parts_Analyst_key, --changed to null as per mapping sheet\ncast((case when a.id_tercero>0 then l5.dim_claimant_key when a.id_tercero=0 then l6.dim_claimant_key end) as integer) dim_claimant_key,\ncast((case when a.id_tercero>0 then adj4.dim_claim_adjuster_key when a.id_tercero=0 then adj3.dim_claim_adjuster_key end) as integer) dim_claim_adjuster_key, \n--CAST(null as integer) dim_claim_adjuster_key,---have doubt---\ncast((case when a.id_tercero>0 then l3.dim_loss_item_key when a.id_tercero=0 then l4.dim_loss_item_key end) as integer) dim_loss_item_key,----have doubt---\nCAST(m.dim_part_key as integer) dim_part_key,\nCAST(n.dim_parts_provdr_key as integer) dim_parts_provdr_key,---have doubt--\nCAST(b.porcentaje_desc as numeric(11,2)) discount_percentage,\nCAST('N' as char(1)) imported_part_ind,\ncast(va_oc.nro_item as integer) item_num,\nnull labor_hours_qty,--not available\ncast(null as numeric(25,10)) labor_total_charges_amt,--not available\nnull labor_unit_charge_amt, --not available\ncast(va_oc.paint_cost_amt as numeric(25,10)) paint_cost_amt,\ncast((case when(va_oc.paint_cost_amt)>0 then 'S' else 'N' end) as char(1)) paint_ind,\nnull  paint_type_cd, --not available\nnull part_discount_applied_ind,\nnull part_discount_percentage_amt,\n--cast(nvl(cast(e.mkt_ref_code as varchar(20)),nvl(orden_vala.part_cd,nvl(ocr_rup.part_cd,oc_ext.part_cd))) as varchar(20)) part_cd, --Commented based on QAS3 change\ncast(nvl(e.mkt_ref_code,va_oc.part_cd) as varchar(20)) part_cd,\nnull part_receipt_dt,\ncast(null as varchar(10)) part_received_dt,--not available,\ncast(va_oc.part_cost_amt as numeric(25,10)) part_cost_amt,\nnvl(va_oc.parts_qty,1) as parts_qty,\n--cast(null as varchar(10)) parts_total_charges_amt,----not available in penta\nnull qty_unit_cd, --- not available in penta \ncast(b.codigo_serv_desc as varchar(10)) service_discount_cd, \ncast(b.codigo_serv_mant as varchar(10)) service_maintenance_cd,\ncast(null as numeric(25,10)) shipping_charges_amt,---not available in penta,\ncast(0 as numeric(25,10)) tax_charges_amt,---not available,\ncast(r1.dim_claim_type_key as integer) dim_claim_type_key,---not available in penta,\ncast('4' as varchar(10))cost_amt_curr_cd,---not available in penta,\nCURRENT_DATE AS record_crt_dtm,\nCURRENT_DATE AS rec_updt_dtm,\n'Y' AS actv_rec_ind,\n--5 AS etl_audit_id,\n1 dummy,\ncast(a.fecha_ultima_modif as timestamp) rec_crt_dtm \nfrom \ncdp_ods.bd_sinie_x_rsin_det_matriz_danos b\n--(select * from  cdp_ods.bd_sinie_x_rsin_det_matriz_danos where id_mat_danos = '23') b\nINNER JOIN\ncdp_ods.bd_sinie_x_rsin_matriz_danos a\non a.id_mat_dano = b.id_mat_danos\nand a.codigo_oficina=b.codigo_oficina\n\n/* ########Commented based on QAS-3 change\n--###########Modified based on 24-Oct Mapping sheet update \nleft join\n(Select distinct\nov.codigo_orden_valorizada,mdet.id_mat_danos, mdet.codigo_oficina,mdet.grupo_pieza,\n  cast(mdet.grupo_pieza||'|'||mdet.codigo_pieza as varchar(20)) as part_cd ,  \n  mdet.costo_montaje,mdet.magnitud\nfrom  \ncdp_ods.bd_sinie_x_rsin_det_matriz_danos mdet\ninner join\ncdp_ods.bd_sinie_x_rsin_matriz_danos  md\n  on mdet.id_mat_danos=md.id_mat_dano\n  and mdet.codigo_oficina=md.codigo_oficina\n  and mdet.rut_taller_reparac=mdet.codigo_proveedor --orden_valorizada\n  and mdet.tipo_detalle_rsd=2\ninner join cdp_ods.bd_sinie_x_rsin_orden_valorizada  ov\n  on ov.id_mat_dano=mdet.id_mat_danos\n  and ov.codigo_oficina=mdet.codigo_oficina\n  and ov.situacion='V'\n  left join cdp_ods.bd_sinie_x_rsin_solicitud_pago sp\n  on  ov.nro_solicitud_pago = sp.nro_solicitud_pago ) orden_vala\n on b.id_mat_danos = orden_vala.id_mat_danos\n  and b.codigo_oficina=orden_vala.codigo_oficina\n  \n left join \n  (select distinct ocr.numero_oc,mdet.id_mat_danos, mdet.codigo_oficina,mdet.grupo_pieza,\n  cast(mdet.grupo_pieza||'|'||mdet.codigo_pieza as varchar(20)) as part_cd,\n  mdet.costo_montaje,mdet.magnitud         \nfrom  \ncdp_ods.bd_sinie_x_rsin_det_matriz_danos mdet\ninner join\ncdp_ods.bd_sinie_x_rsin_matriz_danos  md\non md.id_mat_dano=mdet.id_mat_danos\nand md.codigo_oficina=mdet.codigo_oficina\nand mdet.tipo_detalle_rsd=2\ninner join cdp_ods.bd_sinie_x_rsin_solicitudes_cotizacion sc\non mdet.codigo_oficina=sc.codigo_oficina\nand mdet.nro_item=sc.numero_item\nand sc.id_mat_danos=mdet.id_mat_danos\nand sc.fecha_aceptac_cotiz!=null\ninner join cdp_ods.bd_sinie_x_rsin_oc_repuestos ocr\non sc.codigo_oficina_oc=ocr.codigo_oficina\nand sc.numero_oc=ocr.numero_oc) ocr_rup\n  on b.id_mat_danos = ocr_rup.id_mat_danos\n  and b.codigo_oficina=ocr_rup.codigo_oficina\n  \n left join\n(select oc.numero_oc,mdet.id_mat_danos, mdet.codigo_oficina,mdet.grupo_pieza,\ncast(mdet.grupo_pieza||'|'||mdet.codigo_pieza as varchar(20)) as part_cd,\nmdet.costo_montaje,mdet.magnitud\nfrom \n cdp_ods.bd_sinie_x_rsin_oc_externa    oc\ninner join cdp_ods.bd_sinie_x_rsin_oc_repuestos  ocr\non  oc.numero_oc=ocr.numero_oc   \n and oc.codigo_oficina=ocr.codigo_oficina\nand oc.nro_solicitud_pago <> null\ninner join cdp_ods.bd_sinie_x_rsin_solicitudes_cotizacion sc\non oc.numero_oc=sc.numero_oc\nand oc.codigo_oficina=sc.codigo_oficina\ninner join cdp_ods.bd_sinie_x_rsin_det_matriz_danos mdet\n  on sc.codigo_oficina=mdet.codigo_oficina\nand sc.numero_item=mdet.nro_item\nand sc.id_mat_danos=mdet.id_mat_danos\nand mdet.tipo_detalle_rsd=2\nand mdet.rut_taller_reparac!=mdet.codigo_proveedor \n inner join cdp_ods.bd_sinie_x_rsin_solicitud_pago sp\non sp.nro_solicitud_pago = oc.nro_solicitud_pago) oc_ext\n   on b.id_mat_danos = oc_ext.id_mat_danos\n  and b.codigo_oficina=oc_ext.codigo_oficina\n  \n  --###########Modified based on 24-Oct Mapping sheet update complete */\n--##### Added based on QAS3 change--\n\ninner join \n(select\nsub.claim_num,sub.id_mat_danos,sub.nro_item,sub.codigo_oficina,sub.id_tercero,sub.order_num,sub.part_group_cd,\nsub.part_cd,sub.assembly_cost_amt,sub.montaje_sn,sub.damage_magnitude_cd,sub.paint_cost_amt,sub.part_cost_amt,sub.parts_qty,sub.order_type  \nfrom\n(\nSelect \nmd.nro_siniestro as claim_num,   \nmdet.id_mat_danos,\nmdet.nro_item,\nmdet.codigo_oficina,\nmd.id_tercero,\ncast(ov.codigo_orden_valorizada as varchar(35)) as order_num,\ncast(mdet.grupo_pieza as varchar(35)) part_group_cd,\ncast(mdet.grupo_pieza||'|'||mdet.codigo_pieza as varchar(20)) as part_cd,\nmdet.costo_montaje as assembly_cost_amt,\nmdet.montaje_sn,\nmdet.magnitud as damage_magnitude_cd,\nmdet.costo_pintura as paint_cost_amt,\nmdet.costo_item as part_cost_amt,\nmdet.cantidad as parts_qty,\n'1' as  order_type  \nfrom      \n cdp_ods.bd_sinie_x_rsin_orden_valorizada  ov,     \n cdp_ods.bd_sinie_x_rsin_solicitud_pago    sp,     \n cdp_ods.bd_sinie_x_rsin_det_matriz_danos mdet,      \n cdp_ods.bd_sinie_x_rsin_matriz_danos  md     \nwhere     \nov.nro_solicitud_pago = sp.nro_solicitud_pago     \nand \nov.situacion='V' \nand  ov.codigo_orden_valorizada = mdet.num_orden_valorizada \n \n and ov.id_mat_dano=mdet.id_mat_danos     \n  and ov.codigo_oficina=mdet.codigo_oficina     \n  and mdet.id_mat_danos=md.id_mat_dano     \n  and mdet.codigo_oficina=md.codigo_oficina     \n and md.id_tercero>=0 \n and mdet.codigo_pieza is not null\n\n union\n\n Select \nmd.nro_siniestro as claim_num,  \nmdet.id_mat_danos,\nmdet.nro_item,\nmdet.codigo_oficina,\nmd.id_tercero,\ncast(oc.num_oc_mg as varchar(35)) as order_num,\ncast(mdet.grupo_pieza as varchar(35)) part_group_cd,\ncast(mdet.grupo_pieza||'|'||mdet.codigo_pieza as varchar(20)) as part_cd,\nmdet.costo_montaje as assembly_cost_amt,\nmdet.montaje_sn,\nmdet.magnitud as damage_magnitude_cd,\nmdet.costo_pintura as paint_cost_amt,\nmdet.costo_item as part_cost_amt,\nmdet.cantidad as parts_qty,\n'3' as  order_type \nfrom \n cdp_ods.bd_sinie_x_rsin_oc_externa    oc,\ncdp_ods.bd_sinie_x_rsin_oc_repuestos   ocr,\ncdp_ods.bd_sinie_x_rsin_solicitudes_cotizacion sc,\ncdp_ods.bd_sinie_x_rsin_det_matriz_danos  mdet,\ncdp_ods.bd_sinie_x_rsin_matriz_danos  md,\ncdp_ods.bd_sinie_x_rsin_solicitud_pago   sp\nwhere\noc.nro_solicitud_pago is not null\nand oc.numero_oc=ocr.numero_oc  \n and oc.codigo_oficina=ocr.codigo_oficina\nand oc.numero_oc=sc.numero_oc\nand oc.codigo_oficina=sc.codigo_oficina\nand sc.codigo_oficina=mdet.codigo_oficina\nand sc.nro_item_mat_danos=mdet.nro_item  -- reempplaza a sc.numero_item\nand sc.id_mat_danos=mdet.id_mat_danos\nand mdet.tipo_detalle_rsd=2\nand mdet.rut_taller_reparac!=mdet.codigo_proveedor --oc_externa\nand mdet.id_mat_danos=md.id_mat_dano\nand mdet.codigo_oficina=md.codigo_oficina\nand sp.nro_solicitud_pago = oc.nro_solicitud_pago \n and md.id_tercero>=0\n)sub  ) va_oc\non  a.nro_siniestro=va_oc.claim_num\nand b.id_mat_danos = va_oc.id_mat_danos\nand b.codigo_oficina=va_oc.codigo_oficina\nand a.id_tercero=va_oc.id_tercero\nand b.nro_item=va_oc.nro_item\n\n  \nleft outer join\n(select ref_cd,mkt_ref_code from cdp_stg_dwh.stg_tref_code_map_variant where src_sys_cd='penta' and ref_type_cd='autopart') e\non cast(va_oc.part_cd as varchar(20))=e.ref_cd \n\nleft outer join\n(select ref_cd,mkt_ref_code from cdp_stg_dwh.stg_tref_code_map_variant where src_sys_cd='penta' and ref_type_cd='autopart_group') PG\non cast(va_oc.part_group_cd as varchar(20))=PG.ref_cd\n\nleft outer join\n(select ref_cd,mkt_ref_code from cdp_stg_dwh.stg_tref_code_map_variant where src_sys_cd='penta' and ref_type_cd='branch_office') f\non a.codigo_oficina=f.ref_cd \nleft outer join\ncdp_dwh.dim_branch_office_t g\non g.branch_office_cd=nvl(cast(f.mkt_ref_code as varchar(10)),cast(a.codigo_oficina as varchar(10))) and g.src_sys_cd='penta'\nleft outer join\ncdp_dwh.dim_bdshp_t h\non b.rut_taller_reparac=h.bdshp_rut_num and h.src_sys_cd='penta'\nleft outer join\ncdp_ods.bd_sinie_x_rsin_sucursal_taller i\non b.rut_taller_reparac=i.rut_suc_taller\nand b.codigo_proveedor=i.sucursal_taller\nleft outer join\ncdp_dwh.dim_claim_t j\non j.claim_num=a.nro_siniestro and j.src_sys_cd='penta'\n/*left outer join  --changed to null as per mapping sheet\ncdp_ods.snsmst_sinpag_aprpagdet k\non k.Siniestro=a.nro_siniestro*/\nleft outer join\n(select ref_cd,mkt_ref_code from cdp_stg_dwh.stg_tref_code_map_variant where src_sys_cd='penta' and ref_type_cd='autopart') l\non b.grupo_pieza||'|'||cast(b.codigo_pieza as varchar(10))=l.ref_cd \nleft outer join\ncdp_dwh.dim_spare_parts_t m\non m.part_cd=nvl(l.mkt_ref_code,b.grupo_pieza||'|'||cast(b.codigo_pieza as varchar(10))) and m.src_sys_cd='penta'\nleft outer join\ncdp_dwh.dim_parts_provdr_t n\non n.provdr_id=b.rut_taller_reparac and n.src_sys_cd='penta'\n/*left outer join --Commented as we are not populating any field from 'bd_sinie_x_rsin_serv_descuento'\ncdp_ods.bd_sinie_x_rsin_serv_descuento o\non b.codigo_serv_desc = o.codigo*/\n/*left outer join\ncdp_ods.bd_sinie_x_sin_perfil p\non a.nro_siniestro=p.per_int_sinies*/\n/*left outer join --Commented as we are not populating any field from 'bd_sinie_x_rsin_serv_mantenimiento'\ncdp_ods.bd_sinie_x_rsin_serv_mantenimiento q\non b.codigo_serv_mant = q.codigo*/\n/*left outer join \n(select distinct d.id_tercero,d.nro_siniestro,d.patente,d.id_mat_dano,m.id_mat_danos\nfrom\ncdp_ods.bd_sinie_x_rsin_matriz_danos d\ninner join \ncdp_ods.bd_sinie_x_rsin_det_matriz_danos m\non m.id_mat_danos=d.id_mat_dano \nand d.id_tercero > 0) l1\non \na.id_mat_dano=l1.id_mat_dano\n*/\nleft outer join cdp_dwh.dim_loss_item_t l3\non a.nro_siniestro = l3.claim_num \nand a.patente = l3.lic_plate_num \nand l3.src_sys_cd ='penta' \nand a.id_tercero > 0\n/*\nleft outer join\n(select distinct d.id_tercero, p.per_int_rutase, d.nro_siniestro,d.id_mat_dano,m.id_mat_danos\nfrom\ncdp_ods.bd_sinie_x_rsin_det_matriz_danos m\ninner join cdp_ods.bd_sinie_x_rsin_matriz_danos d\non m.id_mat_danos=d.id_mat_dano and d.id_tercero = 0\ninner join cdp_ods.bd_sinie_x_sin_perfil p\non d.nro_siniestro = p.per_int_sinies) l2 \non \na.id_mat_dano=l2.id_mat_dano\n*/\nleft outer join cdp_ods.bd_sinie_x_sin_perfil p\non a.nro_siniestro = p.per_int_sinies\nand a.id_tercero = 0\nleft outer join cdp_dwh.dim_loss_item_t l4\non p.per_int_sinies = l4.claim_num \nand p.per_int_rutase = l4.loss_item_id \nand l4.src_sys_cd ='penta'\nleft outer join cdp_dwh.dim_claimant_t l5\non a.nro_siniestro = l5.claim_num \nand a.patente = split_part(l5.claimant_id,'-',3) \nand l5.src_sys_cd ='penta' \nleft outer join\ncdp_dwh.dim_claimant_t l6\non p.per_int_sinies = l6.claim_num \nand p.per_int_rutase = l6.claimant_id \nand l6.src_sys_cd ='penta'\n/*left outer join \ncdp_dwh.dim_claim_type_t r1\non j.claim_type_cd=r1.claim_type_cd and r1.src_sys_cd='penta' */\nleft outer join \n (Select \n  a.per_int_sinies, typ.dim_claim_type_key\nfrom \n  cdp_ods.bd_sinie_x_sin_perfil a inner join \n (select ref_cd from cdp_stg_dwh.stg_tref_code_map_variant where src_sys_cd='penta' and ref_type_cd='claim_type') c\non a.per_tin_tiposiniestro=c.ref_cd\ninner join (select dim_claim_type_key,claim_type_cd from cdp_dwh.dim_claim_type_t where src_sys_cd='penta')typ\non c.ref_cd = typ.claim_type_cd) r1\non a.nro_siniestro=r1.per_int_sinies\nleft outer join \ncdp_ods.bd_sinie_x_sin_danos_propios adj1\non a.nro_siniestro=adj1.dap_int_sinies\nand a.id_tercero = 0\nleft outer join \ncdp_ods.bd_sinie_x_sin_danos_tercero adj2\non a.nro_siniestro=adj2.dat_int_sinies\nand a.id_tercero > 0\nleft outer join\ncdp_dwh.dim_claim_adjuster_t adj3\non adj3.adjuster_id=adj1.dap_int_rutliq\nand adj3.src_sys_cd ='penta'\nleft outer join\ncdp_dwh.dim_claim_adjuster_t adj4\non adj4.adjuster_id=adj2.dat_int_rutabo\nand adj4.src_sys_cd ='penta'\n) src \nLEFT JOIN (SELECT 1 AS DUMMY,etl_audit_id FROM CDP_DWH.dim_branch_office_t where dim_branch_office_key=1)etl_id \non src.dummy=etl_id.dummy\n  left outer join\n(select 1 as dummy, max(fact_veh_repair_detail_key) as MAX_SID from cdp_dwh.fact_veh_repair_activity_t) LKP_MAXSID\non src.dummy = LKP_MAXSID.dummy)\nwhere rnk=1 \nand src_sys_cd is not null\nand claim_num is not null \nand claimant_num is not null \nand loss_item_num is not null \nand veh_repair_activity_id is not null\n)A"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[1].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "delete from cdp_dwh.fact_veh_repair_activity_t where src_sys_cd='penta';"
    }
]