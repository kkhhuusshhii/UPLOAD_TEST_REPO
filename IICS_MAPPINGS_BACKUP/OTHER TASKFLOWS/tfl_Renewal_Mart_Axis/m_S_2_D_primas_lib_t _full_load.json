[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select SSEGURO,\n\t\tPRIMA,\n\t\tPRIMA_TARIFA,\n\t\tDESCUENTO,\n\t\tCOMISION,\n\t\tmax_sid \nfrom\n(select         SSEGURO,\n\t\tPRIMA,\n\t\tPRIMA_TARIFA,\n\t\tDESCUENTO,\n\t\tCOMISION,\n\t\tLKP_MAX_KEY.max_sid \n\t\tfrom\n(\n\nSELECT    T1.SSEGURO ,\n          (T3.PRIMA * T5.ITASA / T6.ITASA) AS PRIMA,\n\t\t  (T3.PRIMA_TARIFA * T5.ITASA / T6.ITASA) AS PRIMA_TARIFA,\n\t\t  (T3.DESCUENTO * T5.ITASA / T6.ITASA) AS DESCUENTO,\n          (T7.PCOMISI/100) AS COMISION --table to be pulled to dev\n          \nFROM cdp_stg_dwh.base_lib T1\nLEFT JOIN cdp_ods.sisaxis_seguros T2\nON T1.SSEGURO = T2.SSEGURO\nLEFT JOIN\n     (SELECT SSEGURO, \n\t\t\t SUM(IPRIANUSEG) AS PRIMA, \n\t\t\t SUM(IPRITARSEG) AS PRIMA_TARIFA, \n\t\t\t SUM(IDTOCOM) AS DESCUENTO, \n\t\t\t MAX(FCAMBIO) AS FCAMBIO\n     FROM cdp_ods.sisaxis_garanseg\n     WHERE NMOVIMI = 1\n     GROUP BY SSEGURO) T3\nON T1.SSEGURO = T3.SSEGURO\n\t\nLEFT JOIN cdp_ods.sisaxis_eco_tipocambio T5 /* Trae tasa de cambio Moneda Original a Pesos */\nON T2.CMONSEG = T5.CMONORI /* Uni\u00c3\u00b3n por Tipo Moneda */\nAND date(T3.FCAMBIO) = date(T5.FCAMBIO) /*Uni\u00c3\u00b3n por fecha de moneda */ ---removed datepart() function\n\nLEFT JOIN cdp_ods.sisaxis_eco_tipocambio T6 /* Transformaci\u00c3\u00b3n a UF */\nON date(T5.FCAMBIO) = date(T6.FCAMBIO)\n\nLEFT JOIN (SELECT DISTINCT SSEGURO, PCOMISI FROM cdp_ods.SISAXIS_COMISIONSEGU WHERE NMOVIMI = 1) T7 ON T1.SSEGURO = T7.SSEGURO  --Table to be pulled to dev\n/*AND T3.NMOVIMI = T7.NMOVIMI*/\nWHERE T6.CMONORI = 'CLF'\nORDER BY T1.SSEGURO)src\nleft outer join \n(select 1 dummy,max(primas_lib_key) max_sid  from  cdp_stg_dwh.primas_lib) LKP_MAX_KEY\non LKP_MAX_KEY.dummy=1)\nwhere SSEGURO is not null"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.primas_lib;\n"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[2].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.primas_lib;\ncommit;"
    }
]