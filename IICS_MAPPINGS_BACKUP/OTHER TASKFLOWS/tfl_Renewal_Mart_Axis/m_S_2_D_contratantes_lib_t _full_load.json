[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "select SSEGURO,\nCONTRATANTE_RUT,\nCONTRATANTE_NOMBRE,\t\nmax_sid \nfrom\n(select SSEGURO,\n\t\tCONTRATANTE_RUT,\n                CONTRATANTE_NOMBRE,\n\t\t       LKP_MAX_KEY.max_sid \n\t\tfrom\n\n(\n\nSELECT \tT1.SSEGURO,\n\t\tSUBSTRING(T2.NNUMNIF,1,length(T2.NNUMNIF)-1) AS CONTRATANTE_RUT,\n\t       isnull(T2.TAPELLI,'')|| ' ' || isnull(T2.TNOMBRE,'') AS CONTRATANTE_NOMBRE\n\t       \nFROM\tcdp_stg_dwh.base_lib T1\nLEFT JOIN (\n\tSELECT A.SSEGURO, B.NNUMNIF, B.TAPELLI, B.TNOMBRE\n\tFROM cdp_ods.sisaxis_personas B\n\tRIGHT JOIN cdp_ods.sisaxis_tomadores A\n\tON\tA.SPERSON = B.SPERSON) T2\nON\tT1.SSEGURO = T2.SSEGURO\n ORDER BY T1.SSEGURO)src\nleft outer join \n(select 1 dummy,max(contratantes_lib_key) max_sid  from  cdp_stg_dwh.contratantes_lib) LKP_MAX_KEY\non LKP_MAX_KEY.dummy=1)\nwhere SSEGURO is not null"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.contratantes_lib;\n"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[2].dataAdapter.runtimeAttributes.attributes[14]",
        "name": "Pre-sql",
        "value": "TRUNCATE TABLE cdp_stg_dwh.contratantes_lib;\ncommit;\n"
    }
]