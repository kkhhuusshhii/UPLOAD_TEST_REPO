[
    {
        "type": "customQuery",
        "path": "content.transformations[0].dataAdapter.object.customQuery",
        "value": "SELECT\nNVL(LKP.LKP_MAX_KEY,0) AS LKP_MAX_KEY,\nCAST(SRC.correlative AS INTEGER) AS correlative,\nCAST(SRC.account_code AS VARCHAR(40)) AS account_code,\nCAST(SRC.account AS VARCHAR(100)) AS account,\nCAST(SRC.Year AS VARCHAR(8)) AS Year,\nCAST(SRC.month_code AS VARCHAR(4)) AS month_code,\nCAST(SRC.month AS VARCHAR(10)) AS month,\nCAST(SRC.lob_code AS INTEGER) AS lob_code,\nCAST(SRC.lob_desc AS VARCHAR(30)) AS lob_desc,\nCAST(SRC.channel_code AS VARCHAR(10)) AS channel_code,\nCAST(SRC.channel_name AS VARCHAR(20)) AS channel_name,\nCAST(SRC.curr_code AS VARCHAR(4)) AS curr_code,\nCAST(REPLACE(SRC.Actual,',','.') AS NUMERIC(30,10)) AS Actual,\nCAST(REPLACE(SRC.Plan,',','.') AS NUMERIC(30,10)) AS Plan,\ngetdate() AS rec_crt_dtm,\ngetdate() AS rec_upd_dtm\nFROM \n(\nSELECT DISTINCT\ncorrelative,\naccount_code,\naccount,\nYear,\nmonth_code,\nmonth,\nlob_code,\nlob_desc,\nchannel_code,\nchannel_name,\ncurr_code,\nActual,\nPlan,\n1 AS DUMMY FROM\nCDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T \n) SRC\nLEFT JOIN \n(SELECT 1 AS DUMMY, MAX(FACT_MARGIN_PROFIT_LOSS_KEY) AS LKP_MAX_KEY FROM CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T) LKP\nON SRC.DUMMY = LKP.DUMMY ;"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[0].dataAdapter.runtimeAttributes.attributes[9]",
        "name": "Pre-sql",
        "value": "DELETE FROM CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T \nUSING CDP_STG_DWH.stg_margin_profit_loss_t\nWHERE CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T .YEAR= CDP_STG_DWH.stg_margin_profit_loss_t.YEAR ;\n"
    },
    {
        "type": "pre/post-sql",
        "path": "content.transformations[1].dataAdapter.runtimeAttributes.attributes[15]",
        "name": "Post-sql",
        "value": "--Update statement for solving last decimals' issues\n\nUPDATE CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T\nSET ACTUAL = CAST(REPLACE(CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.ACTUAL,',','.') AS NUMERIC(30,10)),\nPLAN = CAST(REPLACE(CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.PLAN,',','.') AS NUMERIC(30,10))\nFROM CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T\nWHERE\nCDP_DWH.FACT_MARGIN_PROFIT_LOSS_T.correlative=CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.correlative\nAND CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T.account_code=CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.account_code\nAND CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T.account=CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.account\nAND CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T.year=CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.year\nAND CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T.month_code=CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.month_code\nAND CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T.month=CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.month\nAND CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T.lob_code=CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.lob_code\nAND CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T.lob_desc=CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.lob_desc\nAND CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T.channel_code=CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.channel_code\nAND CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T.channel_name=CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.channel_name\nAND CDP_DWH.FACT_MARGIN_PROFIT_LOSS_T.curr_code=CDP_STG_DWH.STG_MARGIN_PROFIT_LOSS_T.curr_code ;"
    }
]